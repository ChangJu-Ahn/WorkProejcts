//
//	  Copyright (C) 2003-2015 GrapeCity Inc.	All rights reserved.
//

var __extends=this.__extends||function(b,a){for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c];function d(){this.constructor=b}d.prototype=a.prototype;b.prototype=new d},FarPoint;(function(a){var b;(function(a){var b;(function(a){"use strict";(function(a){a[a.None=0]="None";a[a.Cells=1]="Cells";a[a.Rows=2]="Rows";a[a.Columns=4]="Columns";a[a.Sheet=8]="Sheet"})(a.SelectionBlockOptions||(a.SelectionBlockOptions={}));var j=a.SelectionBlockOptions;(function(a){a[a.Single=0]="Single";a[a.Range=1]="Range";a[a.MultiRange=2]="MultiRange"})(a.SelectionPolicy||(a.SelectionPolicy={}));var k=a.SelectionPolicy;(function(a){a[a.Normal=0]="Normal";a[a.ReadOnly=1]="ReadOnly";a[a.RowMode=2]="RowMode";a[a.SingleSelect=3]="SingleSelect";a[a.MultiSelect=4]="MultiSelect";a[a.ExtendedSelect=5]="ExtendedSelect"})(a.OperationMode||(a.OperationMode={}));var l=a.OperationMode;(function(a){a[a.None=0]="None";a[a.Resize=1]="Resize";a[a.ColumnMove=2]="ColumnMove";a[a.Selection=3]="Selection"})(a.SpreadAction||(a.SpreadAction={}));var m=a.SpreadAction;(function(a){a[a.Cells=0]="Cells";a[a.Rows=1]="Rows";a[a.Columns=2]="Columns";a[a.Table=3]="Table"})(a.SelectType||(a.SelectType={}));var n=a.SelectType,i=function(){function a(a,b){this.spread=a.Spread;this.spreadView=a;this.element=b}a.prototype.__Dispose=function(){};a.prototype.ContainsPoint=function(b,c){if(!this.IsVisible())return false;var a=this.element.getBoundingClientRect();return a.left<=b&&b<=a.right&&a.top<=c&&c<=a.bottom?true:false};a.prototype.Contains=function(a){return!this.IsVisible()?false:a!=null?$$.j.contains(this.element,a):false};a.prototype.IsInside=function(a,b,c){return!this.IsVisible()?false:this.element==a||this.Contains(a)||this.ContainsPoint(b,c)};a.prototype.IsEmptyGroupedRow=function(){return this.element.children.length<1||this.element.children[0].tagName==null};a.prototype.IsVisible=function(){return this.element!=null};return a}();a.GroupBar=i;var d=function(){function a(a,b,d,c){if(a==null||a.length==0)throw"Identifier must be not null and not empty!";if(b==null||b.length==0)throw"Invalid event name!";this.Identifier=a;this.Name=b;this.Target=d;this.Handler=c;this.IsBound=false;this.IsGenericEvent=true;this.UseCapture=true}return a}();a.EventHandler=d;var c=function(){function a(){this.handlers=[]}a.prototype.Has=function(a,c,b){if(a==null||a.length==0)return false;if(c===undefined&&b==undefined&&a in this.handlers)return true;var e=a.toLowerCase();for(var f in this.handlers){var d=this.handlers[f];if(d.Name.toLowerCase()==e&&(!c||c==d.Target)&&(!b||b==d.Handler))return true}return false};a.prototype.IsBound=function(b,d,c){if(b==null||b.length==0)return false;var e=b.toLowerCase();for(var f in this.handlers){var a=this.handlers[f];if(d===undefined&&c==undefined&&b==a.Identifier&&a.IsBound)return true;if(a.Name.toLowerCase()==e&&(!d||d==a.Target)&&(!c||c==a.Handler)&&a.IsBound)return true}return false};a.prototype.Attach=function(b){var a=typeof b=="string"?this.handlers[b]:b;if(this.Add(a)||!this.IsBound(a.Identifier)){$$.utils.attachEvent(a.Target,a.Name,a.Handler,a.UseCapture);a.IsBound=true;return true}return false};a.prototype.AttachAll=function(){for(var b in this.handlers){var a=this.handlers[b];a&&!a.IsBound&&this.Attach(a)}};a.prototype.Detach=function(b){var c=typeof b!="string"?b.Identifier:b,a=this.handlers[c];if(a&&a.IsBound){$$.utils.detachEvent(a.Target,a.Name,a.Handler,a.UseCapture);a.IsBound=false;return true}return false};a.prototype.DetachAll=function(){for(var b in this.handlers){var a=this.handlers[b];a&&a.IsBound&&this.Detach(b)}};a.prototype.Add=function(a){if(!this.Has(a.Identifier)){this.handlers[a.Identifier]=a;return true}return false};a.prototype.Remove=function(a){if(a&&a.Identifier in this.handlers){delete this.handlers[a.Identifier];return true}return false};a.prototype.RemoveAll=function(){this.DetachAll();this.handlers=[]};return a}();a.EventHandlers=c;var g=function(){function a(a){this.spreadView=a;this.eventsByMouse=[]}a.prototype.Clear=function(){this.eventsByMouse=[]};a.prototype.IsFired=function(d,a,h){for(var c=this.spreadView.GetLastMouseDownEvent()?this.eventsByMouse:[],b=0;b<c.length;b++){var f=c[b];if(f.type==d)if(a){var e=true;for(var g in a)if(a[g]!=f[g]){e=false;break}if(e)return true}else return true}h&&this.Log(d,a);return false};a.prototype.Log=function(d,a){var e=this.spreadView.GetLastMouseDownEvent()!=null;if(e){var b={type:""};b.type=d;if(a)for(var c in a)b[c]=a[c];this.spreadView.GetLastMouseDownEvent()!=null&&this.eventsByMouse.push(b)}};return a}();a.EventTracker=g;var f=function(){function a(){}Object.defineProperty(a.prototype,"IsLeftTopBorderStyle",{"get":function(){if(!this.isLeftTopStyleDetected){var a=document.createElement("TABLE");a.cellPadding="0";a.cellSpacing="0";a.rules="all";a.style.backgroundColor="transparent";a.style.borderCollapse="collapse";a.style.border="1px solid transparent";a.style.width="2px";a.style.height="2px";var c=a.insertRow(),b=c.insertCell();b.style.border="1px solid transparent";document.body.appendChild(a);this.isLeftTopStyle=b.getBoundingClientRect().left==a.getBoundingClientRect().left;this.isLeftTopStyleDetected=true;a.parentNode.removeChild(a)}return this.isLeftTopStyle},enumerable:true,configurable:true});return a}();a.BrowerFeatureDetector=f;var b=function(){function a(a){if(a==null||!$$.utils.isTextControl(a,true))throw"Not support control!";this.textBox=a;this.eventHandlers=new c;this.Initialize()}Object.defineProperty(a.prototype,"IsMultiline",{"get":function(){return this.textBox.tagName=="TEXTAREA"},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"HostingContext",{"get":function(){return this.hostingContext},"set":function(a){this.hostingContext=a},enumerable:true,configurable:true});Object.defineProperty(a.prototype,"TextBox",{"get":function(){return this.textBox},enumerable:true,configurable:true});a.prototype.Initialize=function(){this.eventHandlers.Attach(new d("textBoxKeyUp","keyup",this.textBox,Function.CreateDelegate(this,this.OnKeyUp),true))};a.prototype.OnKeyUp=function(e){if(!e.ctrlKey&&!e.altKey&&!e.metaKey){var d=false,f=$$.utils.measureTextContent(this.textBox,this.hostingContext);if(this.textBox.clientWidth-f.width<a.EXPAND_WIDTH_THRESHOLD){var c=parseInt(this.textBox.style.width);if(isNaN(c))c=this.textBox.offsetWidth;var h=this.CalculateExpandWidth();this.textBox.style.width=c+h+"px";d=true}if(this.textBox.clientHeight-f.height<a.EXPAND_HEIGHT_THRESHOLD){var b=parseInt(this.textBox.style.height);if(isNaN(b))b=this.textBox.offsetHeight;var g=this.CalculateExpandHeight();this.textBox.style.height=b+g+"px";d=true}d&&this.onExpandCallback()}};a.prototype.SetOnExpandCallback=function(a){this.onExpandCallback=a};a.prototype.Dispose=function(){this.eventHandlers.RemoveAll()};a.prototype.CalculateExpandWidth=function(){return a.DEFAULT_EXPAND_WIDTH};a.prototype.CalculateExpandHeight=function(){return a.DEFAULT_EXPAND_HEIGHT};a.DEFAULT_EXPAND_WIDTH=90;a.DEFAULT_EXPAND_HEIGHT=22;a.EXPAND_WIDTH_THRESHOLD=16;a.EXPAND_HEIGHT_THRESHOLD=1;return a}();a.TextBoxAutoExpander=b;var e=function(b){__extends(a,b);function a(c,a){b.call(this,c);this.parent=this.expandedCell=a;this.expandedRow=a.parentElement}a.prototype.CalculateExpandWidth=function(){var c=this.expandedCell.parentNode,a=this.expandedCell.cellIndex<c.cells.length-1?c.cells[this.expandedCell.cellIndex+1]:null;if(a!=null){this.expandedCell=a;var e=this.TextBox.getBoundingClientRect(),d=a.getBoundingClientRect();return Math.floor(d.right-e.right)}return b.prototype.CalculateExpandWidth.call(this)};a.prototype.CalculateExpandHeight=function(){var g,a=this.expandedCell.parentElement,d=a.parentElement.tagName=="TABLE"?a.parentElement:a.parentElement.parentElement,c=this.expandedRow.rowIndex<d.rows.length-1?d.rows[this.expandedRow.rowIndex+1]:null;if(c!=null){this.expandedRow=c;var f=this.TextBox.getBoundingClientRect(),e=c.getBoundingClientRect();return Math.floor(e.bottom-f.bottom)}return b.prototype.CalculateExpandHeight.call(this)};return a}(b);a.TableCellTextBoxAutoExpander=e;var h=function(){function a(){}a.FixUnderLayerScroll=function(e,c,g){var a=null;if(c==null)a=document.getElementById(g||"spreadSafariScrollShield");if(a==null){a=document.createElement("DIV");if(c==null){c=document.body;a.id=g||"spreadSafariScrollShield"}c.appendChild(a);var f=document.createElement("DIV");f.style.width=f.style.height="10000px";a.appendChild(f);a.className="spread-webkit-scroll spread-webkit-scroll-shield"}var h=e.getBoundingClientRect(),b=$$.j(a);b.css("display","");var d=-5;$$(a).moveToPosition(h.left-d,h.top-d);b.width(e.offsetWidth+2*d);b.height(e.offsetHeight+2*d);b.scrollLeft(100);b.scrollTop(100);return a};a.FixTelephoneAutoFormat=function(a){if(!$$.j||a==null||(a.textContent||a.innerText||"").length<2)return;for(var f=/<a\shref="tel:[^<]+">([^<]+)<\/a>/g,d=$$.j(a).find("A[href^='tel:']"),c=0;c<d.length;c++){var b=d[c],e=b.outerHTML.replace(f,"$1");$$.j(b).before(e);b.parentNode.removeChild(b)}};a.FixOverflowScrollDivLayout=function(b){var a=b.getSpreadView();if(a.FrozenRowCount>0||a.FrozenColumnCount>0){var c=[a.Viewport,a.Viewport1,a.Viewport2];$$.j.each(c,function(d,c){if(c){var b=document.getElementById(c.id+"_layoutFix");if(b==null){b=document.createElement("DIV");b.innerHTML="&nbsp";if(c==a.Viewport2){b.style.position="relative";b.style.top=-c.offsetHeight+"px";b.style.left=c.offsetWidth+"px";b.style.width=b.style.height="1px";b.style.overflow="hidden"}b.id=c.id+"_layoutFix";$$.j(c).after(b)}}})}};a.FixTextBox=function(a){if(a&&a.type=="text"){var c=$$.j(a),b=c.prop("maxLength");if(b!==undefined&&b>0)c.off("keypress.safari.patch").on("keypress.safari.patch",function(c){var e=c.target.isIMEComposing;if(!e){var d=$$.j(c.target).val();d&&d.length>=b&&a.selectionStart==a.selectionEnd&&c.preventDefault()}})}};a.RemoveTextBoxFix=function(a){a&&$$.j(a).off("keypress.safari.patch")};a.EnableWebkitScroll=true;return a}();a.SafariPatch=h})(b=a.Spread||(a.Spread={}))})(b=a.Web||(a.Web={}))})(FarPoint||(FarPoint={}));var FarPoint;(function(a){var b;(function(a){var b;(function(b){var a=function(){function a(a){this.SignalTime=a}return a}();b.ElapsedEventArgs=a;var c=function(){function b(c,b,a){this.interval=-1;this.intervalId=-1;this.AutoReset=true;this.elapsedHandlers=$$.j.Callbacks("unique");b&&this.elapsedHandlers.add(b);if(a!==undefined)this.AutoReset=a;if(c!=null){this.interval=c;this.Start()}}b.GetSystemTimer=function(){if(b.sysTimer==null)b.sysTimer=new b(500);return b.sysTimer};b.prototype.AddElapsedHandler=function(a){this.elapsedHandlers.add(a)};b.prototype.RemoveElapsedHandler=function(a){this.elapsedHandlers.remove(a)};b.prototype.Start=function(){var a=this;if(this.interval!=-1)this.intervalId=setInterval(function(){a.InternalCallback()},this.interval);return this.intervalId};b.prototype.Stop=function(){if(this.intervalId!=-1){clearInterval(this.intervalId);this.intervalId=-1}};b.prototype.InternalCallback=function(){var b=new a(Date.now());this.elapsedHandlers.fire(b);!this.AutoReset&&this.Stop()};return b}();b.Timer=c})(b=a.Timers||(a.Timers={}))})(b=a.Web||(a.Web={}))})(FarPoint||(FarPoint={}));$$.featureDetector=new FarPoint.Web.Spread.BrowerFeatureDetector