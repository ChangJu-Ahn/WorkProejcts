//
//	  Copyright (C) 2003-2014 GrapeCity Inc.	All rights reserved.
//

if(!Function.prototype.CreateDelegate)Function.prototype.CreateDelegate=function(a,b){return function(){return b.apply(a,arguments)}};if(!Function.prototype.CreateCallback)Function.prototype.CreateCallback=function(b,a){return function(){var e=arguments.length;if(e>0){for(var d=[],c=0;c<e;c++)d[c]=arguments[c];d[e]=a;return b.apply(this,d)}return b.call(this,a)}};if(!String.prototype.trim)String.prototype.trim=function(){var a=this.match(new RegExp("^\\s*(\\S+(\\s+\\S+)*)\\s*$"));return a==null?"":a[1]};if(!String.prototype.trimEnd)String.prototype.trimEnd=function(){return this.replace(new RegExp("\\s+$"),"")};if(!String.prototype.trimStart)String.prototype.trimStart=function(){return this.replace(new RegExp("^\\s+"),"")};if(typeof FarPoint=="undefined")FarPoint={};FarPoint.System={};FarPoint.System.CheckBrowserByName=function(d){var c=window.navigator.userAgent,b=false,a=(""+d).toLowerCase();if(a.indexOf("ms")>=0||a.indexOf("msie")>=0||a.indexOf("ie")>=0)b=c.indexOf("MSIE")>=1||c.indexOf("Trident")!=-1;else if(a.indexOf("safari")>=0||a.indexOf("apple")>=0)b=c.indexOf("Safari")>=1;else if(a.indexOf("ff")>=0||a.indexOf("firefox")>=0)b=c.indexOf("Firefox")>=1;return b};FarPoint.System.IsChild=function(b,c){if(c==null||b==null)return false;var a=c.parentNode;while(a!=null){if(a==b)return true;a=a.parentNode}return false};FarPoint.System.FindElementById=function(b,d,c){if(b==null)return null;var a=b.getAttribute(c);return a==null?null:document.getElementById(a+d)};FarPoint.System.GetEvent=function(a){return a!=null?a:window.event};FarPoint.System.GetTarget=function(a){a=FarPoint.System.GetEvent(a);return a.target==document&&a.currentTarget!=null?a.currentTarget:a.target!=null?a.target:a.srcElement};FarPoint.System.CancelDefault=function(a){if(a.preventDefault!=null){a.preventDefault();a.stopPropagation()}else{a.cancelBubble=true;a.returnValue=false}return false};FarPoint.System.GetMouseCoords=function(a){return a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}};FarPoint.System.GetOffsetTop=function(a){var c=0,b=a;while(a){if(a.tagName!="HTML"&&typeof a.tagName!="undefined")c+=typeof a.offsetTop!="undefined"?a.offsetTop:0;if(typeof a.clientTop=="number")c+=a.clientTop;a=a.offsetParent}while(b){if(b.tagName!="HTML"&&typeof b.tagName!="undefined")c-=typeof b.scrollTop!="undefined"?b.scrollTop:0;b=b.parentNode}return parseInt(c)};FarPoint.System.GetOffsetLeft=function(a){var b=0;while(a){if(a.tagName!="HTML"&&typeof a.tagName!="undefined")b+=typeof a.offsetLeft!="undefined"?a.offsetLeft:0-typeof a.scrollLeft!="undefined"?a.scrollLeft:0;if(typeof a.clientLeft=="number")b+=a.clientLeft;a=a.offsetParent}return parseInt(b)};FarPoint.System.AttachEvent=function(target,event,handler,useCapture){if(typeof handler=="string"){var h=eval(handler);if(typeof h=="function"){FarPoint.System.DetachEvent(target,event,h,useCapture);handler=h}else return}if(target==null||event==null||handler==null)return;if(target.addEventListener!=null){if(event.indexOf("on")==0)event=event.substr(2);target.addEventListener(event,handler,useCapture)}else target.attachEvent!=null&&target.attachEvent("on"+event,handler)};FarPoint.System.DetachEvent=function(a,c,b,d){if(a==null||c==null||b==null)return;if(a.removeEventListener!=null)a.removeEventListener(c,b,d);else a.detachEvent!=null&&a.detachEvent("on"+c,b)};FarPoint.System.LinkedNode=function(a){this.index=a;this.value=null;this.prev=null;this.next=null;this.child=null;this.order=-1};FarPoint.System.LinkedNode.prototype={"get":function(d,e){var b=null,a=this;if(d<a.index){while(a.prev!=null&&a.prev.index>=d)a=a.prev;if(!e&&d!=a.index){b=new FarPoint.System.LinkedNode(d);b.next=a;b.prev=a.prev;b.order=a.order;a.prev=b;a.order=b.order+1;var c=a;while(c.next!=null){c.next.order=c.order+1;c=c.next}a=b}}else if(d>a.index){while(a.next!=null&&a.next.index<=d)a=a.next;if(!e&&d!=a.index){b=new FarPoint.System.LinkedNode(d);b.prev=a;b.next=a.next;b.order=a.order+1;a.next=b;var c=b;while(c.next!=null){c.next.order=c.order+1;c=c.next}a=b}}return a.index==d?a:null},childs:function(b){var a=this.child;if(a==null){a=new FarPoint.System.LinkedNode(Number.NEGATIVE_INFINITY);a.value="";this.child=a}return a.get(b)},root:function(){var a=this;while(a.prev!=null)a=a.prev;return a},count:function(){var b=0,a=this.root();while(a.next!=null){b++;a=a.next}return b},toString:function(){var b=this.root(),a,d,c="";while(b.next!=null){b=b.next;if(b.child!=null){a=b.child.next;d=a.value!=null?a.value:"";c+=d;while(a.next!=null){a=a.next;d=a.value!=null?a.value:"";c+="\t"+d}}if(b.next!=null)c+="\r\n"}return c}};FarPoint.System.LinkedNode.load=function(k,j,e){for(var i=k.split("\r\n"),b=new FarPoint.System.LinkedNode(-1),a,g,f,c=0;c<i.length;c++){g=c+j;b=b.get(g);var h=i[c].split("\t");a=b.childs(e);for(var d=0;d<h.length;d++){f=d+e;a=a.get(f);a.value=h[d]}}return b.root()};FarPoint.System.Track=function(c){if(!FarPoint.System.Config.Consts.$FLAG_ISDEBUG)return;if(document.getElementById("txtOutput")==null){var a=document.createElement("textarea");a.id="txtOutput";a.style.width="100%";a.style.height="100px";if(a.style.bottom!=null&&a.style.right!=null){a.style.bottom="0px";a.style.right="0px"}a.style.color="#00ff00";a.style.position="absolute";a.style.backgroundColor="black";if(FarPoint.System.CheckBrowserByName("IE"))window.onload=function(){document.all&&document.body.readyState=="complete"&&document.body.appendChild(a)};else document.body.appendChild(a)}var b=document.getElementById("txtOutput");if(b!=null)b.value="&nbsp;&nbsp;"+c+"\r\n"+b.value};FarPoint.System.Config={};FarPoint.System.Config.Consts={};var fpSCConsts=FarPoint.System.Config.Consts;fpSCConsts.$FLAG_ISDEBUG=false;fpSCConsts.$LEFT=37;fpSCConsts.$RIGHT=39;fpSCConsts.$UP=38;fpSCConsts.$DOWN=40;fpSCConsts.$ENTER=13;fpSCConsts.$CANCEL=27;fpSCConsts.$PageUp=33;fpSCConsts.$PageDown=34;fpSCConsts.$Home=36;fpSCConsts.$End=35;fpSCConsts.$Tab=9;FarPoint.System.WebControl={};FarPoint.System.WebControl.MultiColumnComboBoxCellTypeUtilitis={};var fpSWMccbctUtilitis=FarPoint.System.WebControl.MultiColumnComboBoxCellTypeUtilitis,fpSWMccbctUConsts=fpSWMccbctUtilitis.Consts={$ATTRI_MULTICOMBO_PART_TYPE:"MccbPartType",$ATTRI_LIST_ALIGNMENT:"MccbListAlignment",$ATTRI_LIST_OFFSET:"MccbListOffset",$ATTRI_LIST_WIDTH:"MccbListWidth",$ATTRI_LIST_HEIGHT:"MccbListHEIGHT",$ATTRI_COLUMN_EDIT:"MccbColumnEdit",$ATTRI_COLUMN_DATA:"MccbColumnData",$ATTRI_ID:"MccbId",$ATTRI_LIST_MIN_HEIGHT:"MccbListMinHeight",$ATTRI_LIST_MIN_WIDTH:"MccbListMinWidth",$TYPE_DROPDOWNBUTTON:"DropDownButton",$ID_BUTTON_OUTSIDE:"_DropDownButtonOutside",$ID_BUTTON_INSIDE:"_DropDownButtonInside",$ID_INPUT:"_Input",$ID_CONTAINER:"_Container",$ID_CONTAINER_DIV:"_ContainerDiv",$ID_SPREAD:"_FpSpread",$ID_STATUS_RESIZE:"_ResizeButton",$OBJECT_SUFFIX:"_Obj"};fpSWMccbctUtilitis.CloseAll=function(){var a=document.body.lastChild;if(a!=null&&a.tagName!=null&&a.tagName=="DIV")a.id!=null&&a.close&&a.id.match(new RegExp(fpSWMccbctUConsts.$ID_CONTAINER_DIV+"$"))&&a.close()};FarPoint.System.WebControl.MultiColumnComboBoxCellType=function(p,q){this.mcID=p;this.mc=document.getElementById(p);if(this.mc==null)return null;var e=true,a=null,o=false,n=false,f=-1,k=0,i=false,l=0,m=0,h=50,g=200,y=false,b=this,d=null,j=18,v=1,A=3,w=12,D=4,C=7,c=9,r=16,x=13,u=6,z=17,t=14,s=15,B=8;this.getLoadState=function(){var a=this.getFpSpread(),b=!e&&a!=null&&typeof a.isInitialized!="undefined";return b};this.IsInitializing=function(){return e};this.IsInitialized=function(){var a=this.getControl();return a!=null&&a.Init};this.Init=function(){var a=this.getFpSpread();$$.spread.ready(a,function(){if(e){this.InitSpread();this.setController();(!$$.browser.ie||$$.browser.version!=9)&&this.AttachEvents();this.Value=null;this.Text=null;var a=this.getControl(),b=FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_BUTTON_INSIDE,fpSWMccbctUConsts.$ATTRI_ID);if(a!=null&&b!=null)if(a.offsetHeight-5>0)b.style.height=a.offsetHeight-5;this.setListWidth(parseInt(this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_WIDTH)));this.setListHeight(parseInt(this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_HEIGHT)));if($$.browser.ie&&$$.browser.version>9&&a){this._controlMouseUpDelegate=Function.CreateDelegate(this,this.onControlMouseUp);$$.utils.attachEvent(a,"mouseup",this._controlMouseUpDelegate,false)}a.Init=true;e=false}if(this.onInitCompletedHandler){this.onInitCompletedHandler(this);this.onInitCompletedHandler=null}},this)};this.DetachEvents=function(){if(a!=null){var b=0;while(b<j){this.SetHandler(a,b,1);b++}}this.textBoxBlurHandler!=null&&$$.utils.detachEvent(this.getInputControl(),"blur",this.textBoxBlurHandler)};this.AttachEvents=function(){if(a==null)return;var b=0;while(b<j){if(b==0||b==1||b==3||b==13||b==17){b++;continue}this.SetHandler(a,b,0);b++}};this.NoScroll=function(a){a.target.scrollLeft=0;a.target.scrollTop=0};this.SetBlurEventHandler=function(c){var a=this.getFpSpread();if(a!=null&&(typeof a.getAttribute=="function"&&a.getAttribute("EnableClientScript")==null||a.getAttributeInternal&&a.getAttributeInternal("EnableClientScript")==null)){if(this.textBoxBlurHandler==null)this.textBoxBlurHandler=Function.CreateDelegate(this,this.OnTextBoxBlur);var b=this.getInputControl();if(c){$$.utils.detachEvent(b,"blur",this.textBoxBlurHandler);$$.utils.attachEvent(b,"blur",this.textBoxBlurHandler)}else $$.utils.detachEvent(this.getInputControl(),"blur",this.textBoxBlurHandler)}};this.Dispose=function(){var f=this.getFpSpread();$$.spread.removeHandlerByContextWhenReady(f,this);var i=this.getController();if(!i)return;for(var e in a){var h=a[e];if(h==null)continue;this.SetHandler(a,e,1)}var c=this.getControl();$$.browser.ie&&$$.browser.version>9&&c&&$$.utils.detachEvent(c,"mouseup",this._controlMouseUpDelegate,false);if($$.browser.mb){if(this.HostMouseWheelCallBack){var b=this.getHostSpreadView();if(b){var g=b.CallBacks;g.topic("MouseWheel").unsubscribe(this.HostMouseWheelCallBack)}this.HostMouseWheelCallBack=null}if(this.HostMouseWheelEventHandler){var d=this.HostMouseWheelEventHandler;document.removeEventListener(d.eventName,d.eventHandler,false);this.HostMouseWheelEventHandler=null}}};this.getDragOffsetX=function(){return l};this.setDragOffsetX=function(a){l=a};this.getDragOffsetY=function(){return m};this.setDragOffsetY=function(a){m=a};this.getStatusBarHeight=function(){return 13};this.getIsDrag=function(){return i};this.setIsDrag=function(c){var b=12;i=c;if(i)this.SetHandler(a,b,0);else this.SetHandler(a,b,1)};this.getHostSpread=function(){if(d==null){var a=this.getFpSpread();if(a==null)return null;this._getHostSpreadId(a)}return document.getElementById(d)};this.getHostSpreadView=function(){var a=this.getHostSpread();return a!=null&&a.getSpreadView?a.getSpreadView():null};this.getInnerSpreadView=function(){var a=this.getFpSpread();return a?a.getSpreadView():null};this._getHostSpreadId=function(a){if(a!=null)if($$.browser.ie&&$$.browser.ieversion<9)d=a.hostspread;else d=typeof a.getAttribute=="function"?a.getAttribute("hostspread"):a.hostspread};this.getControl=function(){if(this.mc==null||this.mc.parentNode==null||this.mc.offsetParent==null||typeof this.mc.parentNode.tagName=="undefined"||$$.browser.ie&&$$.browser.quirksMode)this.mc=document.getElementById(this.mcID);return this.mc};this.getFpSpread=function(){var b=this.getContainer();if(b==null)return null;var a=b.getElementsByTagName("div")[0];if($$.browser.ie&&$$.browser.ieversion<9)return a.FpSpread=="Spread"?a:null;else{var c=typeof a.getAttribute=="function"?a.getAttribute("FpSpread"):a.FpSpread;return c=="Spread"?a:null}};this.getContainer=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_CONTAINER,fpSWMccbctUConsts.$ATTRI_ID)};this.getContainerDiv=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_CONTAINER_DIV,fpSWMccbctUConsts.$ATTRI_ID)};this.getInputControl=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_INPUT,fpSWMccbctUConsts.$ATTRI_ID)};this.getResizeButton=function(){var a=this.getControl();return a==null?null:FarPoint.System.FindElementById(a,fpSWMccbctUConsts.$ID_STATUS_RESIZE,fpSWMccbctUConsts.$ATTRI_ID)};this.getController=function(){return a};this.setController=function(){if(a==null){a={1:{target:document,event:"mousedown",handler:function(a){b.MouseDownOutside(a)},useCapture:false},3:{target:document,event:"mouseup",handler:function(a){b.MouseUpOutside(a)},useCapture:false},12:{target:document,event:"mousemove",handler:function(a){b.MouseMove(a)},useCapture:false},4:{target:this.getControl(),event:"mousedown",handler:function(a){b.MouseDown(a)},useCapture:false},7:{target:this.getInputControl(),event:"keydown",handler:function(a){b.OnInputKeyDown(a)},useCapture:false},6:{target:this.getContainer(),event:"mousedown",handler:Function.CreateDelegate(this,this.ContainerMouseDown),useCapture:false},9:{target:this.getFpSpread(),event:"SelectionChanged",handler:function(a){b.OnSpreadSelectionChanged(a)},useCapture:false},8:{target:this.getResizeButton(),event:"mousedown",handler:function(a){b.ResizeButtonMouseDown(a)},useCapture:false}};var d=$$.browser,c=this.getFpSpread();if(c!=null&&(d.ie&&$$.browser.version<9?typeof c.EnableClientScript=="undefined":c.getAttribute("EnableClientScript")==null)){var f=!d.ie||d.version>=9?"Scroll":"scroll";a[13]={target:this.getHostSpread(),event:f,handler:function(a){b.MccbctScroll(a)},useCapture:false}}var g=$$.browser.ie&&$$.browser.version==10;if(g||$$.browser.isTouchSupport){var e=Function.CreateDelegate(this,this.ResizeButton_OnStartDragging);a[14]={target:this.getContainerDiv(),event:$$.TouchEvents.TouchStart,handler:!$$.browser.isTouchEventModel?this.onPointerDown:e};a[15]={target:this.getContainerDiv(),event:$$.TouchEvents.TouchCancel,handler:function(){b.ignoreMouseUpOutside=true}};a[16]={target:c.getViewport().parentNode,event:$$.TouchEvents.TouchCancel,handler:function(){b.ignoreMouseUpOutside=true}}}a[17]={target:this.getContainerDiv(),event:"keydown",handler:function(a){b.OnInputKeyDown(a)},useCapture:false};a[18]={target:c,event:"ColWidthChanged",handler:Function.CreateDelegate(this,this.OnSpreadColWidthChanged),useCapture:false}}};this.ResizeButton_OnStartDragging=function(c){if(!$$.utils.isTouchEvent(event))return;var b=this.getContainerDiv();if(this.getIsDrag()){this.setIsDrag(false);this.Off(b,$$.TouchEvents.TouchMove);this.Off(b,$$.TouchEvents.TouchEnd);return}if(this.getResizeButton()==c.target){try{c.button=$$.browser.ie?1:0}catch(f){}$$.utils.FixPositionProperties(c);this.ResizeButtonMouseDown(c);$$.utils.cancelDefault(c);window.navigator.pointerEnabled&&c.target.setPointerCapture(c.pointerId);this.Off(b,$$.TouchEvents.TouchMove);this.Off(b,$$.TouchEvents.TouchEnd);var d=Function.CreateDelegate(this,this.ResizeButton_OnContinueDragging),e=Function.CreateDelegate(this,this.ResizeButton_OnStopDragging);a[19]={target:b,event:$$.TouchEvents.TouchMove,handler:d};a[20]={target:b,event:$$.TouchEvents.TouchEnd,handler:e};this.On(b,$$.TouchEvents.TouchMove);this.On(b,$$.TouchEvents.TouchEnd)}};this.ResizeButton_OnContinueDragging=function(a){$$.utils.FixPositionProperties(a);this.MouseMove(a);$$.utils.cancelDefault(a)};this.ResizeButton_OnStopDragging=function(b){var a=this.getContainerDiv();this.Off(a,$$.TouchEvents.TouchMove);this.Off(a,$$.TouchEvents.TouchEnd);$$.utils.FixPositionProperties(b);this.MouseUpOutside(b)};this._GetHandlerIndex=function(c,e){var b=this.getController();for(var d in b){var a=b[d];if(a&&a.event==e&&(c==null||a.target==c))return parseInt(d)}return-1};this.On=function(){var a=arguments.length==1?null:arguments[0],c=arguments.length==1?arguments[0]:arguments[1],b=this._GetHandlerIndex(a,c);this.SetHandler(this.getController(),b,0)};this.Off=function(){var a=arguments.length==1?null:arguments[0],c=arguments.length==1?arguments[0]:arguments[1],b=this._GetHandlerIndex(a,c);this.SetHandler(this.getController(),b,1)};this.getIsDrop=function(){return o};this.setIsDrop=function(a){o=a};this.getIsDroping=function(){return n};this.setIsDroping=function(a){n=a};this.getListAlignment=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_ALIGNMENT);return parseInt(a)}catch(b){return 0}};this.getListOffset=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_OFFSET);return parseInt(a)}catch(b){return 0}};this.getListWidth=function(){return h};this.setListWidth=function(a){if(a<this.getListMinWidth()&&a!=-1)h=this.getListMinWidth();else h=a};this.getListHeight=function(){return g};this.setListHeight=function(a){if(a<this.getListMinHeight())g=this.getListMinHeight();else g=a};this.getListMinWidth=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_MIN_WIDTH);return Math.min(Math.abs(parseInt(a)),32767)}catch(b){return 50}};this.getListMinHeight=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_LIST_MIN_HEIGHT);return Math.min(Math.abs(parseInt(a)),32767)}catch(b){return 50}};this.getEditColumnIndex=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_COLUMN_EDIT);return parseInt(a)}catch(b){return 0}};this.setSelectedIndex=function(a){f=a};this.getSelectedIndex=function(){if(f!=-1){var b=this.getFpSpread(),a=parseInt(b.ActiveRow);if(b)a>=0&&this.setSelectedIndex(a)}return f};this.setActiveColumnIndex=function(a){k=a};this.getActiveColumnIndex=function(){return k};this.getDataColumnIndex=function(){try{var a=this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_COLUMN_DATA);return parseInt(a)}catch(b){return 0}};this.getWorkEnvironment=function(){try{var a=this.getControl().getAttribute("environment");if(a==null)a=-1;return parseInt(a)}catch(b){return-1}};this.releaseHostCapture=function(b){if(!$$.browser.ie||$$.browser.version!=9)return;var a=b==null?this.getHostSpread():b;if(a!=null&&a.captureElement!=null){document.releaseCapture();a.captureElement=null}else if(a!=null&&a.getSpreadView&&b==null){var c=a.getSpreadView().GetTopSpreadView().Spread;a!=c&&this.releaseHostCapture(c)}};this._isFocusable=function(){var a=this.getHostSpreadView();return a!=null&&(!a.IsInTouchMode()&&!a.IsMultiBrowserMode()||a.IsSpreadActive())};this.FocusForEdit=function(){var c=this.getControl();if(c==null)return;if(c.parentNode==null||typeof c.parentNode.tagName=="undefined")return;if(c.parentNode.tagName!="TD")return;if(c.parentNode.getAttribute("FpCellType")!="MultiColumnComboBoxCellType")return;if(!this._isFocusable())return;var b=this.getInputControl();if(b!=null){try{var d=$$.browser.chrome?b.value:"";if(d.length>0)b.value="";this.releaseHostCapture();b.focus();if(d.length>0)b.value=d;if($$.browser.mb&&b.value.length==0&&!FarPoint.System.WebControl.MultiColumnComboBoxCellType.__byPassTextBoxCursorIssue){b.blur();b.focus();FarPoint.System.WebControl.MultiColumnComboBoxCellType.__byPassTextBoxCursorIssue=true}var e=this.getHostSpread().getSpreadView();if(e.IsInTouchMode())e.RegisterTimeoutTask(Function.CreateDelegate(this,function(){$$.utils.selectAll(b)}),0,"EditorSelectAllText",true);else $$.utils.selectAll(b)}catch(f){}this.SetHandler(a,7,1);this.SetHandler(a,7,0)}};this.LockFocus=function(k,h){if(this.mc==null)return;var a=this.getInputControl();if(a==null||a.focus==null)return;if(!h&&!this._isFocusable())return;var b=this.getHostSpread();if(b==null)return;if(b.getSpreadView){var g=this.getControl(),i=b.getSpreadView().GetSpreadContext(),d=i.getCell(g),e=b.getAnchorCell();if(e!=null&&e!=d){var f=b.getSpreadView();if(!f.IsColumnHeaderCell(d)&&f.IsRowHeaderCell(d)&&(a.selectionStart||a.selectionEnd)){a.selectionStart=a.selectionEnd=0;b.focus&&b.focus()}return}}try{var c=$$.browser.chrome?a.value:"";if(c.length>0)a.value="";this.releaseHostCapture();a.focus();if(c.length>0)a.value=c;$$.utils.selectAll(a)}catch(j){}};this.OnSpreadColWidthChanged=function(){this.ignoreMouseUpOutside=true;setTimeout(Function.CreateDelegate(this,function(){this.ignoreMouseUpOutside=false}),0)};this.ContainerMouseDown=function(b){this.ignoreMouseUpOutside=false;var a=this.getFpSpread(),c=a&&a.getSpreadView().IsMultiBrowserMode();if(c){this.SetBlurEventHandler(false);this._containerMouseUpHandler=Function.CreateDelegate(this,this.ContainerMouseUp);$$.utils.attachEvent(document,"mouseup",this._containerMouseUpHandler,false);!a.getSpreadView().IsInTouchMode()&&!$$.utils.isRightClick(b)&&a.getAnchorCell()==null&&$$.utils.isOverScrollbar(b)&&$$.utils.contains(a,b.target)&&a.GetRowCount()>0&&a.SetActiveCell(0,this.getActiveColumnIndex());$$.utils.cancelBubble(b)}else this.CancelEvent(b)};this.ContainerMouseUp=function(a){this.LockFocus();this.SetBlurEventHandler(true);$$.utils.detachEvent(document,"mouseup",this._containerMouseUpHandler,false);$$.utils.cancelBubble(a,true)};this.MouseDown=function(c){this.ignoreMouseUpOutside=false;if(this.getControl().getAttribute("disabled")=="disabled")return FarPoint.System.CancelDefault(c);var e=$$.browser,i=this.getIsDrop();if(!i&&c.button!=(e.ie?1:0)&&!(e.ie&&e.version>=9&&c.button<=1))return;var g=this.getHostSpread(),a=g!=null&&g.getSpreadView?g.getSpreadView():null,f=FarPoint.System.GetTarget(c);if(f==null||f.getAttribute(fpSWMccbctUConsts.$ATTRI_MULTICOMBO_PART_TYPE)!=fpSWMccbctUConsts.$TYPE_DROPDOWNBUTTON)return false;else if(a!=null)if(a.IsReadyToFilter())return;else{var d=a.GetTopSpreadView().GetEditingSpread(),f=c.target||c.srcElement;if(d&&!$$.utils.contains(d.getAnchorCell(),f)&&!d.EndEdit())return}this.setIsDroping(true);var j=$$.browser.mb?this:null;if(a!=null){var h=a._GetTimeoutTask("ShowHideContainer");h!=null&&a.UnregisterTimeoutTask(h.Type);a.RegisterTimeoutTask(function(){b.ProcessShowHideContainer({dropped:i})},150,"ShowHideContainer",true)}else setTimeout(this.ProcessShowHideContainer,150)};this.ProcessShowHideContainer=function(c){var f=c!=null&&c.dropped!=null?c.dropped:b.getIsDrop(),a=b.getFpSpread();if(a!=null){if(!f&&a.getAttribute("EnableClientScript")!="0"){var d=b.getHostSpread().getSpreadView();if(!a.getSpreadView)return;var e=a.getSpreadView();if(d.Touch&&e.Touch)e.Touch.IsInTouchMode=d.Touch.IsInTouchMode}b.ShowHideContainer(!f)}};this.ShowHideContainerInScroll=function(){var c=this.getHostSpread(),b=c.getSpreadView(),a=b._GetTimeoutTask("ShowHideContainer");if(a!=null){b.UnregisterTimeoutTask(a.Type);b.RegisterTimeoutTask(this.ProcessShowHideContainer,a.Delay,a.Type,true,a.SpreadView)}};this.DropDown=function(){if(!this.getIsDrop()){var c=true,b=this.getHostSpread();if(b!=null&&b.getSpreadView){var a=b.getSpreadView();if(a.IsInTouchMode()){var d=a._GetTimeoutTask("ShowHideContainer");if(d==null){a.RegisterTimeoutTask(this.ProcessShowHideContainer,200,"ShowHideContainer",true);c=false}}}c&&this.ShowHideContainer(true)}else this.ShowHideContainer(false)};this.IsInputKey=function(a){if(a.altKey&&a.keyCode==fpSCConsts.$DOWN)return true;switch(a.keyCode){case fpSCConsts.$UP:case fpSCConsts.$LEFT:case fpSCConsts.$DOWN:case fpSCConsts.$RIGHT:case fpSCConsts.$ENTER:case fpSCConsts.$CANCEL:case fpSCConsts.$PageUp:case fpSCConsts.$PageDown:case fpSCConsts.$Home:case fpSCConsts.$End:case fpSCConsts.$Tab:return true;default:return false}};this.OnInputKeyDown=function(a){var d=this.getHostSpread(),c=d&&d.getSpreadView?d.getSpreadView():null;!this.getIsDrop()&&c&&c.IsInTouchMode()&&c.Touch.ExitFromTouchMode();if(a.altKey&&a.keyCode==fpSCConsts.$DOWN){if(this.getIsDrop())this.ShowHideContainer(false);else if(c&&c.IsMultiBrowserMode()){var i=c.GetSpreadContext(),e=i.getCell(this.getInputControl());if(e&&c._IsCellHidden(e,true)){this.Off("Scroll");var h=this;i.scrollToCell(e,{afterScrollHandler:function(){h.ProcessShowHideContainer();setTimeout(function(){h.On("Scroll")},0)}})}else this.ProcessShowHideContainer()}else this.ProcessShowHideContainer();FarPoint.System.CancelDefault(a);return false}var g=this.getHostSpreadView(),f=g&&g.IsMultiBrowserMode();($$.browser.ie&&$$.browser.version<8||f)&&!this.getIsDrop()&&(a.keyCode==fpSCConsts.$PageUp||a.keyCode==fpSCConsts.$PageDown||a.keyCode==fpSCConsts.$Home||a.keyCode==fpSCConsts.$End)&&FarPoint.System.CancelDefault(a);switch(a.keyCode){case fpSCConsts.$UP:if(this.getIsDrop()){this.ChangeSelectedIndex(-1);var b=this.getFpSpread();b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CancelDefault(a)}else f&&$$.utils.cancelDefault(a);break;case fpSCConsts.$LEFT:if(this.getIsDrop()){this.ChangedActiveColumnIndex(true);FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$DOWN:if(this.getIsDrop()){this.ChangeSelectedIndex(1);var b=this.getFpSpread();b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CancelDefault(a)}else f&&$$.utils.cancelDefault(a);break;case fpSCConsts.$RIGHT:if(this.getIsDrop()){this.ChangedActiveColumnIndex(false);FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$ENTER:if(this.getIsDrop()){this.ShowHideContainer(false);FarPoint.System.CancelDefault(a)}if(!FarPoint.System.CheckBrowserByName("safari")&&this.getFpSpread().getAttribute("EnableClientScript")=="0")return FarPoint.System.CancelDefault(a);break;case fpSCConsts.$CANCEL:this.getIsDrop()&&this.ShowHideContainer(false);FarPoint.System.CancelDefault(a);break;case fpSCConsts.$PageUp:if(this.getIsDrop()){this.ChangeSelectedIndex(null,1);var b=this.getFpSpread();b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$PageDown:if(this.getIsDrop()){this.ChangeSelectedIndex(null,2);var b=this.getFpSpread();b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$Home:if(this.getIsDrop()){this.ChangeSelectedIndex(null,3);var b=this.getFpSpread();b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$End:if(this.getIsDrop()){this.ChangeSelectedIndex(null,4);var b=this.getFpSpread();b.ScrollTo(b.ActiveRow,this.getActiveColumnIndex());FarPoint.System.CancelDefault(a)}break;case fpSCConsts.$Tab:this.getIsDrop()&&this.ShowHideContainer(false)}};this.OnSpreadSelectionChanged=function(g){if(this.getWorkEnvironment()==0)return;var b=this.getFpSpread();if(b==null)return;this._isSpreadSelectionChanged=true;this.setSelectedIndex(b.ActiveRow);var a=this.getInputControl();if(a==null)return;if(this.getSelectedIndex()>=0&&this.getEditColumnIndex()>=0&&this.getDataColumnIndex()>=0){a.value=b.GetValue(this.getSelectedIndex(),this.getEditColumnIndex());this.Text=a.value;if(this.GetUseValue()==1)this.Value=b.GetValue(this.getSelectedIndex(),this.getDataColumnIndex());else this.Value=a.value;a.setAttribute("DataValue",b.GetValue(this.getSelectedIndex(),this.getDataColumnIndex()));var d=this.getControl(),c=false;if(d!=null&&d.parentNode!=null&&d.parentNode.getAttribute("FpCellType")=="MultiColumnComboBoxCellType")c=true;if(c){var e=this.getHostSpread(),f;c=e!=null&&e.getAnchorCell&&(f=e.getAnchorCell())!=null&&$$.utils.contains(f,d)}g!=null&&c&&$$.utils.selectAll(a)}FarPoint.System.GetEvent(g).cancelBubble=true;if(this.ignoreMouseUpOutside)try{delete this.ignoreMouseUpOutside}catch(h){this.ignoreMouseUpOutside=null}};this.CancelEvent=function(a){if(this.getIsDrop()){this.LockFocus(a);var b=this;setTimeout(function(){b.LockFocus(a)},0)}return FarPoint.System.CancelDefault(a)};this.MouseDownOutside=function(f){this.ignoreMouseUpOutside=false;this.getIsDrag()&&this.setIsDrag(false);var g=this.getContainerDiv(),d=this.getControl(),e=this.getFpSpread();if(d==null||e==null)return;var i=document.getElementById(e.id+"_viewport"),b=FarPoint.System.GetTarget(f);if(!FarPoint.System.IsChild(g,b)&&!FarPoint.System.IsChild(d,b)){this.setIsDroping(false);this.getIsDrop()&&this.ShowHideContainer(false)}var h=this,c=this.getHostSpread(),a=c!=null&&c.getSpreadView?c.getSpreadView():null;if(a!=null&&(a.IsControl(b)||a.HasFilterBar()&&GCWS.FilterEditor.IsFilterControl(b)))return;a!=null&&a.RegisterTimeoutTask(function(){h.LockFocus(f)},0)};this.MouseUpOutside=function(a,j){if(this.ignoreMouseUpOutside){if(j){var e=this;setTimeout(function(){e.LockFocus(a)},0)}return}var d=FarPoint.System.GetTarget(a),b=this.getControl(),c=this.getFpSpread();if(b==null||c==null)return;if(b.__notInited){b.__notInited=null;return}if(this.getIsDroping()&&FarPoint.System.IsChild(b,d)){this.setIsDroping(false);return}if(this.getIsDrop()==false)return;if(this.getIsDrag()){this.setIsDrag(false);if($$.browser.ie&&$$.browser.version<9){var g=this.getInputControl();if(g!=null){this.releaseHostCapture();g.focus()}}return}var h=this.getContainerDiv(),f=document.getElementById(c.id+"_viewport"),i=c.getSpreadView().GetSpreadContext();if(!i.isWorking()&&($$.browser.ieversion<9||!$$.utils.isOverScrollbar(a,f.parentNode)))(FarPoint.System.IsChild(f,d)&&!$$.utils.isRightClick(a)&&(a.pointerType==null||!$$.utils.isTouchEvent(a)||this._isSpreadSelectionChanged)||!FarPoint.System.IsChild(h,d))&&this.ShowHideContainer(false);var e=this;setTimeout(function(){e.LockFocus(a)},0)};this.ResizeButtonMouseDown=function(a){this.ignoreMouseUpOutside=false;this.LockFocus(a);if(a.button!=(FarPoint.System.CheckBrowserByName("IE")?1:0)&&!($$.browser.ie&&$$.browser.version>=9&&a.button<=1))return;var b=this.getContainer();if(b==null)return;var c=FarPoint.System.GetMouseCoords(a);this.setDragOffsetX(parseInt(b.offsetLeft+b.offsetWidth)-c.x);this.setDragOffsetY(parseInt(b.offsetTop+b.offsetHeight)-c.y);this.setIsDrag(true);a.preventDefault&&a.preventDefault();a.returnValue=false;a.cancelBubble=true;return false};this.MouseMove=function(b){if(this.getIsDrag())if(!$$.browser.ie&&(b.buttons==0||b.which==0)&&b.type!="touchmove"||$$.browser.ie&&$$.browser.version>=10&&(b.buttons==0||b.buttons==null&&b.button==0)){this.setIsDrag(false);return}if(!this.getIsDrag())return;var c=this.getContainer();if(c==null)return;var f=this.getContainerDiv();if(f==null)return;var g=FarPoint.System.GetMouseCoords(b),e=g.x-parseInt(c.offsetLeft)+this.getDragOffsetX(),d=g.y-parseInt(c.offsetTop)+this.getDragOffsetY()-5;if(e>this.getListMinWidth()&&Math.abs(e-c.offsetWidth)>5){f.style.width=e+"px";c.style.width=e+"px";this.setListWidth(e+5)}if(d>this.getListMinHeight()&&Math.abs(d-c.offsetHeight)>20){var a=this.getFpSpread();if(a!=null)a.style.height=""+(d-this.getStatusBarHeight())+"px";f.style.height=d+5+"px";c.style.height=d+"px";this.setListHeight(d)}if(!$$.browser.ie||$$.browser.ieversion>=9){var a=this.getFpSpread();a!=null&&a.getSpreadView().ProcessResize();if(!$$.browser.ie&&a!=null){var h=a.style.width;a.style.width=parseInt(f.style.width,10)-5+"px";a.sizeSpread(true);a.style.width=h}}b.cancelBubble=true;return false};this.MccbctScroll=function(c){if($$.browser.mb)return;var a=this.getControl();if(a==null)return;var g=this.getContainer();if(g==null)return;var b=this.getContainerDiv();if(b==null)return;var f=c.srcElement?c.srcElement:c.target;if(f&&!FarPoint.System.IsChild(b,c.srcElement)){this.ShowHideContainer(false);return}if(FarPoint.System.CheckBrowserByName("safari")&&a.offsetHeight==0)b.style.top=FarPoint.System.GetOffsetTop(a)+25-this.GetSpreadClientData(this.getHostSpread(),1)+"px";else{var d=null;if(!$$.browser.ie||typeof this.getFpSpread().EnableClientScript=="undefined")d=document.getElementById(this.getHostSpread().id+"_view");var e=FarPoint.System.IsChild(d,a)?this.GetSpreadClientData(this.getHostSpread(),1):0;b.style.top=FarPoint.System.GetOffsetTop(a)+a.offsetHeight+2-e+"px"}};this.OnHostMouseWheelCallBack=function(a){if(this.getIsDrop())if(!$$.browser.ie)this.ShowHideContainer(false,false);else{a.event.preventDefault();a.cancel=true;return false}return true};this.OnHostMouseWheelEvent=function(a){this.OnHostMouseWheelCallBack({event:a})};this.GetAdjustorForScroll=function(){var g=0,h=0,m=new String(this.getControl().getAttribute(fpSWMccbctUConsts.$ATTRI_ID)),b=m.split(new RegExp("_"))[3],a=this.getHostSpread(),l=FarPoint.System.CheckBrowserByName("safari"),c={left:0,top:0};if(this.getFpSpread().getAttribute("EnableClientScript")=="0")return c;g=a.GetActiveRow();h=a.GetActiveCol();if(l){if(b!="sc"&&b!="rh")c.left=this.GetSpreadClientData(a,0);if(b!="ch"&&b!="cf"&&b!="sc")c.top=this.GetSpreadClientData(a,1);return c}var n=a.getViewport(),i=a.getViewport0(),j=a.getViewport1(),k=a.getViewport2(),f=0,e=0;f=j!=null?j.rows.length:0;if(i!=null){var d=i.getElementsByTagName("COLGROUP");if(d!=null&&d.length>0)e=d[0].childNodes.length}else if(k!=null){var d=k.getElementsByTagName("COLGROUP");if(d!=null&&d.length>0)e=d[0].childNodes.length}if(b!="ch"&&b!="cf"&&b!="sc"&&(f>0&&g+1>f||f==0))c.top=this.GetSpreadClientData(a,1);if(b!="sc"&&b!="rh"&&(e>0&&h+1>e||e==0))c.left=this.GetSpreadClientData(a,0);return c};this.InitSpread=function(){var a=this.getFpSpread();if(a!=null){if(window.navigator.pointerEnabled||window.navigator.msPointerEnabled){a.onPointerUp=Function.CreateDelegate(this,this.onPointerUp);a.onPointerDown=Function.CreateDelegate(this,this.onPointerDown)}a.onTouchHandleGestureTap=Function.CreateDelegate(this,this.onTouchHandleGestureTap);var b=this.getContainerDiv();b.style.msTouchAction="none";b.style.touchAction="none";b.onscroll=null;b.onscroll=this.NoScroll;this._getHostSpreadId(a)}};this.onPointerDown=function(d){if(b.ignoreMouseUpOutside)try{delete b.ignoreMouseUpOutside}catch(e){b.ignoreMouseUpOutside=null}if(b.getIsDrag())b.setIsDrag(false);else{var a=b.getResizeButton();if(d.target==a&&typeof MSGesture!="undefined"){var c=new MSGesture;b.gesture=c;c.target=a;c.addPointer(d.pointerId);a.addEventListener("MSGestureEnd",b.OnGestureEnd,false)}}};this.OnGestureEnd=function(c){if(b.getIsDrag()){b.MouseUpOutside(c);b.ignoreMouseUpOutside=true}var a=b.getResizeButton();if(a){a.removeEventListener("MSGestureEnd",b.OnGestureEnd);b.gesture.stop();b.gesture=null}};this.onPointerUp=function(a){this.MouseUpOutside(a)};this.onTouchHandleGestureTap=function(a){this.MouseUpOutside(a,true)};this.onControlMouseUp=function(a){if(this.justShowPopup){this.justShowPopup=false;return $$.utils.cancelBubble(a,false)}};this.IsContained=function(a){return FarPoint.System.IsChild(this.getControl(),a)||FarPoint.System.IsChild(this.getContainer(),a)};this.GetActivePositonInDomTree=function(a){if(a==null)return false;while(a!=null&&a!=document.body){if(a.tagName=="TR"&&a.getAttribute("FpSpread")!=null)return a.getAttribute("FpSpread");a=a.parentNode}return""};this.GetSpreadClientData=function(d,f){if(this.getFpSpread().getAttribute("EnableClientScript")=="0")return 0;var b="",a=0,e=null,c=null;if(d.GetParentSpread()!=null)return;if(typeof d.getXmlDataObject=="function")c=d.getXmlDataObject();else e=document.getElementById(d.id+"_XMLDATA");var g=$$.browser.ieversion<9||c==null;if(g)switch(f){case 0:b="/root/scrollLeft";break;case 1:b="/root/scrollTop"}else switch(f){case 0:b="root scrollLeft";break;case 1:b="root scrollTop"}var a=e!=null?e.documentElement.selectSingleNode(b):c.selectSingleNode(b,g);if(a!=null){a=c!=null?c.textContent(a):a.text;if(a.length>0)a=parseInt(a)}if(a==null||isNaN(a))a=0;return a};this.SetHandler=function(e,d,f){if(isNaN(d)||d<0)return;var a=e[d];if(a==null)return;switch(f){case 0:if(!$$.browser.ie||d!=c){FarPoint.System.DetachEvent(a.target,a.event,a.handler,a.useCapture);FarPoint.System.AttachEvent(a.target,a.event,a.handler,a.useCapture)}else{var b=this.getFpSpread();if(b!=null)if($$.browser.version<9)b.onSelectionChanged=a.handler;else{$$.utils.detachEvent(b,"SelectionChanged",a.handler);$$.utils.attachEvent(b,"SelectionChanged",a.handler)}}break;case 1:if(!$$.browser.ie||d!=c)FarPoint.System.DetachEvent(a.target,a.event,a.handler,a.useCapture);else if($$.browser.version<9){var b=this.getFpSpread();if(b!=null)b.onSelectionChanged=null}else $$.utils.detachEvent(a.target,a.event,a.handler,a.useCapture)}};this.ChangeSelectedIndex=function(g,f){var e=0;if(typeof f!="undefined")e=f;var d=this.getFpSpread();if(!d)return;var b=d.GetRowCount();if(b<=0)return;var a=this.getSelectedIndex(),c=this.getActiveColumnIndex();if(c<0)c=0;switch(e){case 0:a+=g;if(a<0||a>=b)return;break;case 1:a-=5;a=Math.max(a,0);break;case 2:a+=5;a=Math.min(a,b-1);break;case 3:a=0;break;case 4:a=b-1}this.setSelectedIndex(a);d.SetActiveCell(a,c)};this.ChangedActiveColumnIndex=function(d){var b=this.getFpSpread();if(!b)return;var c=b.GetColCount();if(c<=0)return;var e=b.ActiveRow,a=this.getActiveColumnIndex();if(isNaN(a))a=0;a=d?a-1:a+1;if(a<0||a>=c){a=Math.max(a,0);a=Math.min(a,c-1);this.setActiveColumnIndex(a);return}b.ScrollTo(e,a);this.setActiveColumnIndex(a)};this.ShowHideContainer=function(v,J,z){if(this._ignoreShowHideContainer||!v&&this.justShowPopup)return;var w=z,e=this.getControl();if(e==null)return;var j=this.getContainer();if(j==null)return;var d=this.getContainerDiv();if(d==null)return;var b=this.getFpSpread(),B=$$.utils.GetCell(e);if(B&&B.offsetParent==null)return;if(b.initialized==null){var r=this.getHostSpread(),Q=r.getSpreadView().GetSpreadContext();Q.isSmartPaint()&&typeof _gcFpSpreadReg!="undefined"&&_gcFpSpreadReg(b.id,{})}var i=b.getSpreadView();if(i.Touch){this._ignoreShowHideContainer=true;i.Touch.ResetInternalFlags(true);this._ignoreShowHideContainer=false}var o=b.getViewport().parentNode,G=this._isSpreadSelectionChanged;this._isSpreadSelectionChanged=false;var C=FarPoint?FarPoint.Web?FarPoint.Web.Spread:null:null;if(v){if(window.fpPostOn){this.ShowHideContainer(false);return}var T=this.getHostSpread();d.style.zIndex=GCWS.ZIndex.POPUP;j.style.height=this.getListHeight()+"px";d.style.height=this.getListHeight()+5+"px";var l=this.GetAdjustorForScroll(),q=T.offsetParent;if(q!=null){l.top+=q.scrollTop;l.left+=q.scrollLeft}var m=0;if(this.getListAlignment()==0)m=this.getListOffset();else{var y=0;if(this.getListWidth()!=-1)y=this.getListWidth()-e.parentNode.offsetWidth;m=-(this.getListOffset()+y)}if(!i.IsMultiBrowserMode()){if(FarPoint.System.CheckBrowserByName("safari")){var L=e.offsetHeight==0?25:e.offsetHeight;d.style.top=FarPoint.System.GetOffsetTop(e)+L+q.scrollTop+"px"}else d.style.top=FarPoint.System.GetOffsetTop(e)+e.offsetHeight+"px";var F=FarPoint.System.GetOffsetLeft(e)+m;if(!isNaN(l.left))d.style.left=F-l.left+"px";else d.style.left=F+"px"}var p=this.getListWidth();if(p<0)p=Math.max(this.getListMinWidth(),e.parentNode.offsetWidth);j.style.width=p+5+"px";d.style.width=p+5+"px";var s=this.findContainer(),I=this.getWorkEnvironment();if(s!=null&&I==0)d.parentNode!=s&&s.appendChild(d);else d.parentNode!=document.body&&document.body.appendChild(d);var S=this;d.close=function(){S.ShowHideContainer(false)};if(b!=null){if(document.documentMode){b.style.backgroundColor="white";b.style.position="relative"}b.style.height=parseInt(j.style.height)-this.getStatusBarHeight()+"px"}this.setIsDrop(v);var R=this;setTimeout(function(){R.AnimShow(j)},30);if($$.browser.ie&&$$.browser.version>=10||$$.browser.webkit){var r=this.getHostSpread();if(r.getSpreadView){var H=b.getSpreadView().IsInTouchMode();this.EnableTouchMode(H)}}var x=this.getSelectedIndex();d.style.display="block";d.style.visibility="visible";if(i.IsMultiBrowserMode()){var A=e.getBoundingClientRect(),P=A.top+e.offsetHeight,O=A.left+m;$$(d).moveToPosition(O,P)}var f=this.getInnerSpreadView();if(f&&f.IsMultiBrowserMode())if(f.IsLayoutInitialized())b.sizeSpread(true,null,{NeedFixMissedColumns:true});else f.ReInitLayout();else if(document.documentMode){b.sizeSpread(false,false,{NeedFixMissedColumns:true});$$.browser.version==7&&$$.browser.ieversion>8&&b.getSpreadView().ProcessResize()}if(this.lastScrollTop!=null){o.scrollTop=this.lastScrollTop;try{delete this.lastScrollTop}catch(V){this.lastScrollTop=null}}if(this.lastScrollLeft!=null){o.scrollLeft=this.lastScrollLeft;try{delete this.lastScrollLeft}catch(V){this.lastScrollLeft=null}}b.SetActiveCell(x,0,w,!z);this.setActiveColumnIndex(0);if(!w)if(x>-1&&b.ActiveRow>-1){var K=b.getAnchorCell();b.getSpreadView()._IsCellHidden(K,true)&&b.ScrollTo(b.ActiveRow,0)}else b.ScrollTo(0,0);if($$.browser.mb){if(!this.HostMouseWheelCallBack){this.HostMouseWheelCallBack=Function.CreateDelegate(this,this.OnHostMouseWheelCallBack);var n=this.getHostSpreadView();if(n){var D=n.CallBacks;D.topic("MouseWheel").subscribe(this.HostMouseWheelCallBack)}}if(!this.HostMouseWheelEventHandler){var N=Function.CreateDelegate(this,this.OnHostMouseWheelEvent);this.HostMouseWheelEventHandler=$$.utils.addWheelListener(document,N,false)}}var M=this;setTimeout(function(){M.LockFocus(null,true)},100);var h=this;setTimeout(function(){h.SetHandler(a,1,0);h.SetHandler(a,3,0);h.SetHandler(a,13,0);h.SetHandler(a,17,0);h.SetHandler(a,18,0);h.SetHandler(a,c,1);h.SetHandler(a,c,0);h.SetBlurEventHandler(true)},0);if($$.browser.ie&&$$.browser.ieversion>9){var u=this.getControl();if(u&&u.__notInited)u.__notInited=null}if($$.browser.webkit&&C){var k=this.getHostSpreadView();k=k?k.GetTopSpreadView():null;this.safariScrollShield=C.SafariPatch.FixUnderLayerScroll(this.getContainer(),k?k.Spread:null)}}else{this.lastScrollTop=o.scrollTop;this.lastScrollLeft=o.scrollLeft;d.style.zIndex=0;d.close=null;d.style.top=-1e4;d.style.left=-1e4;d.style.display="none";d.style.visibility="hidden";e.appendChild(d);if($$.browser.mb){if(this.HostMouseWheelCallBack){var n=this.getHostSpreadView();if(n){var D=n.CallBacks;D.topic("MouseWheel").unsubscribe(this.HostMouseWheelCallBack);this.HostMouseWheelCallBack=null}}if(this.HostMouseWheelEventHandler){var E=this.HostMouseWheelEventHandler;document.removeEventListener(E.eventName,E.eventHandler,false);this.HostMouseWheelEventHandler=null}}this.SetHandler(a,1,1);this.SetHandler(a,3,1);this.SetHandler(a,13,1);this.SetHandler(a,17,1);this.SetHandler(a,18,1);this.SetBlurEventHandler(false);this.setIsDrop(false);this.EnableTouchMode(false);(!$$.browser.ie||document.documentMode)&&b.sizeSpread(false,false,{NeedFixMissedColumns:true});if(b!=null){var f=b.getSpreadView();if(f.Touch!=null){f.Touch.HideTouchHandles();f.Touch.ResizeLocation=null;f.Touch.pointers=[];f.Touch.StopTrackingGesture()}}if(b!=null&&b.getSpreadView().IsSpreadActive(true)){b=this.getHostSpread();if(b!=null&&b.getSpreadView){var i=b.getSpreadView();i.ActivateSpread(b,true);i.GetSpreadContext().paintAnchorCell(true,true)}}this.SetHandler(a,c,1);if(G&&document.FpActiveSpread==this.getFpSpread()){var r=this.getHostSpread();if(r.getSpreadView==null){document.FpActiveSpread=null;document.FpActiveSheetView=null}}if($$.browser.webkit&&this.safariScrollShield){this.safariScrollShield.parentNode.removeChild(this.safariScrollShield);this.safariScrollShield=null}}if(!J){var g=this.getInputControl();if(g!=null)try{if(this._isFocusable()){this.releaseHostCapture();var t=$$.browser.chrome?g.value:"";if(t.length>0)g.value="";g.focus();if(t.length>0)g.value=t;$$.utils.selectAll(g)}g.value.length>0&&this.getSelectedIndex()==-1&&this.SetText(g.value)}catch(U){}}};this.findContainer=function(){var c=this.getFpSpread(),a=c,b;if(c!=null)while(a!=null&&a.tagName!="FORM"&&typeof a.tagName!="undefined"){b=a;a=a.parentElement}return b};this.AnimShow=function(a){var b=a.offsetTop;if(b>=0)return;var d=b<-5?b*.25:0;a.style.top=d+"px";var c=this;setTimeout(function(){c.AnimShow(a)},30)};this.SetText=function(a,d){var c=this.getFpSpread();if(c==null)return;var e=this.getEditColumnIndex();if(d!=null&&d==0)e=this.getDataColumnIndex();if(a==null){this.resetStates();return}var j=a.match(new RegExp("^\\s*(\\S+(\\s+\\S+)*)\\s*$"));a=j==null?"":j[1];if(a.length==1&&a.charCodeAt(0)==160||a==""||a.length<=0){this.resetStates();return}if(!FarPoint.System.CheckBrowserByName("IE"))a=a.replace(new RegExp(" ","g"),String.fromCharCode(32));for(var m=c.GetRowCount(),b=0,h=false;b<m;b++)try{var g=c.GetValue(b,e);if(a==g.trim()){var l=this.getEditColumnIndex(),k=this.getDataColumnIndex(),i=c.GetValue(b,k);this.Text=d==0?c.GetValue(b,l):g;this.Value=d==0?g:i;this.setSelectedIndex(b);var f=this.getInputControl();if(f!=null){f.value=this.Text;f.setAttribute("DataValue",i)}c.SetActiveCell(b,e);h=true;break}}catch(n){return}!h&&this.resetStates()};this.resetStates=function(){var b=this.getFpSpread();if(b==null)return;var a=this.getInputControl();if(a!=null){a.value="";a.setAttribute("DataValue","");this.Text=null;this.setSelectedIndex(-1)}b.SetActiveCell(-1,-1)};this.GetUseValue=function(){try{var a=this.getControl().getAttribute("UseValue");if(a==null)a=0;return parseInt(a)}catch(b){return 0}};this.GetShowButton=function(){try{var a=this.getControl().getAttribute("ShowButton");if(a==null)a=0;return parseInt(a)}catch(b){return 0}};this.SetValueToDataColumn=function(a){this.SetText(a,0)};this.SetValueToTextColumn=function(a){this.SetText(a,1)};this.getValue=function(f,i){var a=this.getFpSpread();if(a==null)return;var d=this.getDataColumnIndex(),e=this.getEditColumnIndex(),g=f==0?d:e,k=a.GetRowCount(),c=null;if(i==null){var h=this.getSelectedIndex();c=h>=0&&g>=0?a.GetValue(h,g):null}else for(var b=0;b<k;b++){var j=a.GetValue(b,e);if(j==i){c=f==0?a.GetValue(b,d):j;break}}return c};this.GetCurrentValue=function(a){if(this.Value==null){this.updateTextToCell(a);this.Value=this.GetUseValue()==1?this.getValue(0):this.getValue(1)}return this.Value};this.updateTextToCell=function(a){var c=null,b=a.getElementsByTagName("INPUT");if(b!=null&&b.length>0)c=b[0].value;else c=a.innerText?a.innerText:a.textContent;this.SetValueToTextColumn(c)};this.GetCurrentText=function(a){if(this.Text==null){this.updateTextToCell(a);this.Text=this.getValue(1)}return this.Text};this.GetValueFromDataColumn=function(a){return this.getValue(0,a)};this.GetValueFromTextColumn=function(a){return this.getValue(1,a)};this.GetValueByText=function(b){this.SetValueToTextColumn(b);var a=this.getValue(0);return a};this.GetTextByValue=function(a){this.SetValueToDataColumn(a);var b=this.getValue(1);return b};this.TestProps=function(){!fpSCConsts.$FLAG_ISDEBUG};this.OnTextBoxBlur=function(){if(this.getIsDrag()||this.getInputControl()==document.activeElement)return;var a=$$.utils.getDocActiveElement(),b=this.getContainer();a!=null&&!FarPoint.System.IsChild(b,a)&&!FarPoint.System.IsChild(this.getControl(),a)&&this.getIsDrop()&&this.ShowHideContainer(false,true)};this.EnableTouchMode=function(f){var a="28px",b=this.getFpSpread(),e=b.GetRowCount();if(e<=0)return;var d=b.Rows(0).style.height;if(f){if(this.__backupHeight==null)this.__backupHeight=d}else if(this.__backupHeight!=null)a=this.__backupHeight;else return;if(d==a)return;for(var c=0;c<e;c++)b.Rows(c).style.height=a};!q&&this.Init()};FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetInstance=function(b,c,d){var a=window[b+fpSWMccbctUConsts.$OBJECT_SUFFIX];if(!a&&d&&document.getElementById(b)!=null)a=new FarPoint.System.WebControl.MultiColumnComboBoxCellType(b,c);return a};FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit=function(b,c){var d=document.getElementById(b);if(d==null){d=document.getElementById(b+"Editor");b+="Editor"}var g=b+fpSWMccbctUConsts.$OBJECT_SUFFIX;if(d&&d.Init){c&&c(FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetInstance(b));return false}var h=$$.browser.mb,a=FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetInstance(b);if(h)if(a&&a.IsInitializing()){a.onInitCompletedHandler=c;return false}if(h&&!c&&a&&a.onInitCompletedHandler)c=a.onInitCompletedHandler;try{if(a){a.Dispose();window[g]=null}}catch(i){}var f=false;if(!$$.browser.ie||$$.browser.ie&&$$.browser.version>=10){var e=$$(d).getChildTag("DIV","FpSpread","Spread");if(e!=null&&e.Behavior==null){_gcFpSpreadReg(e.id);f=true}}a=FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetInstance(b,true,true);if(a){a.onInitCompletedHandler=c;a.Init()}window[g]=a;return f};FarPoint.System.WebControl.MultiColumnComboBoxCellType.Show=function(id,event){if(event!=null&&$$.browser.ie&&$$.browser.ieversion>=10&&event.button!=0)return;var editor=document.getElementById(id);if(editor.__notInited=FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(id)){var obj=eval(id+fpSWMccbctUConsts.$OBJECT_SUFFIX),sv=obj.getHostSpreadView(),ctx=sv?sv.GetSpreadContext():null;if(sv&&$$.browser.ieversion>=10&&ctx.isSmartPaint())if(event&&event.type=="mousedown"){var cell=ctx.getCell(obj.getInputControl());if(cell&&sv._IsCellHidden(cell,true)){obj.SetHandler(obj.getController(),13,1);ctx.scrollToCell(cell);obj.MouseDown(event);setTimeout(function(){obj.SetHandler(obj.getController(),13,0)},0)}else obj.MouseDown(event);return false}if(event&&event.type=="mousedown"&&$$.browser.ie&&$$.browser.version>9&&$$.utils.contains(obj.getControl(),event.target,true))obj.justShowPopup=true;obj.DropDown();return false}};FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetMcctId=function(d){var c="",b=document.getElementById(d);if(b!=null){if(b.__mcctIdCached!=null)return b.__mcctIdCached;var a=b.parentNode;while(a!=null&&a.tagName!="BODY"){if(a.getAttribute("FpEditor")!=null){c=a.id;b.__mcctIdCached=c;break}a=a.parentNode}}return c};FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetMcctObject=function(c){var a=FarPoint.System.WebControl.MultiColumnComboBoxCellType.GetMcctId(c),b=null;if(a.length>0){FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(a);b=window[a+fpSWMccbctUConsts.$OBJECT_SUFFIX]}return b};FarPoint.System._ExtenderHelper=function(){this.ScriptHolderID="__PAGESCRIPT";this.ScriptBlockID="__SCRIPTBLOCK";this.StartupScriptID="__STARTUPSCRIPT";this.ExpandosID="__EXPANDOSCRIPT";this.ArrayDeclares="__ARRAYDECLARES";this.CssLinksID="__CSSLINKS"};FarPoint.System._ExtenderHelper.prototype={getExtenderScripts:function(buff){for(var extenderScripts={},inputs=buff?buff.getElementsByTagName("input"):document.getElementsByTagName("input"),i=0;i<inputs.length;i++){var match=inputs[i].id.match(new RegExp("^(.+)_extender$"));if(match&&match.length==2){var spreadID=match[1],ownerSpread=$get(spreadID);if(ownerSpread&&(ownerSpread.FpSpread=="Spread"||ownerSpread.getAttribute("FpSpread")=="Spread")){var json=inputs[i].json||inputs[i].getAttribute("json"),tmp=eval("("+json+")");this.mergeExtenderScripts(extenderScripts,tmp.extenderScripts)}}}return extenderScripts},mergeExtenderScripts:function(b,e){for(var a in e){var c=e[a];if(!b[a])b[a]=c;else for(var d=0;d<c.length;d++){var f=c[d];!Array.contains(b[a],f)&&b[a].push(f)}}},getNeededExtenderScripts:function(f,e,d){var i=[],h=[];for(var j in f)Array.addRange(i,f[j]);for(var j in d)Array.addRange(h,d[j]);for(var b=[],g=document.getElementsByTagName("script"),c=0;c<e.length;c++){var a=e[c];if(!Array.contains(h,a)&&Array.contains(i,a)&&!this.checkInclude(a,g))b.push(a);else(a.indexOf("_TSM_CombinedScripts_")>=0||a.indexOf("_TSM_HiddenField_")>=0)&&!this.checkInclude(a,g)&&b.push(a)}return b},checkInclude:function(b,e){for(var d=e?e:document.getElementsByTagName("script"),c=0;c<d.length;c++){var a=d[c].getAttribute("src");if(b==a)return true;else if(a&&a.indexOf("_TSM_CombinedScripts_")>=0&&a.indexOf("_TSM_HiddenField_")>=0&&b.indexOf("_TSM_CombinedScripts_")>=0&&b.indexOf("_TSM_HiddenField_")>=0)return true}return false},get_scriptHolder:function(){var a=$get(this.ScriptHolderID);if(!a){a=document.createElement("div");a.id=this.ScriptHolderID;a.style.display="none";document.body.appendChild(a)}return a},saveLoadedExtenderScripts:function(d,f,e){var b=this.get_scriptHolder();b.innerHTML="";var c=this.getExtenderScripts(),a=b.loaded;if(!a)a={};this.mergeExtenderScripts(a,c);b.loaded=a;typeof FpExtender!="undefined"&&(f!="LoadOnDemand"||e)&&FpExtender.Util.disposeExtenders(d)},processCss:function(buff){var head=document.getElementsByTagName("head");if(!head){head=document.createElement("head");document.documentElement.insertBefore(head,document.body)}else head=head[0];var curCssLinks=[],links=head.getElementsByTagName("link");if(links)for(var i=0;i<links.length;i++){var link=links[i];link.getAttribute("type")=="text/css"&&curCssLinks.push(link.getAttribute("href"))}var cssLinks=$get(this.CssLinksID,buff);if(cssLinks){cssLinks=eval("("+cssLinks.value+")");cssLinks=cssLinks.cssLinks;for(var i=0;i<cssLinks.length;i++){var cssLink=cssLinks[i];if(!Array.contains(curCssLinks,cssLink)){var link=document.createElement("link");link.type="text/css";link.rel="stylesheet";link.href=cssLink;head.appendChild(link)}}}},loadExtenderScripts:function(spread,buff,onScriptLoaded){Sys.Browser.agent!=Sys.Browser.InternetExplorer&&this.processCss(buff);var scriptInfo=[],scriptBlock=$get(this.ScriptBlockID,buff),sbc;if(scriptBlock!=null){var sbc=scriptBlock.value;sbc=sbc.split("${GC}$");if(sbc.length>0){var tmp=sbc;sbc=sbc[0];scriptBlock.value=tmp.length>1?tmp[1]:""}}var realExtenderScripts=scriptBlock?$$.utils.getScriptURLs(sbc):[],newExtenderScripts=this.getExtenderScripts(buff),holder=this.get_scriptHolder(),needed=this.getNeededExtenderScripts(newExtenderScripts,realExtenderScripts,holder.loaded);buff&&this.mergeExtenderScripts(holder.loaded,newExtenderScripts);for(var i=0;i<needed.length;i++)scriptInfo.push({src:needed[i]});for(var startupScript=$get(this.StartupScriptID,buff),expandoScript=$get(this.ExpandosID,buff),ArrayDeclareScript=$get(this.ArrayDeclares,buff),arrayDeclareList=$get("__ARRAYDECLARES_LIST",buff),scriptLoader=Sys._ScriptLoader.getInstance(),i=0;i<scriptInfo.length;i++){var src=scriptInfo[i].src;src&&scriptLoader.queueScriptReference(src)}scriptLoader.loadScripts(0,function(){if(ArrayDeclareScript&&typeof FpExtender!=="undefined"){FpSpreadJS.processArrayDeclare(spread,ArrayDeclareScript,arrayDeclareList);ArrayDeclareScript.value=""}if(expandoScript&&typeof FpExtender!=="undefined")try{eval(expandoScript.value)}catch(e){}if(startupScript&&typeof FpExtender!=="undefined"){var inited=false,scv=startupScript.value.split("${GC}$");if(scv.length>0){var tmp=scv;scv=scv[0];startupScript.value=tmp.length>1?tmp[1]:""}for(var initScripts=FpExtender.Util.getExtenderInitScripts(spread,scv),i=0;i<initScripts.length;i++){try{eval(initScripts[i])}catch(e){}if(initScripts[i].indexOf("Sys.Application.initialize")!=-1)inited=true}if(!inited)for(var comps=Sys.Application.getComponents(),i=0;i<comps.length;i++){var comp=comps[i];comp.get_id().indexOf(spread.id)==0&&FpExtender.ContainerBehavior.isInstanceOfType(comp)&&comp._load()}}onScriptLoaded!=null&&onScriptLoaded()},function(){},null)}};FarPoint.System.ExtenderHelper=new FarPoint.System._ExtenderHelper;function FpSpread(a){var b=null;if(typeof a=="string")return document.getElementById(a);else if(typeof a.getAttribute!="undefined")b=a.getAttribute("FpSpread");if(b==null)b=a.FpSpread;return b=="Spread"?a:null}typeof Sys!="undefined"&&typeof Sys.Application!="undefined"&&Sys.Application.notifyScriptLoaded();(function(window,undefined){var document=window.document,browser=getBrowser();function getTopWindow(){var a=window;while(a.parent!=a)a=a.parent;return a}function getBrowser(){var a=navigator.userAgent,b=window.document,f=false,j=false,r=false,k=false;chrome=false;var c,p=false,m=-1,n=-1,l=false,o;if(a.indexOf(" MSIE ")>-1){f=true;c=b.documentMode||parseFloat(a.match(new RegExp("MSIE (\\d+\\.\\d+)"))[1])}else if(a.indexOf(" Firefox/")>-1){j=true;c=parseFloat(a.match(new RegExp(" Firefox\\/(\\d+\\.\\d+)"))[1])}else if(a.indexOf(" Chrome/")>-1){chrome=true;c=parseFloat(a.match(new RegExp(" Chrome\\/(\\d+\\.\\d+)"))[1])}else if(a.indexOf(" AppleWebKit/")>-1){k=true;c=parseFloat(a.match(new RegExp(" AppleWebKit\\/(\\d+(\\.\\d+)?)"))[1])}else if(a.indexOf("Opera/")>-1)r=true;else if(a.indexOf(" Trident/")>-1){f=true;c=b.documentMode;l=true}var h=false;if(b.documentMode&&b.documentMode==5)h=true;else if(b.compatMode&&b.compatMode=="BackCompat"&&(!b.documentMode||b.documentMode<9))h=true;else{var u=b.createElement("div",{style:"position:absolute;width:0;height:0;width:1"});if(u.style.width=="1px")h=true}var e;if(f)if(l){var t=a.indexOf("rv:");e=parseFloat(a.substr(t+3,4))}else if(b.documentMode){var q=a.match(/trident\s*\/\s*(\d+)/i),g=q!=null?q[1]:null;if(g!=null){g=parseInt(g);if(g>=5)e=g-5+9;else e=8}else e=8}else e=c;if(a.indexOf("(Windows;")>-1){p=true;var d=a.match(/\sWindows\sNT\s([\d.]+);/gi);if(d.length>0){d=d[0].trim().split(" ");if(d.length>2){d=d[2].split(".");m=parseInt(d[0]);n=parseInt(d[1])}}}var i;try{i=window.location.protocol}catch(v){i="https:"}var s=f&&c<=8&&i=="https:";o=window.navigator.platform;return{ie:f,mozilla:j,chrome:chrome,opera:r,webkit:k,version:c,ieversion:e,quirksMode:h,windowOS:p,OSMajorVersion:m,OSMinorVersion:n,protocol:i,securityWarning:s,platform:o,isTouchEventModel:"ontouchstart"in document,isTouchSupport:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||"ontouchstart"in document,mb:!f||c>10||e>10&&h,getAccessParentLevel:function(){if(typeof this.__limitedAccessParent=="undefined"){this.__limitedAccessParent=0;var a=window;do try{if(a.parent!=a){var b=a.parent.document;this.__limitedAccessParent+=1;a=a.parent}else break}catch(c){break}while(true)}return this.__limitedAccessParent},getName:function(){var a="";if(f)a="ie";else if(chrome)a="chrome";else if(j)a="mozilla";else if(k)a="webkit";else a="unknown";return a}}}var getDOMObject=function(a){if(a!=null)if(typeof a=="object")return a;else if(typeof a=="string")return a.length==0?null:document.getElementById(a);else try{return document.getElementById(a)}catch(b){return null}else return null},getStyle=function(a,c){var b;if(a.currentStyle)b=a.currentStyle[translatePropName(c)];else if(window.getComputedStyle)b=document.defaultView.getComputedStyle(a,null).getPropertyValue(c);else if(a.style)b=a.style[c];return b},translatePropName=function(d){if(d.indexOf("-")!=-1){for(var e=d.split("-"),c="",b=0;b<e.length;b++){var a=e[b];if(a.length==0)continue;if(b!=0)c+=a.charAt(0).toUpperCase()+(a.length>1?a.substring(1,a.length):"");else c+=a}return c}return d},getBorderHeight=function(a){var b=$$.constants.style;return(parseFloat(getStyle(a,b.borderTopWidth))||0)+(parseFloat(getStyle(a,b.borderBottomWidth))||0)},getBorderWidth=function(a){var b=$$.constants.style;return(parseFloat(getStyle(a,b.borderLeftWidth))||0)+(parseFloat(getStyle(a,b.borderRightWidth))||0)},getBorder=function(a){var b=$$.constants.style,c={top:parseFloat(getStyle(a,b.borderTopWidth))||0,bottom:parseFloat(getStyle(a,b.borderBottomWidth))||0,left:parseFloat(getStyle(a,b.borderLeftWidth))||0,right:parseFloat(getStyle(a,b.borderRightWidth))||0};return c},getPadding=function(b,g,f,d,e){var a=0,c=$$.constants.style;if(g)a+=parseFloat(getStyle(b,c.paddingTop))||0;if(d)a+=parseFloat(getStyle(b,c.paddingBottom))||0;if(f)a+=parseFloat(getStyle(b,c.paddingLeft))||0;if(e)a+=parseFloat(getStyle(b,c.paddingRight))||0;return a};function fpSpreadJS(a){this.element=getDOMObject(a);return this}fpSpreadJS.prototype.border=function(a,b){var e=a.length;if(e>1){if(a=="all")return getBorder(this.element);var d=$$.browser;if(arguments.length<1||!b)if(d.ie)a=a.substr(0,1).toUpperCase()+a.substr(1).toLowerCase();else a=a.toLowerCase();var c=$$.browser.ie?"border"+a+"Width":"border-"+a+"-width";return parseFloat(getStyle(this.element,c))||0}return 0};function isMatchAttributes(c,a){if(a!=null)for(var b in a)if(c.getAttribute(b)!=a[b])return false;return true}fpSpreadJS.prototype.getChildsByTagName=function(c){var a;if(this.element.querySelector){var f=this.element.id!=null&&this.element.id.length>0;if(!f){var d=3112009;while(document.getElementById("__gc__"+d.toString(10))!=null)d++;this.element.id="__gc__"+d.toString(10)}a=this.element.querySelectorAll("#"+this.element.id+" > "+c);if(!f)this.element.id=""}else{a=[];for(var e=this.element.childNodes,b=0;b<e.length;b++)(c==null||e[b].tagName==c)&&a.push(e[b])}return a};fpSpreadJS.prototype.getParent=function(i,h,f){var b=0;if(arguments.length>0)b=arguments[0];var a=this.element.parentNode;if(typeof b=="string"){b=b.toLowerCase();var c=0;if(arguments.length>1)c=arguments[1];var d=0;while(a!=null){if(!a.tagName)return null;if(a.tagName.toLowerCase()==b)if(isMatchAttributes(a,f))d++;if(d>c)break;a=a.parentNode}}else for(var g=b,e=g;e>0;e--){a=a.parentNode;if(a==null)break}return a};fpSpreadJS.prototype.offset=function(b){var e,d;b=b||this.element;var f=b.ownerDocument,a=f.body;if(b==a){e=a.offsetTop;d=a.offsetLeft}else{var h=b.getBoundingClientRect(),c=f.documentElement,j=c.clientTop||a.clientTop||0,i=c.clientLeft||a.clientLeft||0,g=$$.browser.quirksMode&&(!$$.browser.ie||$$.browser.ieversion<10)||$$.browser.ieversion==8&&$$.browser.ie;e=h.top+(g?c.scrollTop:self.pageYOffset||a.scrollTop)-j;d=h.left+(g?c.scrollLeft:self.pageXOffset||a.scrollLeft)-i}return{top:e,left:d}};fpSpreadJS.prototype.getPadding=function(d,c,a,b){return getPadding(this.element,d,c,a,b)};fpSpreadJS.prototype.getPaddingTop=function(){return getPadding(this.element,true,false,false,false)};fpSpreadJS.prototype.getPaddingBottom=function(){return getPadding(this.element,false,false,true,false)};fpSpreadJS.prototype.getPaddingLeft=function(){return getPadding(this.element,false,true,false,false)};fpSpreadJS.prototype.getPaddingRight=function(){return getPadding(this.element,false,false,false,true)};fpSpreadJS.prototype.outerHeight=function(){var b=this.element;if(arguments.length==0)return b.offsetHeight;else{var c=this.getAppliedHeight(arguments[0]);b.style.height=c>=0?c+"px":"";var e=0;if(arguments.length>=3)e=arguments[2];var a="";if(arguments.length>=4){a=arguments[3];if(a!=null&&a.length>0){a=a.toString().toLowerCase();a=","+a+","}}if(arguments.length>=2)for(var f=arguments[1],d=0;d<f;d++){b=b.parentNode;if(d<e)continue;if(b!=null&&a.indexOf(b.tagName.toLowerCase())==-1){if(c<0)c=0;b.style.height=c+"px"}else return}}};fpSpreadJS.prototype.outerWidth=function(){var a=this.element,b=$$.browser;if(arguments.length==0)return b.ie&&b.version==8?a.clientWidth+getBorderWidth(a):a.offsetWidth;else{var f=getPadding(a,false,true,false,true),g=getBorderWidth(a),e=f+g,c=arguments[0],d=a.tagName.toLowerCase();if(!b.quirksMode&&d!="tr"&&!(d=="textarea"&&b.ie&&b.version<8))c-=e;if(c<0)c=0;a.style.width=c+"px"}};fpSpreadJS.prototype.getBorderHeight=function(){return getBorderHeight(this.element)};fpSpreadJS.prototype.innerHeight=function(){var a=this.element;if(arguments.length==0)return $$.browser.ie&&$$.browser.version==8?a.clientHeight:a.clientHeight;else{var b=arguments[0];if(!$$.browser.quirksMode&&a.tagName.toLowerCase()!="tr"&&a.tagName.toLowerCase()!="td"){var c=this.outerHeight(),e=b!=c;if(e&&!$$.browser.mozilla)b+=c-this.innerHeight();else{var f=getPadding(a,true,false,true,false),g=getBorderHeight(a),d=f+g;b+=d}}this.outerHeight(b)}};fpSpreadJS.prototype.innerWidth=function(){var a=this.element;if(arguments.length==0)return $$.browser.ie&&$$.browser.version==8?a.clientWidth:a.clientWidth;else{var d=getPadding(a,false,true,false,true),e=getBorderWidth(a),c=d+e,b=arguments[0];if(!$$.browser.quirksMode&&a.tagName.toLowerCase()!="tr"&&a.tagName.toLowerCase()!="td")b+=c;a.style.width=b+"px"}};fpSpreadJS.prototype.clientLocation=function(){var a=this.element,d=$$.browser,b,c;if(d.mozilla&&d.version<3){b=a.offsetLeft+$$(a).border("left");c=a.offsetTop+$$(a).border("top")}else{b=this.element.clientLeft;c=this.element.clientTop}return{x:b,y:c}};fpSpreadJS.prototype.isClass=function(b,a){a=a||this.element;return Object.prototype.toString.call(a).slice(8,-1)==b};fpSpreadJS.prototype.indexOf=function(b){var a=this.element;if(this.isClass("Array"))return a.indexOf?a.indexOf(b):this.__ArrayIndexOf(a,b,Number(arguments[1])||0);throw typeof a+"Not support this method!";};fpSpreadJS.prototype.__ArrayIndexOf=function(b,d){var c=b.length,a=Number(arguments[2])||0;a=a<0?Math.ceil(a):Math.floor(a);if(a<0)a+=c;if(a<0)a=0;for(;a<c;a++)if(a in b&&b[a]===d)return a;return-1};fpSpreadJS.prototype.copyInnerHTML=function(c){if(c==null)return;var f=$$.browser.ie&&$$.browser.version==7;if(f)for(var d=c.getElementsByTagName("input"),b=0;b<d.length;b++){var a=d[b];a.value=a.value;if(a.value.length>0&&a.value.charAt(0)=="`"){a.setAttribute("__invalidValue",a.value);a.value=""}}$$.utils.removeBackgroundImages(c,true);this.element.innerHTML=c.innerHTML;$$.utils.restoreBackgroundImages(this.element);if(f)for(var d=this.element.getElementsByTagName("input"),b=0;b<d.length;b++){var a=d[b],e=a.getAttribute("__invalidValue");if(e!=null&&e.length>0){a.value=e;a.removeAttribute("__invalidValue")}}$$.utils.cloneChildrenProperties(c,this.element)};fpSpreadJS.prototype.copyHiddenColumnAttrs=function(d){if(d==null)return;for(var c=[],b=this.element.attributes.length-1;b>=0;b--){var a=this.element.attributes[b];this._isHiddenColumn(a)&&c.push(a.name)}for(var e=0;e<c.length;e++)this.element.removeAttribute(c[e]);for(var b=d.attributes.length-1;b>=0;b--){var a=d.attributes[b];if(this._isHiddenColumn(a))if($$.browser.ie&&$$.browser.version<9)this.element[a.name]=a.value;else this.element.setAttribute(a.name,a.value)}};fpSpreadJS.prototype._isHiddenColumn=function(a){return a.name.length>2&&a.name.charAt(0).toUpperCase()=="C"&&a.name.charAt(1)=="_"};fpSpreadJS.prototype.style=function(a){return getStyle(this.element,a)};fpSpreadJS.prototype.css=function(b,a){if(typeof a=="undefined")return getStyle(this.element,b);else this.element.style[b]=a};fpSpreadJS.prototype.getAlignment=function(b){var a;if(b){a=this.element.style.verticalAlign;if(a==null||a=="")a=getStyle(this.element,"vertical-align");if(this.element.tagName=="TD")if(a==null||a=="")a=this.element.getAttribute("valign")}else{a=this.element.style.textAlign;if(a==null||a=="")a=getStyle(this.element,"text-align");if(this.element.tagName=="TD")if(a==null||a=="")a=this.element.getAttribute("align")}return a};fpSpreadJS.prototype.getChild=function(b){var a=this.element.firstChild;while(a!=null){if(a.id==b||a.name==b)return a;var c=$$(a).getChild(b);if(c!=null)return c;a=a.nextSibling}return null};fpSpreadJS.prototype.getBorderWidth=function(){return getBorderWidth(this.element)};fpSpreadJS.prototype.getCssClass=function(){return $$.utils.getCssClass(this.element)};fpSpreadJS.prototype.hasCssClass=function(b){var a=$$.utils.getCssClass(this.element);return a!=null&&a.indexOf(b)!=-1};fpSpreadJS.prototype.removeOrResetAttribute=function(a,b){try{this.element.removeAttribute(a)}catch(c){this.element.setAttribute(a,b)}};fpSpreadJS.prototype.appendCssClass=function(a){$$.utils.appendCssClass(this.element,a)};fpSpreadJS.prototype.removeCssClass=function(a){$$.utils.removeCssClass(this.element,a)};fpSpreadJS.prototype.hasClass=function(a){return $$.utils.hasClass(this.element,a)};fpSpreadJS.prototype.getCaretPosition=function(){var a=this.element;if(a.selectionStart!=null)return a.selectionStart;else if(document.selection){var b=document.selection.createRange();return Math.abs(b.moveStart("character",-a.value.length))}return-1};fpSpreadJS.prototype.setCaretPosition=function(b){var a=this.element;if(a.createTextRange){var c=a.createTextRange();c.move("character",b);c.select()}else a.setSelectionRange&&a.setSelectionRange(b,b)};fpSpreadJS.prototype.getChildTag=function(a,c,b){return $$.utils.getChildTag(this.element,a,c,b)};fpSpreadJS.prototype.focus=function(f,b){var d,c,a=this.element;if(a==null||a.disabled||$$.browser.ie&&$$.browser.version<9&&(a.currentStyle==null||a.currentStyle.display=="none"||a.currentStyle.visibility=="hidden"))return;if(typeof b=="undefined"&&!$$.browser.webkit)b=true;if(b){d=document.documentElement.scrollTop||document.body.scrollTop;c=document.documentElement.scrollLeft||document.body.scrollLeft}this.element.focus();$$.browser.ie&&browser.version<9&&document.activeElement!=this.element&&this.element.value!=null&&this.element.value.length==0&&this.element.focus();if(this.element.tagName=="INPUT"&&this.element.type=="text"&&f)try{if("selectionStart"in a)a.selectionStart=a.value.length;else{var e=a.createTextRange();e.moveStart("character",a.value.length);e.select()}}catch(g){if(window.$DEBUG)throw g;}if(b)if((document.documentElement.scrollTop||document.body.scrollTop)!=d||(document.documentElement.scrollLeft||document.body.scrollLeft)!=c)window.scrollTo(c,d);else setTimeout(function(){window.scrollTo(c,d)},11)};fpSpreadJS.prototype.firstChild=function(a){return typeof a=="undefined"?this.element.firstChild:$$.utils.firstTaggedChild(this.element,a,true)};fpSpreadJS.prototype.getDocument=function(){return this.element.document||this.element.ownerDocument};fpSpreadJS.prototype.textContent=function(){var a=this.element.innerText?this.element.innerText:this.element.textContent;if(a)a=a.replace(/\u00A0/g," ");return a};fpSpreadJS.prototype.padding=function(d,c,a,b){return getPadding(this.element,d,c,a,b)};fpSpreadJS.prototype.height=function(){if(arguments.length>0){$$.j(this.element).css("height",arguments[0]);return}var a=parseInt(this.element.style.height);return isNaN(a)?0:a};fpSpreadJS.prototype.width=function(){var a=parseInt($$.j(this.element).css("width"));return isNaN(a)?0:a};fpSpreadJS.prototype.top=function(b){var a=parseFloat(this.style("top")||$$.j(this.element).css("top"));return isNaN(a)&&b?0:a};fpSpreadJS.prototype.left=function(b){var a=parseFloat(this.style("left")||$$.j(this.element).css("left"));return isNaN(a)&&b?0:a};fpSpreadJS.prototype.moveToPosition=function(h,i){var b=this.element.getBoundingClientRect(),f=h-b.left,g=i-b.top,a=this.element,d=this.top(false),e=false;if(isNaN(d)){a.style.top=a.offsetTop+g+"px";d=this.top(false);e=true}var c=this.left(false);if(isNaN(c)){a.style.left=a.offsetLeft+f+"px";c=this.left(false);e=true}if(e){b=a.getBoundingClientRect();f=h-b.left;g=i-b.top}d+=g;c+=f;a.style.top=d+"px";a.style.left=c+"px"};fpSpreadJS.prototype.moveToAnchorElement=function(a,g,h){if(a==null||a.offsetParent==null||this.element.offsetParent==null)return;var e=a.getBoundingClientRect(),b=e.left,c=e.top,d=this.element.offsetParent;if(d==a){var f=d.getBoundingClientRect();b=f.left;c=f.top}if(g!=null)b+=g;if(h!=null)c+=h;this.moveToPosition(b,c)};window.$$=function(a){return new fpSpreadJS(a)};(function(a){a.get=function(a){if(window.$$._instance==null)window.$$._instance=new fpSpreadJS(a);else window.$$._instance.element=getDOMObject(a);return window.$$._instance};a.browser=browser;var b=a.TouchEvents={TouchStart:"touchstart",TouchMove:"touchmove",TouchEnd:"touchend",TouchCancel:"touchcancel"};if(window.navigator.pointerEnabled){b.TouchStart="pointerdown";b.TouchMove="pointermove";b.TouchEnd="pointerup";b.TouchCancel="pointercancel"}else if(window.navigator.msPointerEnabled){b.TouchStart="MSPointerDown";b.TouchMove="MSPointerMove";b.TouchEnd="MSPointerUp";b.TouchCancel="MSPointerCancel"}a.string={};a.string.IsNullOrEmpty=function(a){return a==null||a.length==0};a.constants={};a.constants.style={borderTopWidth:a.browser.ie?"borderTopWidth":"border-top-width",borderBottomWidth:a.browser.ie?"borderBottomWidth":"border-bottom-width",borderLeftWidth:a.browser.ie?"borderLeftWidth":"border-left-width",borderRightWidth:a.browser.ie?"borderRightWidth":"border-right-width",paddingTop:a.browser.ie?"paddingTop":"padding-top",paddingBottom:a.browser.ie?"paddingBottom":"padding-bottom",paddingLeft:a.browser.ie?"paddingLeft":"padding-left",paddingRight:a.browser.ie?"paddingRight":"padding-right"};a.OperationModes={NORMAL:0,READ_ONLY:1,ROW_MODE:2,SINGLE_SELECT:3,MULTI_SELECT:4,EXTENDED_SELECT:5};a.CellTypes={EXTENDER:"ExtenderCellType",GENERAL:"GeneralCellType",MCCBCT:"MultiColumnComboBoxCellType",RADIO_BUTTON_LIST:"RadioButtonListCellType",CHECKBOX:"CheckBoxCellType",LISTBOX:"ListBoxCellType"};a.j=function(c){var b=function(b,c){if(a.utils.isArray(b)){this.length=b.length;if(b.length==1)b=b[0]}else this.length=1;this.element=b;this._events={};this.prevObj=c};b.prototype={addClass:function(e){if(this.length!=1){this._applyAll(this.addClass,arguments);return this}for(var b=this.element,d=e.split(" "),c=0;c<d.length;c++){var a=d[c];a=="none";if(b.classList)b.classList.add(a);else b.className+=" "+a}return this},removeClass:function(e){if(this.length!=1){this._applyAll(this.removeClass,arguments);return this}for(var a=this.element,c=e.split(" "),b=0;b<c.length;b++){var d=c[b];if(a.classList)a.classList.remove(d);else a.className=a.className.replace(new RegExp("(^|\\b)"+d.split(" ").join("|")+"(\\b|$)","gi")," ")}return this},data:function(a,b){if(this.length!=1){this._applyAll(this.data,arguments);return this}if(arguments.length<2)return this.element[a];else this.element[a]=b;return this},on:function(e,d){if(this.length!=1){this._applyAll(this.on,arguments);return this}for(var c=e.split(" "),b=0;b<c.length;b++){var f=c[b];a.j.Event.get(this.element,true).add(f,d)}return this},off:function(d,f){if(this.length!=1){this._applyAll(this.off,arguments);return this}var b=a.j.Event.get(this.element);if(b)for(var e=d?d.split(" "):b.names(),c=0;c<e.length;c++){var g=e[c];b.remove(g,f)}return this},find:function(g){for(var e=document.querySelectorAll(g),d=[],c=0;c<e.length;c++){var f=e[c];a.utils.contains(this.element,f,true)&&d.push(f)}return new b(d,this)},end:function(){return this.prevObj?this.prevObj:this},each:function(d){for(var b=this.length!=1?this.element:[this.element],a=0,f=b.length;a<f;a++){var c=b[a],e=c;value=d.call(e,a,c);if(value===false)break}},val:function(a){if(this.length!=1){this._applyAll(this.val,arguments);return this}if(typeof a!="undefined"){this.element.value=a;return this}else return this.element.value},text:function(c){if(this.length!=1){this._applyAll(this.attr,arguments);return this}var a=function(a){return typeof a.textContent!="undefined"?"textContent":typeof a.text!="undefined"?"text":"innerText"}(this.element),b=this.element;if(c!==undefined){b[a]=c;return this}else return b[a]},"get":function(a){return typeof a=="undefined"||this.length==1?this.element:this.element[a]},children:function(){var c=this.length==0?[]:a.j.sibling(this.get(0).firstChild);return new b(c,this)},first:function(){return this.length<2?this:new b(this.get(0),this)},attr:function(a,b){if(this.length!=1){this._applyAll(this.attr,arguments);return this}if(b!==undefined){this.element.setAttribute(a,b);return this}return this.element.getAttribute(a)},removeAttr:function(a){if(this.length!=1){this._applyAll(this.removeAttr,arguments);return this}this.element.removeAttribute(a);return this},_applyAll:function(c,b){this.each(function(){c.apply(a.j(this),b)})}};if(!a.j.Event){a.j.Event=function(a){this.element=a;this._events={}};a.j.Event.prototype={add:function(b,d){var c=this._events[b];if(c==null)c=this._events[b]=[];c.push(d);a.utils.attachEvent(this.element,b,d,false)},remove:function(c,d){var b=this._events[c];if(b){if(d){var e=b.indexOf(d);if(e!=-1){var f=b.splice(e,1);a.utils.detachEvent(this.element,c,f,false)}}else while(b.length){var f=b[0];a.utils.detachEvent(this.element,c,f,false);b.splice(0,1)}if(!b.length)try{delete this._events[c]}catch(g){this._events[c]=null}!this.names().length&&a.j.Event.remove(this.element)}},names:function(){var a=[];for(var b in this._events)a.push(b);return a}};a.j.Event._events=[];a.j.Event.get=function(e,g){for(var b=null,c=a.j.Event._events,d=0;d<c.length;d++){var f=c[d];if(f.element==e){b=f;break}}if(!b&&g){b=new a.j.Event(e);c.push(b)}return b};a.j.Event.remove=function(d){for(var c=a.j.Event._events,b=0;b<c.length;b++){var e=c[b];if(e.element==d){c.splice(b,1);return}}}}if(!a.j.sibling)a.j.sibling=function(a,c){for(var b=[];a;a=a.nextSibling)a.nodeType===1&&a!==c&&b.push(a);return b};return new b(c)}})(window.$$);function XMLDOMWrapper(a){this.element=getDOMObject(a);return this}XMLDOMWrapper.prototype.convertXPathToSelector=function(a){return a};if(!window.XMLDOMWrapper_ClearBlankRegEx)window.XMLDOMWrapper_ClearBlankRegEx=/\s+/g;XMLDOMWrapper.prototype.convertSelectorToXPath=function(a){a=a.replace(window.XMLDOMWrapper_ClearBlankRegEx," ");a=(this.nodeContext==null||this.nodeContext==this.element.xmlDoc?"//":"./")+a;a=a.replace(/ /g,"/");var b=a.indexOf("[");while(b>=0){b++;a=a.substr(0,b)+"@"+a.substr(b);b=a.indexOf("[",b)}return a};XMLDOMWrapper.prototype._getPreferredQueryObject=function(a,d){var b=this.getXMLDoc(),c=(this.element==null||!this.isNativeNode||b!=this.element.xmlDoc&&!$$.utils.contains(this.element.xmlDoc,b))&&this.isXML(b);if(d){if((this.isBuiltInXml||c)&&typeof b.selectSingleNode!="undefined")return{queryMethod:0,selector:a};if(b.querySelector){a=this.convertXPathToSelector(a);return{queryMethod:1,selector:a}}}else{if(b.querySelector&&!c)return{queryMethod:1,selector:a};if((this.isBuiltInXml||c)&&typeof b.selectSingleNode!="undefined"){a=this.convertSelectorToXPath(a);return{queryMethod:0,selector:a}}}if(d)a=this.convertXPathToSelector(a);return{queryMethod:-1,selector:a}};XMLDOMWrapper.prototype.selectSingleNode=function(d,e){var c=this.getXMLDoc();if(c==null)return null;var a=this._getPreferredQueryObject(d,e);switch(a.queryMethod){case-1:return $$.querySelector(c,a.selector);break;case 0:return c.selectSingleNode(a.selector);break;case 1:var b=c.querySelector(a.selector);if(typeof b=="Array")b=b[0];return b}return null};XMLDOMWrapper.prototype.selectNodes=function(d,e){var c=this.getXMLDoc(),b=this._getPreferredQueryObject(d,e);switch(b.queryMethod){case-1:return $$.querySelector(c,b.selector);break;case 0:return c.selectNodes(b.selector);break;case 1:var a=c.querySelector(b.selector);if(a!=null&&typeof a!="Array")a=[a];return a}return null};XMLDOMWrapper.prototype.textContent=function(a,b){if(arguments.length<2)return typeof a.textContent!="undefined"?a.textContent:typeof a.text!="undefined"?a.text:a.innerText;else if(typeof a.textContent!="undefined")a.textContent=b;else if(typeof a.text!="undefined")a.text=b;else a.innerText=b};XMLDOMWrapper.prototype.lastChild=function(a){if(typeof a.lastChild!="undefined")return a.lastChild;else if(typeof a.lastElementChild!="undefined")return a.lastElementChild;else{var c=a.childNodes,b=c.length;return b>0?c[b-1]:null}};XMLDOMWrapper.prototype.firstChild=function(a){if(typeof a.firstChild!="undefined")return a.firstChild;else if(typeof a.firstElementChild!="undefined")return a.firstElementChild;else{var b=a.childNodes;return b.length==0?null:b[0]}};XMLDOMWrapper.prototype.firstElementChild=function(a,d){if(typeof a.firstElementChild!="undefined")return a.firstElementChild;else if(typeof a.firstChild!="undefined"){var a=a.firstChild;while(a!=null&&!(a.nodeType==1||d&&a.nodeType==9))a=a.nextSibling;return a}else{for(var c=a.childNodes,b=0,e=c.length;b<e;b++){var a=c[b];if(a.nodeType==1)return a}return null}};XMLDOMWrapper.prototype.nextSibling=function(a){if(typeof a.nextSibling!="undefined")return a.nextSibling;else if(typeof a.nextElementSibling!="undefined")return a.nextElementSibling;else{var c=a.parentNode;if(c!=null){var b=c.childNodes,d=b.indexOf(a);if(d<b.length-1)return b[d+1]}}return null};XMLDOMWrapper.prototype.nextElementSibling=function(a,e){if(typeof a.nextElementSibling!="undefined")return a.nextElementSibling;else if(typeof a.nextSibling!="undefined"){var a=a.nextSibling;while(a!=null&&!(a.nodeType==1||e&&a.nodeType==9))a=a.nextSibling;return a}else{var d=a.parentNode;if(d!=null)for(var b=d.childNodes,g=b.indexOf(a),c=g+1,f=b.length;c<f;c++){var a=b[c];if(a.nodeType==1)return a}}return null};XMLDOMWrapper.prototype.createElement=function(b){var a=this.getXMLDoc();return a.createElement(b)};XMLDOMWrapper.prototype.belongToElement=function(a){return a!=null&&this.element==a};XMLDOMWrapper.prototype.switchNodeContext=function(a){this.nodeContext=a};XMLDOMWrapper.prototype.resetNodeContext=function(){this.nodeContext=null};XMLDOMWrapper.prototype.isXML=function(a){var b=(a?a.documentElement?a:a.ownerDocument:0).documentElement;return b?b.nodeName!=="HTML":false};XMLDOMWrapper.prototype.getXMLDoc=function(){return this.nodeContext!=null?this.nodeContext:this.element.xmlDoc};XMLDOMWrapper.prototype.loadXML=function(b){this.isNativeNode=false;this.isBuiltInXml=false;if(window.DOMParser){var c=new DOMParser,d=c.parseFromString(b,"text/xml");this.element.xmlDoc=d;this.isNativeNode=true}else if(typeof ActiveXObject!="undefined"){var a=null;try{a=new ActiveXObject("Msxml2.DOMDocument.6.0")}catch(e){}if(a==null){try{a=new ActiveXObject("Msxml2.DOMDocument.5.0")}catch(e){}if(a==null){try{a=new ActiveXObject("Msxml2.DOMDocument.4.0")}catch(e){}if(a==null){try{a=new ActiveXObject("Msxml2.DOMDocument.3.0")}catch(e){}if(a==null)try{a=new ActiveXObject("Microsoft.XMLDOM")}catch(e){}}}}if(a!=null){a.setProperty("SelectionLanguage","XPath");a.async="false";a.loadXML(b)}this.element.xmlDoc=a;this.isBuiltInXml=true}else if(document.implementation){var a=document.implementation.createDocument("","",null);a.loadXML(b);this.element.xmlDoc=a;this.isBuiltInXml=true}};XMLDOMWrapper.prototype.serializeXML=function(){var a=this.getXMLDoc();if(window.XMLSerializer){var b=(new XMLSerializer).serializeToString(a);if(b.indexOf("<root>")=="0")return b;if(!$$.browser.ie)a=a.childNodes[0]}else if(typeof a.xml!="undefined")return a.xml;return XMLDOMWrapper.exportToString(a)};XMLDOMWrapper.prototype.dispose=function(){this.element.xmlDoc=null;this.element=null};XMLDOMWrapper.importFromString=function(i,h,e){for(var f=0;f<h.childNodes.length;f++){var a=h.childNodes[f],b=null;if(a.nodeType==1||a.nodeType==3){if(a.nodeType==1){b=document.createElement(a.tagName);for(var c=0;c<a.attributes.length;c++){var d=a.attributes[c];b.getAttribute(d.nodeName)!=d.nodeValue&&b.setAttribute(d.nodeName,d.nodeValue)}XMLDOMWrapper.importFromString(b,a,e)}else b=document.createTextNode(a.nodeValue);i.appendChild(b);if(e==null||e==true)if(a.nodeType==1&&a.attributes.length>0){for(var g=[],c=0;c<a.attributes.length;c++)g.push(a.attributes[c].nodeName);b._fpAttrNames=g}}}};XMLDOMWrapper.exportToString=function(a){if(a.nodeType==3)return a.nodeValue;var c="<"+a.nodeName;if(a._fpAttrNames==null||a._fpAttrNames.length==0)for(var b=0;b<a.attributes.length;b++){var d=a.attributes[b];if(!d.specified)continue;c+=" "+d.nodeName+'="'+d.nodeValue+'"'}else for(var b=0;b<a._fpAttrNames.length;b++){var e=a._fpAttrNames[b],f=a.getAttribute(e);if(f==null)continue;c+=" "+e+'="'+f+'"'}c+=">";for(var b=0;b<a.childNodes.length;b++)c+=XMLDOMWrapper.exportToString(a.childNodes[b]);c+="</"+a.nodeName+">";return c};window.$$.fn={createXMLDOMWrapper:function(c){var b=getDOMObject(c);if(b.__xmlDOMWrapper!=null)return b.__xmlDOMWrapper;var a=new XMLDOMWrapper(c);a.element.__xmlDOMWrapper=a;return a}};window.$$.support=new function(){var a=$$.browser,b=a.ie&&a.version>=9};window.$$.querySelector=function(n,j,u){if(j==null||j=="")return null;n=n||document;var v=$$.browser;j+=" ";for(var w=j.length,k={next:null,attributes:[]},a=k,h=null,d=null,c=[],t=false,f=false,m=false,p=0;p<w;p++){d=j.charAt(p);t=d==" "||d=="\n"||d=="\r";if(d=="["||d=="]"||d=="="||t){if(f&&d=="["||!f&&(d=="="||d=="]"))throw"invalid selector";if(c.length>0){if(!f){a.next={tag:c.join(""),next:null,attributes:[]};a=a.next}else{if(h==null)throw"invalid selector";if(!m){h.name=c.join("");m=d=="="}else{if(c[0]=="'"&&c[c.length-1]=="'"||c[0]=='"'&&c[c.length-1]=='"'){c.pop();c.shift()}h.value=c.join("");m=false}}c=[]}if(!f&&d=="[")f=true;else if(f&&d=="]")f=false;if(f&&h==null){h={name:null,value:null};a.attributes.push(h)}else if(!f&&h!=null)h=null;continue}c.push(d)}if(k.next==null&&k.attributes.length==0)throw"invalid selector";a=k;var e=[n],b=null;do{b=e;e=[];if(a.tag!=null)while(b.length>0)for(var o=b.shift(),l=o.getElementsByTagName(a.tag),g=0;g<l.length;g++)e.push(l[g]);else if(a==k&&a.attributes.length>0)for(var g=0,y=b.length;g<y;g++)for(var o=b[g],l=v.ie?o.all:o.getElementsByTagName("*"),i=0,x=l.length;i<x;i++)e.push(l[i]);else e=b;if(e.length>0&&a.attributes.length>0){b=[];for(var g=0;g<e.length;g++){for(var s=e[g],q=true,i=0;i<a.attributes.length;i++){var r=a.attributes[i];if(s.getAttribute(r.name)!=r.value){q=false;break}}q&&b.push(s)}e=b}else b=e;a=a.next}while(a!=null);return b==null||b.length==0?null:u||b.length>1?b:b[0]};window.$$.spread={ready:function(a,c,b){if(a==null)return;if(a.initialized&&!a.updating)if(b)c.call(b,a);else c(a);else{if(!a._initFnList)a._initFnList=[];a._initFnList.push({ctx:b,fn:c});if(a.onSpreadInitialized)return;a.onSpreadInitialized=function(){try{delete a.onSpreadInitialized}catch(f){a.onSpreadInitialized=null}var b=this._initFnList;if(!b)return;while(b.length){var c=b[0];b.splice(0,1);var d=c.ctx,e=c.fn;if(d)e.call(d,this);else e(this)}}}},removeHandlerByContextWhenReady:function(d,c){if(!d&&!c)return;c.onInitCompletedHandler=null;var a=d._initFnList;if(!a)return;for(var b=0;b<a.length;b++)a[b].ctx==c&&a.splice(b,1)},getSpreadControl:function(c,d){var a=c;while(a!=null&&a.tagName!=null&&a.tagName!="BODY"){if(a.getAttribute("FpSpread")=="Spread"){if(!d){var b=c;while(b!=null&&b!=a){if(b.id==a.id+"_commandBar"||b.id==a.id+"_pager1"||b.id==a.id+"_pager2")return null;b=b.parentElement}}return a}a=a.parentElement}return null}};window.$$.utils={getParentElement:function(a){return a==null?null:a.parentElement||a.parentNode},AttachToSpread:function(e,a){for(var d=a.nodeType==1&&a.nodeName!=null?arguments.slice(1,arguments.length):a,c=0;c<d.length;c++){var b=d[c];b!=null&&b.nodeName!=null&&b.setAttribute("HostSpreadID",e.id)}},GetCell:function(d,c){var a=d;while(a!=null){if(c){if((a.tagName=="TD"||a.tagName=="TH")&&a.parentNode!=null&&a.parentNode.getAttribute&&a.parentNode.getAttribute("FpSpread")=="r")return a}else if((a.tagName=="TD"||a.tagName=="TH")&&a.parentNode!=null){var b=a.parentNode.getAttribute&&a.parentNode.getAttribute("FpSpread");if(b=="r"||b=="ch"&&a.getAttribute("controltype")!="chgrayarea"||b=="rh")return a}a=a.parentNode}return null},isNativeControl:function(a,d){if(a!=null){if(a.tagName=="INPUT"||a.tagName=="TEXTAREA"||a.tagName=="SELECT"||a.tagName=="OPTION"||a.tagName=="BUTTON")return true;if(d)if(a.tagName=="LABEL"){var c=a.getAttribute("for");if(c!=null){var b=document.getElementById(c);if(b)return this.isNativeControl(b)}}}return false},isDisabledControl:function(a,d){if(a!=null){if(d)if(a.tagName=="LABEL"){var c=a.getAttribute("for");if(c!=null){var b=document.getElementById(c);if(b)a=b}}return a.disabled}return false},isTextControl:function(a,b){return a!=null&&(a.tagName=="INPUT"&&a.type=="text"||a.tagName=="TEXTAREA"||b&&a.tagName=="INPUT"&&a.type=="password")},isCheckboxControl:function(a){return a!=null&&a.tagName=="INPUT"&&a.type=="checkbox"},isSelectControl:function(a,b){return b==true||$$.browser.mb?a!=null&&a.tagName!=undefined&&(a.tagName.toUpperCase()=="SELECT"||a.tagName.toUpperCase()=="OPTION"):a!=null&&a.tagName!=undefined&&a.tagName.toUpperCase()=="SELECT"},isButtonControl:function(a){return a!=null&&(a.tagName=="BUTTON"||a.tagName=="INPUT"&&(a.type=="button"||a.type=="submit"))},isNeedPreventScrolling:function(i,a){if(!$$.browser.chrome||a==null)return false;var c=GrapeCity.Web.Spread.Keys,g=c.LEFT,f=c.RIGHT,m=c.PAGE_UP,k=c.PAGE_DOWN,b=i.keyCode;if(this.isTextControl(a)){var h=a.tagName.toLowerCase()!="textarea",e=a.selectionStart==a.selectionEnd;return h&&(b==m||b==k)||a.selectionStart==0&&e&&b==g||a.selectionStart==a.value.length&&e&&b==f}if(a.tagName=="INPUT"&&a.type=="radio"&&a.name!=""){var d=document.getElementsByName(a.name),j=d[0],l=d[d.length-1];return a==j&&b==g||a==l&&b==f}return false},binarySearch2:function(e,f){var b=0,c=this.length-1,a;if(f==null)while(b<=c){a=b+c>>1;if(this[a]===e)return a;else if(this[a]>e)c=a-1;else b=a+1}else{var d;while(b<=c){a=b+c>>1;d=f(this[a],e);if(d===0)return a;else if(d>0)c=a-1;else b=a+1}}},binarySearch:function(e,a,l){var d=l||{};if(d.start==null)d.start=0;if(d.end==null)d.end=Math.min(a,e.length-1);var h=d.end;if(a<0||h<0)return-1;var i=d.nearestPossible,g=d.getValueHandler||$$.utils._defaultGetValueHandler,j=d.start,k=d.end,c=g(e,0);if(a==c)return 0;else if(a<c)return i?0:-1;c=g(e,h);if(a==c)return h;else if(a>c)return i?h:-1;var b=j+k>>1,f=g(e,b);while(f!=a&&j<k){if(a<f){if(i){c=g(e,b-1);if(a>c)return a-c>f-a?b:b-1}k=b-1}else{if(i){c=g(e,b+1);if(a<c)return a-f<c-a?b:b+1}j=b+1}b=j+k>>1;f=g(e,b)}return f==a?b:-1},_defaultGetValueHandler:function(a,b){return a[b]},replaceAll:function(a,b,d){if(a!=null)while(true){var c=a.indexOf(b);if(c==-1)break;a=a.replace(b,d)}return a},countChar:function(a,c){if(a==null||a.length==0||c==null)return-1;for(var d=0,b=0;b<a.length;b++)if(a.charAt(b)==c)d++;return d},trim:function(b){var a=b.match(new RegExp("^\\s*(\\S+(\\s+\\S+)*)\\s*$"));return a==null?"":a[1]},htmlEncode:function(c,f){if(c==null||c=="")return c;var a=new String(c);a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/\"/g,"&quot;");if(f)return a;a=a.replace(/\r\n/g,"\n");for(var b=a.split("\n"),d=0;d<b.length;d++){var a=b[d],e=a.length;if(a.charAt(0)==" ")a="&nbsp;"+a.substr(1);if(e>=2&&a.charAt(a.length-1)==" ")a=a.substr(0,a.length-1)+"&nbsp;";b[d]=e>=4?a.replace(/\u0020\u0020/g," &nbsp;"):a}return b.join("<br>")},htmlDecode:function(b){if(b==null||b=="")return b;var a=b;a=a.replace(/<br\/?>/gi,"\n");a=a.replace(/&nbsp;/g," ");a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");a=a.replace(/&quot;/g,'"');a=a.replace(/&amp;/g,"&");a=a.replace(/&#39;/g,"'");return a},getPlainHtmlText:function(a){if(a==null||a=="")return a;for(var b=a.split(/<\s*br\s*\/?\s*>/gi),c=0;c<b.length;c++)b[c]=b[c].replace(/<\s*[^>]*>/g,"");return b.join("<br>")},firstTaggedChild:function(a,b,f){if(a!=null&&a.childNodes.length>0)if(!f)for(var d=0;d<a.childNodes.length;d++){var c=a.childNodes[d];if(typeof c.tagName!="undefined"&&(!b||c.tagName==b))return c}else{var e=a.getElementsByTagName(b);if(e.length>0)return e[0]}return null},isOverScrollbar:function(b,h,i){if(b==null)return false;if(h==document.documentElement)return b.clientX>document.documentElement.clientWidth&&b.clientX<document.documentElement.offsetWidth||b.clientY>document.documentElement.clientHeight&&b.clientY<document.documentElement.offsetHeight;var a=h||b.srcElement||b.target;if(a!=null&&a.tagName&&a.tagName=="DIV"){if(a.clientWidth==0&&a.offsetWidth==0||a.clientHeight==0&&a.offsetHeight==0)return false;var d=b.clientX,e=b.clientY,c=a.getBoundingClientRect();if(d>=c.left&&d<c.right&&e>=c.top&&e<c.bottom){var g=d>c.left+a.clientWidth&&d<c.right-$$(a).border("right"),f=e>c.top+a.clientHeight&&e<c.bottom-$$(a).border("bottom");return!i?g||f:g&&f}}return false},appendCssClass:function(a,b){var d=$$.browser;if(d.ie&&d.version<8){if(a.className!=null&&a.className.indexOf(b)>=0)return;var e=a.className==null?a.className:a.className+" "+b;a.className=e}else{var c=a.getAttribute("class");if(c!=null&&c.indexOf(b)>=0)return;a.setAttribute("class",c==null?b:c+" "+b)}},removeCssClass:function(c,b){if(c==null)return;var d=$$.browser,a;if(d.ie&&d.version<8){a=c.className;if(a!=null){if(a.length>b.length)b=" "+b;a=a.replace(b,"");c.className=a}}else{a=c.getAttribute("class");if(a!=null){if(a.length>b.length)b=" "+b;a=a.replace(b,"");c.setAttribute("class",a)}}},hasClass:function(c,a){if(c==null||!c.className||a==null||a.length==0)return false;if(typeof a=="string"){var b=c.className;return b==a||b.indexOf(a+" ")==0||this.stringEndsWith(b," "+a)||b.indexOf(" "+a+" ")!=-1}else{for(var d=0;d<a.length;d++)if(!this.hasClass(c,a[d]))return false;return true}},getChildTag:function(h,j,f,b){if(h==null)return null;var d=h.getElementsByTagName(j);if(typeof f=="undefined")return d.length>0?d[0]:null;for(var e=typeof b!="undefined",i=f=="class",g=0;g<d.length;g++){var c=d[g];if(i){var a=this.getCssClass(c);if(a!=null&&!e||e&&a==b)return c;if(a!=null&&a.length>b.length&&(a.indexOf(b+" ")==0||a.indexOf(" "+b)==a.length-b.length-1||a.indexOf(" "+b+" ")>=0))return c}else{var a=c.getAttribute(f);if(a!=null&&!e||e&&a==b)return c}}return null},getCssClass:function(a){return!$$.browser.ie||$$.browser.version>7?a.getAttribute?a.getAttribute("class"):"":a.className},isRightClick:function(a){return a==null?false:a.button?a.button==2:a.which?a.which==3:false},getDocActiveElement:function(){try{return window.parent==window||document.readyState=="complete"?document.activeElement:null}catch(a){return null}},verticalAlign:function(c,b){var a="";if(c.tagName=="TD")a=c.getAttribute("valign");if(a==null||a.length==0)a=$$(c).style("vertical-align");switch(a){case"bottom":b.style.top="100%";b.style.marginTop=-b.offsetHeight+"px";break;case"middle":b.style.top="50%"}},getBrowserClientSize:function(){var d=window,a=document,b=a.documentElement,c=a.getElementsByTagName("body")[0];x=d.innerWidth||b.clientWidth||c.clientWidth,y=d.innerHeight||b.clientHeight||c.clientHeight;return{Width:x,Height:y}},getTopLevelElements:function(a){var d=[],c=0;while(a.length>c){for(var g=a[c],f=true,b=0;b<a.length;b++){if(b==c)continue;var h=a[b],e=this.comparePosition(g,h);if((e&8)==8){a.splice(c,1);f=false;break}else if((e&16)==16){a.splice(b,1);b--;continue}}if(f){d.push(g);c++}}return d},getElementsByTagName:function(e,a){a=a||document;for(var c=a.getElementsByTagName(e),d=[],b=0,f=c.length;b<f;b++)d.push(c[b]);return d},comparePosition:function(a,b){return a.compareDocumentPosition?a.compareDocumentPosition(b):a.contains?(a!=b&&a.contains(b)&&16)+(a!=b&&b.contains(a)&&8)+(a.sourceIndex>=0&&b.sourceIndex>=0?(a.sourceIndex<b.sourceIndex&&4)+(a.sourceIndex>b.sourceIndex&&2):1)+0:0},getTableColWidth:function(c){if(c==null)return 0;var a=c.getElementsByTagName("COLGROUP");if(a!=null&&a.length>0)a=a[0];for(var e=0,b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(d.tagName){w=parseInt(d.getAttribute("width"));if(!isNaN(w))e+=w}}return e},getRowOffsetTop:function(a,b){if(a==null)return 0;if(b==null)b=a.parentNode.tagName=="TBODY"?a.parentNode.parentNode:a.parentNode;return a.getBoundingClientRect().top-b.getBoundingClientRect().top},measureTextContent:function(e,f){var a=document.getElementById(e.id+"_measure");if(a==null){var c=document.createElement("DIV");c.style.width=c.style.height="0px";c.style.overflow="hidden";var d=document.createElement("DIV");d.style.width=d.style.height="2000px";d.style.overflow="visible";a=document.createElement("SPAN");var b=$$.j(e);a.id=e.id+"_measure";a.style.fontFamily=b.css("fontFamily");a.style.fontSize=b.css("fontSize");a.style.fontWeight=b.css("fontWeight");a.style.fontStyle=b.css("fontStyle");a.style.textDecoration=b.css("textDecoration");a.style.lineHeight=b.css("lineHeight");a.style.letterSpacing=b.css("letterSpacing");a.style.fontStretch=b.css("fontStretch");a.style.color="red";a.style.backgroundColor="gray";a.style.border="none";a.style.padding="0px";a.style.margin="0px";if(f==null)f=document.body;f.appendChild(c);c.appendChild(d);d.appendChild(a)}var g=$$.utils.replaceAll(e.value,"\r\n","\n");g=$$.utils.replaceAll(g,"\n","<br/>");a.innerHTML=g;var i=a.offsetWidth,h=a.offsetHeight;return{width:a.offsetWidth,height:a.offsetHeight}},measureCharacterSize:function(d){var c=12354,a=document.createElement("SPAN"),b=$$.j(d);a.style.fontFamily=b.css("fontFamily");a.style.fontSize=b.css("fontSize");a.style.fontWeight=b.css("fontWeight");a.style.fontStyle=b.css("fontStyle");a.style.textDecoration=b.css("textDecoration");a.style.lineHeight=b.css("lineHeight");a.style.letterSpacing=b.css("letterSpacing");a.style.fontStretch=b.css("fontStretch");a.style.color="transparent";a.style.backgroundColor="transparent";a.style.border="none";a.style.padding="0px";a.style.margin="0px";a.innerHTML=String.fromCharCode(c);document.body.appendChild(a);var f=a.offsetWidth,e=a.offsetHeight;document.body.removeChild(a);return{width:f,height:e}},contains:function(a,b,d){if(!this.isArray(a))return a==null||b==null?false:d&&a==b||(a.contains?a!=b&&a.contains(b):a.compareDocumentPosition&&!!(a.compareDocumentPosition(b)&16));else{for(var c=0;c<a.length;c++)if(this.contains(a[c],b,d))return true;return false}},cleanArray:function(){if(arguments.length>0)for(var c=0;c<arguments.length;c++){var a=arguments[c];if(a!=null&&typeof a=="object")for(var b=a.length-1;b>=0;b--)a[b]==null&&a.splice(b,1)}},stringEquals:function(a,b){if(a==b)return true;if(a==null||b==null||a.length!=b.length)return false;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c),e=b.charCodeAt(c);if(d!=e){if((d==32||d==160)&&(e==32||e==160))continue;return false}}return true},stringEndsWith:function(b,a){if(b==null||a==null)return false;var c=b.indexOf(a);return c>=0&&c+a.length==b.length},createEvent:function(g,e,f,c){var d=$$.browser,a=null,b=arguments.length;if(d.ie&&d.version<9)a=document.createEventObject();else{a=document.createEvent("Events");a.initEvent(g,b<2?true:e,b<3?true:f)}if(b>3)for(i in c)a[i]=c[i];return a},fireEvent:function(a,b){if(a.dispatchEvent)a.dispatchEvent(b);else a.fireEvent("on"+b.name,b)},attachEvent:function(target,eventName,handler,useCapture){if(arguments.length<3){var code=target.getAttribute("on"+eventName);if(code!=null&&code.length>0){var handler=function(event){eval(code)};target["on"+eventName]=handler}}FarPoint.System.AttachEvent(target,eventName,handler,useCapture)},detachEvent:function(a,b,c,d){if(arguments.length<3)if(typeof a["on"+b]=="function")c=a["on"+b];FarPoint.System.DetachEvent(a,b,c,d)},cancelBubble:function(a,b,c){if(!a)a=window.event;if(!a)return;if(typeof b=="undefined")b=true;if(b){a.preventDefault&&a.preventDefault();a.returnValue=false}if(!c)a.stopPropagation&&a.stopPropagation();else a.stopImmediatePropagation&&a.stopImmediatePropagation();a.cancelBubble=true;a.cancel=true;return false},cancelDefault:function(a){if(a.preventDefault)a.preventDefault();else a.returnValue=false;return false},addWheelListener:function(c,b,e){var a="onwheel"in c?"wheel":document.onmousewheel!==undefined?"mousewheel":"DOMMouseScroll",d=a=="wheel"?b:function(c){!c&&(c=window.event);var d={originalEvent:c,target:c.target||c.srcElement,type:"wheel",deltaMode:c.type=="MozMousePixelScroll"?0:1,deltaX:0,delatZ:0,preventDefault:function(){c.preventDefault?c.preventDefault():c.returnValue=false},stopPropagation:function(){c.stopPropagation?c.stopPropagation():c.cancelBubble=true}};if(a=="mousewheel"){d.deltaY=-1/40*c.wheelDelta;c.wheelDeltaX&&(d.deltaX=-1/40*c.wheelDeltaX)}else d.deltaY=c.detail;return b(d)};this.attachEvent(c,a,d,e||false);return{eventName:a,eventHandler:d}},cloneNode:function(a){for(var b=document.createElement(a.tagName),d=0;d<a.attributes.length;d++){var c=a.attributes[d];c.specified&&b.setAttribute(c.nodeName,c.nodeValue)}XMLDOMWrapper.importFromString(b,a,false);this.cloneChildrenProperties(a,b);return b},cloneChildrenProperties:function(d,c){for(var f=d.getElementsByTagName("select"),i=c.getElementsByTagName("select"),a=0;a<f.length;a++)i[a].selectedIndex=f[a].selectedIndex;for(var b=d.getElementsByTagName("INPUT"),g=c.getElementsByTagName("INPUT"),a=0;a<b.length;a++)if(b[a].type=="checkbox"){if($$.browser.ie&&$$.browser.version>=9)g[a].value=b[a].value;g[a].checked=b[a].checked}for(var e=d.getElementsByTagName("TEXTAREA"),h=c.getElementsByTagName("TEXTAREA"),a=0;a<e.length;a++)h[a].value=e[a].value},getColumnCount:function(b){var a=b.getElementsByTagName("COLGROUP");return a!=null&&a.length>0?a[0].children.length:0},getMinColumnsWidth:function(q,t){var p=q.length;if(p==0)return null;for(var e=[],f=Number.MAX_VALUE,g=0;g<p;g++)f=Math.min(f,this.getColumnCount(q[g]));for(var m=0;m<f;m++)e.push(0);for(var r=[],g=0;g<p;g++){var h=q[g],k=h.getElementsByTagName("COLGROUP");if(k!=null&&k.length>0)k=k[0];for(var i=h.rows,v=i.length,b=0;b<f;b++){for(var d=0;d<v;d++){var c=i[d],n=c.__nextColumn;if(n==null||n==b){var j=c.__cellIndex;if(j==null)j=0;if(j>=c.cells.length){c.__nextColumn=f;continue}var a=c.cells[j];if(a.colSpan<=1){if(e[b]<a.offsetWidth)e[b]=a.offsetWidth}else{if(k!=null)for(var l=b,C=Math.min(b+a.colSpan,f);l<C;l++){var w=t(h,l);if(e[l]<w)e[l]=w}r.push({col:b,cell:a,table:h})}c.__cellIndex=j+1;if(c.__cellIndex>=c.cells.length)c.__nextColumn=f;else c.__nextColumn=(n==null?0:n)+a.colSpan;if(a.rowSpan>1)for(var u=0,B=a.rowSpan-1;u<B;u++){d++;if(d>=i.length)break;i[d].__nextColumn=c.__nextColumn}}}e[b]=Math.max(e[b],t(h,b))}for(var d=0;d<v;d++){i[d].__cellIndex=null;i[d].__nextColumn=null}}for(var m=0,D=r.length;m<D;m++){for(var y=r[m],a=y.cell,x=y.col,z=parseInt(h.cellSpacing),o=0,s=0,A=a.colSpan;s<A;s++)o+=e[x+s];o+=(a.colSpan-1)*z;if(o<a.offsetWidth)e[x]+=a.offsetWidth-o}return e},getBoundingClientRect:function(c){var a=c.getBoundingClientRect();if(c==document.body){var b=document.body.getBoundingClientRect(),e=b.top+(document.documentElement.scrollTop||document.body.scrollTop),d=b.left+(document.documentElement.scrollLeft||document.body.scrollLeft);return{left:a.left-d,right:a.right-d,top:a.top-e,bottom:a.bottom-e}}else return a},offsetWidth:function(c,a,d){if(a==null)a=c;var b=getStyle(a,"display");if(b=="none"){var f=a.style.opacity;b=a.style.display;a.style.opacity=.001;a.style.display=d==null?"block":d;var e=c.offsetWidth;a.style.display=b;a.style.opacity=f;return e}else return c.offsetWidth},offsetHeight:function(b,a,e){if(a==null)a=b;var d=getStyle(a,"display");if(d=="none"){var g=a.style.opacity;d=a.style.display;a.style.opacity=.001;a.style.display=e==null?"block":e;var c=null;if(getStyle(b,"display")=="none"){c=b.style.display;b.style.display=a.style.display}var f=b.offsetHeight;if(c!=null)b.style.display=c;a.style.display=d;a.style.opacity=g;return f}else return b.offsetHeight},isIntersectRect:function(a,b){return a.top<=b.bottom&&a.bottom>=b.top&&a.left<=b.right&&a.right>=b.left},intersectRectangles:function(b,c){var g=Math.max(b.top,c.top),d=Math.min(b.bottom,c.bottom),f=Math.max(c.left,b.left),e=Math.min(b.right,c.right),a=g<d&&f<e?{top:g,left:f,bottom:d,right:e}:null;if(a){a.width=a.right-a.left;a.height=a.bottom-a.top}return a},getViewArea:function(a){if(a==null)return null;var c=a.getBoundingClientRect(),b={top:0,left:0,bottom:window.innerHeight||window.clientHeight,right:window.innerWidth||window.clientWidth};return $$.utils.intersectRectangles(c,b)},FindParent:function(c,b){if(c==null)return null;b=b.toLowerCase();var a=c;while(a!=null){if(a.tagName&&a.tagName.toLowerCase()==b)return a;a=a.parentNode}return null},getScriptURLs:function(j){for(var f=[],g=/>\s*</,d=j.split(g),c=0;c<d.length;c+=2){var a=d[c],h=/\s*src\s*=\s*(.*)/gi,e=h.exec(a);if(e!=null){a=e[1];var b=a.charAt(0);if(b=="'"||b=='"')a=a.substr(1);else b=" ";var i=a.indexOf(b,1);a=a.substr(0,i);f.push(a)}}return f},getSrcAttribute:function(d){var c=/\s*src\s*=\s*(.*)/gi,b=c.exec(d);if(b!=null){script=b[1];var a=script.charAt(0);if(a=="'"||a=='"')script=script.substr(1);else a=" ";var e=script.indexOf(a,1);return script.substr(0,e)}return null},getScriptBlockContent:function(a){if(a!=null&&a.length>0){var c=/(<script\s*>)|(<script\s+[^>]*>)([.\s\S]+)<\/script>/gi,b=c.exec(a);if(b!=null)return b[3]}return null},isShowingMultiColumnComboBox:function(editor){if(editor!=null){var mccbId=editor.getAttribute("mccbId");if(mccbId!=null){var editorObj=eval("window."+mccbId+"_Obj");return editorObj!=null&&editorObj.getIsDrop()}}return false},isTouchEvent:function(a){if(!a)return false;while(a.originalEvent)a=a.originalEvent;var c=a.pointerType,b=a.type,d=FarPoint.Web&&FarPoint.Web.Spread?FarPoint.Web.Spread.EventManipulator:null;return c&&c==a.MSPOINTER_TYPE_TOUCH||c=="touch"||b=="touchstart"||b=="touchmove"||b=="touchend"||b=="touchcancel"||d&&d.IsManipulatedEvent(b)},removeBackgroundImages:function(a,f){var h=$$.browser.securityWarning,d=false;if(h){var c;if(a.style&&a.style.backgroundImage.length>0){c=a.style.backgroundImage;a.style.backgroundImage="";f&&a.setAttribute("__backgroundImage",c);d=true}for(var g=a.all,e=0;e<g.length;e++){var b=g[e];if(b.nodeType==1&&b.style&&b.style.backgroundImage.length>0){c=b.style.backgroundImage;b.style.backgroundImage="";f&&b.setAttribute("__backgroundImage",c);d=true}}}return d},restoreBackgroundImages:function(){for(var a=0;a<arguments.length;a++)this.__restoreBackgroundImages(arguments[a])},__restoreBackgroundImages:function(b){var f=$$.browser.securityWarning;if(f){var a=b.getAttribute("__backgroundImage");if(a){b.style.backgroundImage=a;b.removeAttribute("__backgroundImage")}for(var e=b.all,d=0;d<e.length;d++){var c=e[d];if(c.nodeType==1){a=c.getAttribute("__backgroundImage");if(a){c.style.backgroundImage=a;c.removeAttribute("__backgroundImage")}}}}},detectScrollbarWidthHeight:function(){if(!this.scrollbarWidthHeight){var a=document.createElement("div");a.style.overflow="scroll";a.style.visibility="hidden";a.style.position="absolute";a.style.width="100px";a.style.height="100px";document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;document.body.removeChild(a);this.scrollbarWidthHeight=b}return this.scrollbarWidthHeight},indexOfAny:function(d,f,b){if(d==null||d.length==0)return-1;if(typeof b=="undefined")b=0;for(var a=-1,e=0;e<f.length;e++){var c=d.indexOf(f[e],b);if(c>-1&&(c<a||a==-1))a=c}return a},getDisableElement:function(c){var b=["button","input","select","textarea","optgroup","option","fieldset"],a=c;while(a!=null&&a.tagName!=null){var d=a.tagName.toLowerCase();if(b.indexOf(d)!=-1)return a;a=a.parentNode}return null},isDisabled:function(b){var a=this.getDisableElement(b);return a&&a.disabled},FixPositionProperties:function(c){var d=this.GetTouchObjectFromEvent(c);if(d)for(var b=["clientX","clientY","offsetX","offsetY","pageX","pageY","screenX","screenY"],a=0;a<b.length;a++){var e=b[a];try{c[e]=d[e]}catch(f){}}},GetTouchObjectFromEvent:function(b,d){var c=b.targetTouches&&b.targetTouches.length>0?b.targetTouches:b.changedTouches;if(c&&c.length>0){var a=c[0];if(a.offsetX==undefined){var f=a.target||b.target,e=f.getBoundingClientRect();a.offsetX=a.clientX-e.left;a.offsetY=a.clientY-e.top}return a}return d==undefined||d==true?b:null},selectAll:function(a){if(a.value!=null&&typeof a.selectionStart!="undefined"&&(!$$.browser.ie||$$.browser.version>8)){a.selectionStart=0;a.selectionEnd=a.value.length}else a.select&&a.select()},isArray:function(a){return Array.isArray?Array.isArray(a):Object.prototype.toString.call(a)==="[object Array]"},registerCss:function(c,h){if(c&&document.getElementById(c)!=null)return;var d=false,a=document.getElementsByTagName("head");if(!a){a=document.createElement("head");if($$.browser.mb)$$.j(a).insertBefore(document.body);else document.documentElement.insertBefore(a,document.body)}else{a=a[0];for(var f=a.getElementsByTagName("link"),e=0;!d&&e<f.length;e++){var g=f[e].href;if(g&&g.toLowerCase()==h.toLowerCase())d=true}}if(!d){var b=document.createElement("link");b.type="text/css";b.rel="stylesheet";b.href=h;if(c)b.id=c;a.appendChild(b)}},isFunctionKey:function(a){return a>=112&&a<=123||a>=33&&a<=36||a>=16&&a<=18},fixIssueEncodeURL:function(a){var c=a.indexOf("?");if(c>0){var b=a.substr(0,c);if(b.indexOf("%")>-1)b=decodeURI(b);a=encodeURI(b)+"?"+a.substr(c+1)}else{if(a.indexOf("%")>-1)a=decodeURI(a);a=encodeURI(a)}return a},isElementHidden:function(e,a,f){var h=e.getBoundingClientRect(),c;if(a==window.document.body)c={top:0,left:0,bottom:window.innerHeight,right:window.innerWidth};else{var b=a.getBoundingClientRect();c={top:b.top,left:b.left,bottom:b.top+a.clientHeight,right:b.left+a.clientWidth}}var d=function(a,b,c){return c?a.top<b.top||a.left<b.left||a.bottom>b.bottom||a.right>b.right:a.bottom<=b.top||a.right<=b.left||a.top>=b.bottom||a.left>=b.right},g=d(h,c,f);return g}};$$.DEBUG={Clear:function(){typeof DEBUG!="undefined"&&DEBUG.Clear()},Write:function(a){typeof DEBUG!="undefined"&&DEBUG.Write(a)},WriteLine:function(a){typeof DEBUG!="undefined"&&DEBUG.WriteLine(a)},Log:function(b,a){typeof DEBUG!="undefined"&&DEBUG.Log(b,a)},Trace:function(){typeof DEBUG!="undefined"&&DEBUG.Trace()},ConsoleLog:function(a){typeof console!="undefined"&&typeof console.log=="function"&&console.log(a)},SetConsoleContainer:function(a){typeof DEBUG!="undefined"&&DEBUG.SetConsoleContainer&&DEBUG.SetConsoleContainer(a)}}})(window);var FpSpreadJS=function(c,d,a){this.spread=c;this.context=d;this.childViewIndexes=[];this.cachedValues={};if(a!=null)for(var b in a.cachedValues)this.cachedValues[b]=a.cachedValues[b]};FpSpreadJS.prototype.constructor=FpSpreadJS;FpSpreadJS.prototype.getGridLineOffsetTop=function(a){if(typeof a.__$gridlineOffsetTop$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetTop$=0;else{var d=a.rows[0].cells,b=0;if($$.browser.ie){for(var c=0,g=d.length;c<g;c++){var e=$$(d[c]).border("Top");if(b<e)b=e}a.__$gridlineOffsetTop$=b>1?b>>1:0}else{for(var c=0,g=d.length;c<g;c++){var f=d[c].offsetTop;if(b<f)b=f}a.__$gridlineOffsetTop$=b}}return a.__$gridlineOffsetTop$};FpSpreadJS.prototype.getGridLineOffsetLeft=function(a){if(typeof a.__$gridlineOffsetLeft$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetLeft$=0;else if($$.browser.ie){var b=$$(a.rows[0].cells[0]).border("Left");a.__$gridlineOffsetLeft$=b>1?b>>1:0}else a.__$gridlineOffsetLeft$=a.rows[0].cells[0].offsetLeft;return a.__$gridlineOffsetLeft$};FpSpreadJS.prototype.getGridLineOffsetRight=function(a){if(typeof a.__$gridlineOffsetRight$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetRight$=0;else if($$.browser.ie){var b=$$(a.rows[0].cells[a.rows[0].cells.length-1]).border("Right");a.__$gridlineOffsetRight$=b>1?b>>1:0}else{var c=a.rows[0].cells[a.rows[0].cells.length-1],d=c.offsetLeft+c.offsetWidth;a.__$gridlineOffsetRight$=a.offsetWidth-d}return a.__$gridlineOffsetRight$};FpSpreadJS.prototype.getGridLineOffsetBottom=function(a){if(typeof a.__$gridlineOffsetBottom$=="undefined")if($$.browser.quirksMode||parseInt(a.cellSpacing)>0||a.rows.length==0||a.rows[0].cells.length==0)a.__$gridlineOffsetBottom$=0;else{var d=a.rows[a.rows.length-1].cells,b=0;if($$.browser.ie){for(var c=0,g=d.length;c<g;c++){var f=$$(d[c]).border("Bottom");if(b<f)b=f}a.__$gridlineOffsetBottom$=b>1?b>>1:0}else{for(var c=0,g=d.length;c<g;c++){var h=d[c].offsetTop+d[c].offsetHeight,e=a.offsetHeight-h;if(b<e)b=e}a.__$gridlineOffsetBottom$=b}}return a.__$gridlineOffsetBottom$};FpSpreadJS.prototype.getGridLineOffsetVertical=function(a){return this.getGridLineOffsetTop(a)+this.getGridLineOffsetBottom(a)};FpSpreadJS.prototype.getGridLineOffsetHorizontal=function(a){return this.getGridLineOffsetLeft(a)+this.getGridLineOffsetRight(a)};FpSpreadJS.prototype.getDisplayIndex=function(a){if(a<0)return-1;if(this.childViewIndexes.length==0)return a;var b=this.context,d=[null,null],e=b.getViewport0(),f=b.getViewport1(),g=b.getViewport2(),k=b.getViewport();if(e!=null&&e.rows.length>0)d[0]=e;else if(f!=null&&f.rows.length>0)d[0]=f;if(g!=null&&g.rows.length>0)d[1]=g;else d[1]=k;var h=b.frzRowCount();if(a<h||a<this.childViewIndexes[0])return a;if(a>=h+d[1].rows.length-this.childViewIndexes.length)return-1;var j={nearestPossible:true,getValueHandler:function(c,a){var b=c[a]-(a+1),d=1-1/(a+1);return b+d}},c=$$.utils.binarySearch(this.childViewIndexes,a,j);if(c<0)return a;var i=this.childViewIndexes[c]-(c+1);return a<=i?a+c:a+c+1};FpSpreadJS.prototype.getSheetIndex=function(a){if(a<0)return-1;if(this.childViewIndexes.length==0)return a;var c=this.context,b=[null,null],e=c.getViewport0(),f=c.getViewport1(),g=c.getViewport2(),i=c.getViewport();if(e!=null&&e.rows.length>0)b[0]=e;else if(f!=null&&f.rows.length>0)b[0]=f;if(g!=null&&g.rows.length>0)b[1]=g;else b[1]=i;var h=c.frzRowCount();if(h>0&&a<b[0].rows.length)return a;if(a>=h+b[1].rows.length)return-1;var d=$$.utils.binarySearch(this.childViewIndexes,a,{nearestPossible:true});return d<0?a:a>this.childViewIndexes[d]?a-(d+1):a-d};FpSpreadJS.prototype.getRowRangeFromCell=function(e){var h=this.context.getRowFromCell(e);if(this.context.getAttributeInternal("layoutMode")!=null){var d=e.parentNode.rowIndex,f=this.context.getViewportFromCell(e);if(f!=null){var b=f.rows,a=d,c=a,g=b[d].getAttribute("FpKey");while(a>0&&b[a-1].getAttribute("FpKey")==g)a--;var i=b.length-1;while(c<i&&b[c+1].getAttribute("FpKey")==g)c++;return{row:h-(d-a),rowCount:c-a+1}}}return{row:h,rowCount:1}};FpSpreadJS.prototype.getNextKeyedRow=function(a,b){b.index=-1;b.key=null;if(a<0)return;var d=this.context.GetRowCountInternal(),c=null;while(a<d){c=this.context.getRowKeyFromRow(a);if(c!=null&&c!="newRow"){b.index=a;b.key=c;return}a++}};FpSpreadJS.prototype.getPreviousKeyedRow=function(a,b){b.index=-1;b.key=null;var c=this.context.GetRowCountInternal();if(a>=c)return;while(a>-1){key=this.context.getRowKeyFromRow(a);if(key!=null&&key!="newRow"){b.index=a;b.key=key;return}a--}};FpSpreadJS.prototype.getRowByKey=function(b,e){if(b=="-1")return-1;if(b=="newRow")return this.getIndexOfNewRow(e);var f=this.context,j=parseInt(b),c=0,d=f.GetRowCountInternal()-1,g=-1,a={};while(c<=d){g=c+d>>1;this.getNextKeyedRow(g,a);(a.index==-1||a.index>d)&&this.getPreviousKeyedRow(g-1,a);if(a.index==-1||a.index<c||a.key==b)break;if(parseInt(a.key)<j)c=a.index+1;else d=a.index-1}if(a.key==b){for(var i=a.index,h=a.index-1;h>=0;h--){if(f.getRowKeyFromRow(h)!=b)break;i--}return i}return typeof e!="undefined"?e:f.GetRowCountInternal()>0?0:-1};FpSpreadJS.prototype.getIndexOfNewRow=function(d){var b=this.context.getViewport1();if(b!=null)for(var a=0;a<b.rows.length;a++)if(b.rows[a].getAttribute("FpKey")=="newRow")return a;var c=this.context.getViewport();if(c!=null)for(var e=b!=null?b.rows.length:0,a=0;a<c.rows.length;a++)if(c.rows[a].getAttribute("FpKey")=="newRow")return a+e;return d?d:c!=null?0:-1};FpSpreadJS.prototype.countChildViews=function(){var b=FpSpreadJS.getChildViews(this.spread);this.childViewIndexes=[];for(var a=0;a<b.length;a++){var c=b[a].parentNode.parentNode;this.childViewIndexes.push(c.rowIndex)}};FpSpreadJS.prototype.correctFocusOnActiveCell=function(b,o,n,h){if(this.spread.document.FpActiveSpread!=this.spread||$$.browser.mb&&this.spread.getSpreadView().IsPopupOpened())return false;var l=this.spread.getAttributeInternal("OperationMode");if(l!="Normal"&&(!$$.browser.mb||l!="RowMode"))return false;if(b!=null&&!this.spread.isHeaderCell(b)){var f=this.spread.getEditor(b),a=this.spread.document.activeElement;if(f!=null&&a!=f&&!FarPoint.System.IsChild(f,a)){if(a!=null&&a!=""){for(var p=[this.context.getFrozColHeader(),this.context.getColHeader(),this.context.getFrozRowHeader(),this.context.getRowHeader()],e=false,j=$$.browser,g=0;g<4;g++){var m=p[g];if(m==null)continue;if(FarPoint.System.IsChild(m,a)||j.version==6&&a==this.context.textBox)if(a.tagName=="INPUT"||a.tagName=="TEXTAREA"||a.tagName=="SELECT"||a.tagName=="BUTTON"){e=true;break}}var k=this.context.getCommandBar();if(k!=null&&j.version==6&&FarPoint.System.IsChild(k,a))e=true;if(e)return false}if(n)return true;if(!$$.utils.contains(this.spread,b))return false;if(!o){this.spread.setEditorFocus(b,null,null,h);var d=this.spread.getSpreadView();d.SynchronizeScroll(d._GetViewportFromCell(b).parentNode)}else{var c=this,d=this.spread.getSpreadView();d.RegisterTimeoutTask(function(){var a=c.spread.getSpreadView();if(document.FpActiveSpread==c.spread&&!a.IsPopupOpened()){c.spread.setEditorFocus(b,null,null,h);a.SynchronizeScroll(a._GetViewportFromCell(b).parentNode)}c=null},0,"CorrectFocusOnActiveCell",true)}}else{var d=this.spread.getSpreadView();if(d.IsSpreadActive()){var i=d.GetSpreadContext().getSpreadControl(a);if(i!=null&&i!=this.spread){var c=this;d.RegisterTimeoutTask(function(){!c.spread.isEditing()&&c.spread.getSpreadView().GetTopSpreadView().Spread.GetActiveChartObj()==null&&c.spread.getSpreadView().FocusSpread()},0,"CorrectFocusOnActiveCell",true)}}}}return false};FpSpreadJS.prototype.getNextColumn=function(i,a,g,f,d){var b=null,c=this.spread.GetColCount();if(c==0)return-1;var e=a;do{b=this.spread.getCellFromRowCol(i,a);if(b==null)break;var h=g&&b.getAttribute("TabStop")=="false"||f&&b.getAttribute("canFocus")=="false";if(!h)break;if(b==null)a++;else a+=parseInt(b.colSpan);if(d){if(a==c)a=0;if(a==e)return-1}}while(a<c);return a>=c?-1:a};FpSpreadJS.prototype.isCommandButtonEnabled=function(a){return a!=null&&!a.disabled&&a.className!="aspNetDisabled"};FpSpreadJS.prototype.createPasteCapturing=function(){var a=document.getElementById(this.spread.id+"_PasteCapturing");if(a==null){a=document.createElement("div");a.id=this.spread.id+"_PasteCapturing";a.style.position="absolute";a.style.height="1px";a.style.width="1px";a.style.top="-1000px";a.style.left="-1000px";a.style.whiteSpace="pre";a.setAttribute("contentEditable",true);this.spread.appendChild(a)}};FpSpreadJS.prototype.getExtender=function(a){var b=null;if(a!=null)do{if(a.id!=null&&a.id.indexOf(this.spread.id)>=0){var b=a.getAttribute("Extenders");if(b!=null)break}a=a.parentElement}while(a!=null&&a.parentNode.getAttribute("FpSpread")==null);return b};FpSpreadJS.prototype.loadNewScripts=function(f,x,j){var w=typeof __cultureInfo==="undefined",a=f.tagName=="IFRAME"?f.contentWindow.document.body:f;this.spread.getSpreadView().LoadFilterHiddenValueFields(a,null,x);var u="__VALIDATORSCRIPTBLOCK",C="__SCRIPTBLOCK",y="__ARRAYDECLARES",v="__ARRAYDECLARES_LIST",D="__EXPANDOSCRIPT",B="__STARTUPSCRIPT",n=$$(a).getChild(C),e=[],c=[];if(n){var b=FpSpreadJS.getGCScript(n.value);if(b.length>0){var h=b.substr(0,b.indexOf("|"));b=b.substr(h.length+1,b.length-h.length-1);for(var s=b.split(h),i=0;i<s.length;i++){var t=s[i],g=$$.utils.getSrcAttribute(t);if(g!=null)!FarPoint.System.ExtenderHelper.checkInclude(g)&&e.push({Type:"resource",Url:g});else{var r=$$.utils.getScriptBlockContent(t);r!=null&&e.push({Type:"script",Content:r})}}}}var k=$$(a).getChild(u);if(k!=null){var z=k.value;c.push(z)}var l=$$(a).getChild(D);if(l!=null){var p=FpSpreadJS.getGCScript(l.value);p.length>0&&c.push(p)}var m=$$(a).getChild(B);if(m!=null){var q=FpSpreadJS.getGCScript(m.value);q.length>0&&c.push(q)}var d=$$(a).getChild(y),A=$$(a).getChild(v),E=this;function o(){if(w&&typeof __cultureInfo==="object"&&typeof Sys!="undefined"&&Sys.CultureInfo){Sys.CultureInfo.CurrentCulture=Sys.CultureInfo._parse(__cultureInfo);delete __cultureInfo}if(d!=null&&d.value.length>0){FpSpreadJS.processArrayDeclare(E.spread,d,A);d.value=""}for(var a=0;a<c.length;a++)try{var b=c[a];if(window.execScript)window.execScript(b);else eval.call(window,b)}catch(e){}FpSpreadJS.simulateValidatorsLoad();j&&j()}if(e.length>0)this.spread.getSpreadJS().appendScripts(e,o);else o()};FpSpreadJS.getGCScript=function(a){if(a.indexOf("${GC}$")==-1)return a;var b=a.split("${GC}$");if(b.length>1)return b[1]};FpSpreadJS.processArrayDeclare=function(spread,input,namesInput){if(input==null||namesInput==null)return;var declareString=input.value;if(declareString.length>0)try{for(var arrayNames=eval(namesInput.value),i=arrayNames.length-1;i>=0;i--){var an=arrayNames[i];if(window[an]==null)arrayNames.splice(i,1);else window["$GCBK_"+an]=window[an]}if(window.execScript)window.execScript(declareString);else eval.call(window,declareString);for(var i=arrayNames.length-1;i>=0;i--){var an=arrayNames[i],newArray=window[an],bkArray=window["$GCBK_"+an];if(an=="Page_Validators")FpSpreadJS.updatePageValidators(spread,bkArray,newArray);else for(var j=0;j<bkArray.length;j++){var item=bkArray[j];$$(newArray).indexOf(item)==-1&&newArray.push(item)}window["$GCBK_"+an]=null}}catch(e){if(window.$DEBUG)throw e;}};FpSpreadJS.updatePageValidators=function(i,h,g){for(var a=h,f=g,d=0;d<f.length;d++){var c=f[d];if(c==null)continue;if(c.getAttribute("__FpSpread")){for(var e=false,b=0;b<a.length;b++)if(a[b]!=null&&a[b].id==c.id){a[b]=c;e=true;break}!e&&a.push(c)}}window.Page_Validators=a;i.getSpreadView()._DisableSpreadValidators()};FpSpreadJS.simulateValidatorsLoad=function(){if(typeof ValidatorOnLoad=="function"&&typeof Page_Validators!="undefined"){for(var a=0;a<Page_Validators.length;){var b=Page_Validators[a];if(b==null){Page_Validators.splice(a,1);continue}if(typeof b.isvalid=="boolean"&&!b.isvalid)b.isvalid="False";a++}ValidatorOnLoad()}};FpSpreadJS.prototype.findCFContentBound=function(c){for(var d,b=0;b<c.childNodes.length;b++){var a=c.childNodes[b];if(a.nodeType==1&&a.getAttribute("cfContentBound")!=null){d=a;break}}return d};FpSpreadJS.prototype.getRender=function(b,f){if(b==null)return null;var d=this.findCFContentBound(b);if(d!=null)b=d;var e=!f?this.context.findContentTag(b):f(b);if(e!=null)return e;var c=b;if(c.children.length>0){var a=c.children[0];if(a!=null&&a.tagName!=null&&a.tagName!="BR")c=a;if(a!=null&&typeof a.value!="undefined")c=a}return c};FpSpreadJS.prototype.buildTargetColsMoved=function(a,f,e){if(a!=null&&a.length>0){var c=a.slice(0,a.length),b=e-f;if(b>0)b--;if(b!=0)for(var d=0;d<c.length;d++)c[d]+=b;return c}return null};FpSpreadJS.prototype.getOperationMode=function(){return FpSpreadJS.attribute(this.spread,"OperationMode")};FpSpreadJS.prototype.getSelectionPolicy=function(){return FpSpreadJS.attribute(this.spread,"SelectionPolicy")};FpSpreadJS.prototype.updateSelectionRangeFromCell=function(f){var q=this.getOperationMode();if(f==null)return;var A=$$(f).getParent("TABLE");if(A==null||A.parentNode==null)return;if($$(f).getDocument()!=$$(this.spread).getDocument()||this.context.getRowKeyFromCell(f)==null||q=="MultiSelect"||q=="ExtendedSelect")return;var m=this.spread,z=FpSpreadJS.attribute(m,"layoutMode");if(FpSpreadJS.attribute(m,"mcctCellType")=="true")return;var h=f.parentNode.getAttribute("FpSpread");if(h=="r"||h=="rh"||h=="ch"){var s=f.getAttribute("col");if(h=="r"&&q!="RowMode"&&s=="-1")return;var a=null,d=null,k=null,l=null;if(h=="r"||h=="ch"){if(s!=null&&s!="-1")d=parseInt(s);else if(s==null){var o=this.context.getColFromCell(f);if(o>=this.context.frzColCount())o=o-this.context.frzColCount();var x=this.context.getColGroup(f.parentNode.parentNode.parentNode);if(x.childNodes.length>o&&x.childNodes[o].getAttribute("FpCol")!=null)d=parseInt(x.childNodes[o].getAttribute("FpCol"))}else d=0;if(h=="ch")a=k=-1}if(h=="r"||h=="rh"){a=this.context.getRowKeyFromCell(f);if(h=="rh")d=l=-1}var e=m.getSpreadView?m.getSpreadView():null,t=e?e.IsInTouchMode()||e.Touch&&e.GetSpreadContext().isInTouchAjax():false;if(a>-1||a=="newRow")k=1;if(d>-1)l=1;if((a>-1||a=="newRow")&&d>-1&&q!="Normal"&&q!="ReadOnly"){d=-1;l=-1;if(z!=null&&(!t||f.getAttribute("group")==null)){var j=f.parentNode.previousSibling;while(j!=null&&j.getAttribute&&j.getAttribute("FpKey")==a)j=j.previousSibling;if(j!=null&&j.getAttribute&&j.getAttribute("FpKey")==a)a=j.getAttribute("FpKey");k=parseInt(m.getAttribute("layoutrowcount"))}else k=1}var w=this.context.getLeadingCellRow(),v=this.context.getLeadingCellCol();if(w!=null&&v!=null&&w>-1&&v>-1&&this.context.getCellFromRowCol(w,v)==f){if(a=="newRow"||a>-1)a=this.context.getRowKeyFromRow(w);if(z==null)if(d>-1)d=this.context.getColKeyFromCol(v)}if(a!=null&&d!=null&&k!=null&&l!=null){if(t&&a>-1&&d>-1&&!e.IsRowLayoutMode){var u=new GCWS.CellRange(e._GetRowIndexByViewIndex(this.context.getRowByKey(parseInt(a))),this.context.getColByKey(parseInt(d)),k,l),g=e._FindExpandedSelection(u);if(g!=u){a=this.context.getRowKeyFromRow(e._GetRow(g.Row).ViewIndex);d=this.context.getColKeyFromCol(g.Column);k=g.RowCount;l=g.ColumnCount}}var i=this.context.getSelection();if(t&&i.childNodes.length>0&&e.OperationMode==$$.OperationModes.ROW_MODE)return;for(var C=[],n=0;n<i.childNodes.length;n++){var r=i.childNodes[n],b={row:r.getAttribute("row")=="newRow"?"newRow":parseInt(r.getAttribute("row")),col:parseInt(r.getAttribute("col")),rowCount:parseInt(r.getAttribute("rowcount")),colCount:parseInt(r.getAttribute("colcount"))};if(b.col!=-1&&m.GetColByKey(b.col)==-1)b.col=0;if(b.row!=-1&&m.GetRowByKey(b.row)==-1)b.row=0;if(t&&b.row!="newRow"&&b.row>-1&&b.col>-1&&!e.IsRowLayoutMode){var u=new GCWS.CellRange(e._GetRowIndexByViewIndex(this.context.getRowByKey(parseInt(b.row))),this.context.getColByKey(parseInt(b.col)),b.rowCount,b.colCount),g=e._FindExpandedSelection(u);if(g!=u){b.row=this.context.getRowKeyFromRow(e._GetRow(g.Row).ViewIndex);b.col=this.context.getColKeyFromCol(g.Column);b.rowCount=g.RowCount;b.colCount=g.ColumnCount}}C.push(b)}var p={row:a=="newRow"?"newRow":parseInt(a),col:parseInt(d),rowCount:k,colCount:l},B=false;if(!FpSpreadJS.isNestedInRanges(p,C))B=true;if(B){for(var c=null,n=0;n<i.childNodes.length;n++)if(i.childNodes[n].getAttribute("anchor")!=null){c=i.childNodes[n];break}if(c==null){if(this.context.createSelectionNode)c=this.context.createSelectionNode(-1,-1,-1,-1);else if(document.all!=null&&this.context.getData)c=this.context.getData().createNode("element","range","");else{c=document.createElement("range");c.style.display="none"}var y=i.childNodes[0];if(y!=null)i.insertBefore(c,y);else i.appendChild(c);c.setAttribute("anchor","true")}c.removeAttribute("rowIndex");c.removeAttribute("colIndex");c.setAttribute("row",p.row);c.setAttribute("col",p.col);c.setAttribute("rowcount",p.rowCount);c.setAttribute("colcount",p.colCount);this.context.updateSelectionViewIndexes(c)}}}};FpSpreadJS.prototype.keepGeneratedSelectionFromAnchorCell=function(){var b=this.context.getSelection();if(b!=null)for(var c=b.childNodes,a=0,e=c.length;a<e;a++){var d=c[a];if(d.getAttribute("anchor")!=null){d.removeAttribute("anchor");break}}};FpSpreadJS.prototype.isOutOfView=function(d){if(d==null)return true;var b=this.context.getTopSpread();if(this.spread!=b&&b!=null)return b.fpSpreadJS.isOutOfView(d);var h=b&&b.getSpreadView().IsMultiBrowserMode(),a=[this.context.getViewport1(),this.context.getViewport2(),this.context.getViewport()];h&&a.push(this.context.getViewport0());for(var i=false,c=0;c<a.length;c++)if(a[c]!=null&&this.context.isChild(d,a[c])){i=true;break}if(!i)return true;var g=h?a[c].parentNode:this.context.getScrollvp();if(g==null)g=this.context.getViewport().parentNode;var e=g.getBoundingClientRect(),f=d.getBoundingClientRect();return f.top<e.top||f.bottom>e.bottom||f.left<e.left||f.right>e.right};FpSpreadJS.attribute=function(b,a,c){if(typeof c=="undefined")return $$.browser.ie&&$$.browser.version<9?b[a]:b.getAttribute(a);else if($$.browser.ie&&$$.browser.version<9)b[a]=c;else b.setAttribute(a,c)};FpSpreadJS.isChildSpreadRow=function(d,e){if(d==null)return false;if(e>=0&&e<d.rows.length){var a=d.rows[e].cells[0];if(a){var b=null;if(a.children)b=a.children[0];else for(var c=0;c<a.childNodes.length;c++)if(a.childNodes[c].nodeType==1){b=a.childNodes[c];break}if(b!=null&&FpSpreadJS.attribute(b,"FpSpread")=="Spread")return true}}return false};FpSpreadJS.getChildViews=function(e){var a=FpSpreadJS.attribute(e,"expandedRowKeys");if(a==null||a=="")return[];for(var d=[],g=a.split(","),b=0;b<g.length;b++)for(var h=g[b].split("_"),j=h[0],i=parseInt(h[1]),c=0;c<i;c++){var k=e.id+"_"+j+"_"+c,f=document.getElementById(k);f!=null&&d.push(f)}return d};FpSpreadJS.getAllChildViews=function(b){var a=[];FpSpreadJS.loadAllChildViews(b,a);return a};FpSpreadJS.loadAllChildViews=function(d,c){for(var b=FpSpreadJS.getChildViews(d),a=0;a<b.length;a++){c.push(b[a]);FpSpreadJS.loadAllChildViews(b[a],c)}};FpSpreadJS.getEditingSpread=function(a){if(typeof a.isEditing!="undefined"&&a.isEditing())return a;for(var d=FpSpreadJS.getAllChildViews(a),c=0;c<d.length;c++){var b=d[c];if(typeof b.isEditing!="undefined"&&b.isEditing())return b}return null};FpSpreadJS.checkInitLayoutCompleted=function(d,b){if((b==null||b)&&!d.initLayoutCompleted)return false;for(var c=FpSpreadJS.getChildViews(d),a=0;a<c.length;a++){var e=c[a];if(!FpSpreadJS.checkInitLayoutCompleted(e))return false}return true};FpSpreadJS.mergeRanges=function(e){if(e.length==0)return null;for(var d=[],c=0;c<e.length;c++){var a=e[c],b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount};if(a.row<0&&a.rowCount!=0){b.row=0;b.rowCount=Number.MAX_VALUE}if(a.col<0&&a.colCount!=0){b.col=0;b.colCount=Number.MAX_VALUE}d.push(b)}for(var a=d[d.length-1],c=d.length-2;c>=0;c--){var b=d[c];if(a.row>=b.row&&a.col>=b.col&&a.row+a.rowCount<=b.row+b.rowCount&&a.col+a.colCount<=b.col+b.colCount)a=b}if(a.rowCount==Number.MAX_VALUE)a.row=a.rowCount=-1;if(a.colCount==Number.MAX_VALUE)a.col=a.colCount=-1;return a};FpSpreadJS.isNestedInRanges=function(a,e){if(e.length==0)return false;e.push(a);for(var d=[],c=0;c<e.length;c++){a=e[c];var b={row:a.row,col:a.col,rowCount:a.rowCount,colCount:a.colCount};if(a.row<0&&a.rowCount!=0){b.row=0;b.rowCount=Number.MAX_VALUE}if(a.col<0&&a.colCount!=0){b.col=0;b.colCount=Number.MAX_VALUE}d.push(b)}a=d[d.length-1];for(var c=d.length-2;c>=0;c--){var b=d[c];if(a.row=="newRow"&&b.row=="newRow"&&a.col>=b.col&&a.col+a.colCount<=b.col+b.colCount||a.row>=b.row&&a.col>=b.col&&a.row+a.rowCount<=b.row+b.rowCount&&a.col+a.colCount<=b.col+b.colCount)return true}return false};FpSpreadJS.getAllSpreads=function(a){var b=[a];FpSpreadJS.__getAllChildSpreads(a.id,b);return b};FpSpreadJS.__getAllChildSpreads=function(f,c){var b=document.getElementById(f);if(b==null)return;for(var d=FpSpreadJS.getChildViews(b),a=0;a<d.length;a++){var e=d[a];c.push(e);FpSpreadJS.__getAllChildSpreads(e.id,c)}};FpSpreadJS.hasActiveCell=function(f){var e=-1,d=-1;if($$.browser.ieversion<9){var a=element.document.getElementById(f.id+"_XMLDATA");if(a){var b=a.documentElement.selectSingleNode("/root/state/activeColumn"),c=a.documentElement.selectSingleNode("/root/state/activeRow");if(b!=null&&b.text!="")d=parseInt(b.text);if(c!=null&&c.text!="")e=parseInt(c.text)}}else{var a=$$.fn.createXMLDOMWrapper(f);if(a){var b=a.selectSingleNode("root state activeColumn"),c=a.selectSingleNode("root state activeRow");if(b!=null&&a.textContent(b)!="")d=parseInt(a.textContent(b));if(c!=null&&a.textContent(c)!="")e=parseInt(a.textContent(c))}}return e!=-1&&d!=-1};FpSpreadJS._applyScrollbarAppearances=function(b,a){if(b==null||a==null)return;a.style.scrollbar3dlightColor=b.style.scrollbar3dlightColor;a.style.scrollbarArrowColor=b.style.scrollbarArrowColor;a.style.scrollbarBaseColor=b.style.scrollbarBaseColor;a.style.scrollbarDarkshadowColor=b.style.scrollbarDarkshadowColor;a.style.scrollbarFaceColor=b.style.scrollbarFaceColor;a.style.scrollbarHighlightColor=b.style.scrollbarHighlightColor;a.style.scrollbarShadowColor=b.style.scrollbarShadowColor;a.style.scrollbarTrackColor=b.style.scrollbarTrackColor};FpSpreadJS.getTableRow=function(b){if(b==null)return null;var a=b;do{if(a.tagName=="TR")return a;a=a.parentNode}while(a!=null&&a!=document.body&&a!=document);return null};FpSpreadJS.getTable=function(b){if(b==null)return null;var a=b;do{if(a.tagName=="TABLE")return a;a=a.parentNode}while(a!=null&&a!=document.body&&a!=document);return null};FpSpreadJS.prototype.GetInlineEditor=function(d){var c=this.context,b=c.getEditor(d);if(b!=null){var a=c.getCellEditorID(d);if(a==null||a==this.spread.getAttribute("FpDefaultEditorID")&&b.id!=a)return b}return null};FpSpreadJS.prototype.getDataView=function(){var c=this.spread.getViewport();if(c!=null)c=c.parentNode;var f=c!=null?c.getBoundingClientRect():null,b=this.spread.getViewport1();if(b!=null)b=b.parentNode;var h=b!=null?b.getBoundingClientRect():null,d=this.spread.getRowHeader(),g=d!=null?d.getBoundingClientRect():null,e=this.spread.getBoundingClientRect(),a={left:0,right:0,top:0,bottom:0,width:0,height:0};a.left=d!=null?g.right:e.left;a.right=e.right;a.top=b!=null?h.top:f.top;a.bottom=f.bottom;a.width=a.right-a.left;a.height=a.bottom-a.top;return a};FpSpreadJS.prototype.BackupBackgroundProperties=function(a,c){if(a==null)return;if(!$$.browser.ie||$$.browser.version>=9){var b=a.getAttribute("hasSparkline")!=null,f=$$.j?$$.j(a):null,e=$$.browser.ie?"url(about:blank)":"url(about:invalid)";if(b){a.getAttribute("bk_sparkline_image")==null&&a.setAttribute("bk_sparkline_image",a.style.backgroundImage);a.getAttribute("bk_sparkline_bgposition")==null&&a.setAttribute("bk_sparkline_bgposition",a.style.backgroundPosition);a.getAttribute("bk_sparkline_bgrepeat")==null&&a.setAttribute("bk_sparkline_bgrepeat",a.style.backgroundRepeat);a.getAttribute("bk_sparkline_bgsize")==null&&a.setAttribute("bk_sparkline_bgsize",$$.browser.chrome||$$.browser.webkit?f.css("background-size"):a.style.backgroundSize)}if(c=="select"){if(a.getAttribute("bgSelImg")){a.style.backgroundImage=a.getAttribute("bgSelImg");if(b){a.style.backgroundPosition="0% 0%";a.style.backgroundRepeat="no-repeat";a.style.backgroundSize="auto"}}else if(!b){var d=a.currentStyle?a.currentStyle.backgroundImage:f.css("backgroundImage");if(d!=null&&d!=""&&d!="none"){a.style.backgroundImage=e;if($$(a).hasCssClass("ui-state-highlight"))if(a.style.removeProperty)a.style.removeProperty("background-image");else a.style.removeAttribute("background-image")}}}else if(b&&c=="edit")if(a.getAttribute("bgSelImg")==null)a.style.backgroundImage=e}else{var b=a.hasSparkline;if(b){if(a.bk_sparkline_image==null)a.bk_sparkline_image=a.style.backgroundImage;if(a.bk_sparkline_bgposition==null)a.bk_sparkline_bgposition=a.style.backgroundPosition;if(a.bk_sparkline_bgrepeat==null)a.bk_sparkline_bgrepeat=a.style.backgroundRepeat}if(c=="select"){if(a.bgSelImg){a.style.backgroundImage=a.bgSelImg;if(b){a.style.backgroundPosition="0% 0%";a.style.backgroundRepeat="no-repeat"}}else if(!b&&a.currentStyle)if(a.currentStyle.backgroundImage!=null&&a.currentStyle.backgroundImage!=""&&a.currentStyle.backgroundImage!="none"){a.style.backgroundImage="url(about:blank)";if($$(a).hasCssClass("ui-state-highlight"))a.style.backgroundImage=""}}else if(b&&c=="edit")if(!a.bgSelImg)a.style.backgroundImage="url(about:blank)"}};FpSpreadJS.prototype.RestoreBackgroundProperties=function(a,b){if(a==null||this.spread.isEditing()&&a==this.spread.getAnchorCell())return;if(a.getAttribute("bgSelImg")!=null&&b)return;if(!$$.browser.ie||$$.browser.version>=9){if(a.getAttribute("hasSparkline")!=null){if(a.getAttribute("bk_sparkline_image")!=null){if(a.style.backgroundImage!=a.getAttribute("bk_sparkline_image"))a.style.backgroundImage=a.getAttribute("bk_sparkline_image");a.removeAttribute("bk_sparkline_image")}if(a.getAttribute("bk_sparkline_bgposition")!=null){a.style.backgroundPosition=a.getAttribute("bk_sparkline_bgposition");a.removeAttribute("bk_sparkline_bgposition")}if(a.getAttribute("bk_sparkline_bgrepeat")!=null){a.style.backgroundRepeat=a.getAttribute("bk_sparkline_bgrepeat");a.removeAttribute("bk_sparkline_bgrepeat")}if(a.getAttribute("bk_sparkline_bgsize")!=null){a.style.backgroundSize=a.getAttribute("bk_sparkline_bgsize");a.removeAttribute("bk_sparkline_bgsize")}}else if(a.getAttribute("bgImg")!=null)a.style.backgroundImage=a.getAttribute("bgImg")}else if(a.hasSparkline){if(a.bk_sparkline_image){a.style.backgroundImage=a.bk_sparkline_image;a.removeAttribute("bk_sparkline_image")}if(a.bk_sparkline_bgposition){a.style.backgroundPosition=a.bk_sparkline_bgposition;a.removeAttribute("bk_sparkline_bgposition")}if(a.bk_sparkline_bgrepeat){a.style.backgroundRepeat=a.bk_sparkline_bgrepeat;a.removeAttribute("bk_sparkline_bgrepeat")}}else if(a.bgImg!=null)a.style.backgroundImage=a.bgImg};FpSpreadJS.prototype.isAjaxPopup=function(c,b){if(b==null)return false;var a=b;while(a!=null&&a.tagName!="BODY"){if(a.className=="ajax__calendar"){var d=a.getAttribute("pid");if(document.getElementById(d)==c)return true;break}a=a.parentNode}return false};FpSpreadJS.prototype.isPopupEditor=function(a){return a!=null&&(a.tagName=="SELECT"||a.getAttribute("FpEditor")=="MultiColumnComboBoxCellType")};FpSpreadJS.prototype.InitMCCBCT=function(a){if(a==null)return;var b=this.spread.Behavior?this.spread.Behavior.getMccbID(a,this.spread):this.context.getMccbID(a,this.spread);b!=null&&FarPoint.System.WebControl.MultiColumnComboBoxCellType.CheckInit(b)};FpSpreadJS.prototype.replaceStringAll=function(a,d,c){if(a==null||a.length==0)return"";var b=a.length;while(true){a=a.replace(d,c);if(a.length==b)break;b=a.length}return a};FpSpreadJS.prototype.formatNumber=function(c,b,e,h,d){if(c!=null){var a=Sys.CultureInfo.CurrentCulture,f=a.numberFormat,j=f.NumberDecimalDigits,i=f.NumberGroupSeparator;if(e!=null&&e!="undefined")a.numberFormat=e;else{if(b=="n")return c.toString();if(b=="d"){if(d==null)if(!h)return c.toString();if(d!=null&&d!=a.numberFormat.NumberDecimalDigits)a.numberFormat.NumberDecimalDigits=d;a.numberFormat.NumberGroupSeparator=""}}if(b=="n")a.numberFormat.NumberDecimalDigits=0;else if(b=="d")b="n";var g=c._toFormattedString?c._toFormattedString(b,a):Sys._toFormattedString?Sys._toFormattedString.call(c,b,a):c;if(!h){var l=a.numberFormat.NumberDecimalSeparator,k=a.numberFormat.NumberDecimalDigits;if(b=="c")var l=a.numberFormat.CurrencyDecimalSeparator,k=a.numberFormat.CurrencyDecimalDigits;g=this._removeZero(g,l,k)}a.numberFormat=f;a.numberFormat.NumberDecimalDigits=j;a.numberFormat.NumberGroupSeparator=i;return g}return""};FpSpreadJS.prototype.getNumber=function(g,b,h,f){var a=this.getNumberFormat(g,h);if(a==null)a=Sys.CultureInfo.CurrentCulture.numberFormat;var c=null;if(f){var d=a.CurrencySymbol;if(d==null)d="$";b=b.replace(d,"");var e=a.NumberGroupSeparator,j=a.NumberDecimalSeparator,i=a.NumberDecimalDigits,e=a.NumberGroupSizes,l=a.NumberPositivePattern,k=a.NumberNegativePattern;a.NumberGroupSeparator=a.CurrencyGroupSeparator;a.NumberDecimalSeparator=a.CurrencyDecimalSeparator;a.NumberDecimalDigits=a.CurrencyDecimalDigits;a.NumberGroupSizes=a.CurrencyGroupSizes;a.NumberPositivePattern=a.CurrencyPositivePattern;a.NumberNegativePattern=a.CurrencyNegativePattern;c=this.parseNumber(b,a);a.NumberGroupSeparator=e;a.NumberDecimalSeparator=j;a.NumberDecimalDigits=i;a.NumberGroupSizes=e;a.NumberPositivePattern=l;a.NumberNegativePattern=k}else c=this.parseNumber(b,a);return c};FpSpreadJS.prototype.tryGetNumber=function(d,e,c,b){var a=this.getNumber(d,e,b,c);if(a==null)a=this.getNumber(d,e,!b,c);return a};FpSpreadJS.prototype._removeZero=function(a,f,e){var c=0,b=a.length-1,d=a.indexOf(f);if(d>=0){b=d+e;while(b>d&&a.charAt(b)=="0"){b--;c++}}if(c==e&&c>0){b--;c++}a=a.substr(0,b+1)+a.substr(b+1+c);return a};FpSpreadJS.prototype.parseNumber=function(e,c){var b=Sys.CultureInfo.CurrentCulture,d=b.numberFormat;if(c!=null)b.numberFormat=c;var a=null;try{a=Number._parse(e,b);if((isNaN(a)||a==null)&&c!=null){b.numberFormat=d;a=Number._parse(e,b)}}catch(f){}b.numberFormat=d;return a!=null&&isNaN(a)?null:a};FpSpreadJS.prototype.formatDate=function(c,b,a){return FarPoint.Web.Spread.DateUtils.FormatDate(c,b,a)};FpSpreadJS.prototype.formatDateToFormatString=function(a,b){return a._toFormattedString(b,Sys.CultureInfo.CurrentCulture)};FpSpreadJS.prototype.isValidDateTime=function(a,c){var b=this.parseDate(a,c,true);return b!=null};FpSpreadJS.prototype._parseDateExact=function(c,b,a){return Date._parseExact(c,b,a)};FpSpreadJS.prototype.parseDate=function(b,c,a){return FarPoint.Web.Spread.DateUtils.ParseDate(b,c,a)};FpSpreadJS.prototype.getNumberFormat=function(a,b){var c=b?a.getAttribute("enf"):a.getAttribute("nf");return parseJsonObject(c)};FpSpreadJS.prototype.getDateTimeFormat=function(a){return FarPoint.Web.Spread.DateUtils.GetDateTimeFormat(a,val,fromEdit)};FpSpreadJS.prototype.getDateTimeFormatString=function(a){return FarPoint.Web.Spread.DateUtils.GetDateTimeFormatString(a,fromEdit)};function parseJsonObject(a){return FarPoint.Web.Spread.DateUtils.ParseJSONObject(a)}FpSpreadJS.prototype.isFormula=function(a){return a.charAt(0)=="="};FpSpreadJS.prototype.getImeMode=function(c){var a=c.getAttribute("ime-mode");if(a!=null&&a!="")return a;var e=this.spread.getSpreadView().GetSpreadContext(),b=e.getEditor(c);if(b==null){var d=this.spread.getCellEditorID(c);if(d!=null)b=this.spread.getCellEditor(d,true)}a=b!=null&&b.style.imeMode!=""?b.style.imeMode:c.getAttribute("ime-mode");return a};FpSpreadJS.prototype.setImeMode=function(c,a,d,n){var b=c.getSpreadView?c.getSpreadView():null,l=b==null||!b.IsSuspendFocusSpread(),k=b!=null&&b.GetActiveSpread()==c;if(a==null||d==null||a.parentNode==null||!c.initialized||c.updating||this._checkIgnore(d)||!k||a.style.imeMode===undefined)return;var j=$$.utils.getDocActiveElement();if(j!=null&&b!=null&&b.ColumnHeaders!=null)for(var h=0;h<b.ColumnHeaders.length;h++)if($$.utils.contains(b.ColumnHeaders[h],j))return;var e=this.isReadOnly(d)?"disabled":d.getAttribute("ime-mode");if(e==null)e="";if(e!=a.style.imeMode||n){a.style.imeMode=e;if(l&&$$.utils.getDocActiveElement()!=null){var g=b.GetSpreadContext(),i=backupEvent2=null,f=b.IsMultiBrowserMode();if(f){g.detachOnActiveEvents();b.RequireUpdateTextBoxLocation()&&b.UpdateTextBoxLocation(b.IsViewportCell(d)?d:null);if(!a.oldIndent)a.oldIndent=a.style.textIndent;a.style.textIndent=""}else{i=a.onactivate;backupEvent2=c.onactivate;a.onactivate=null;c.onactivate=null}if(f){if($$.utils.getDocActiveElement()==a){document.body.focus();if($$.utils.getDocActiveElement()!=document.body)try{document.documentElement.focus()}catch(o){$$.DEBUG&&$$.DEBUG.Log(ex,"SetImeMode")}}}else a.blur();a.focus();if(f){a.style.textIndent=a.oldIndent;if($$.utils.getDocActiveElement()!=a){var m=function(b,a){return function(){a.focus();b.attachOnActiveEvents()}};setTimeout(m(g,a),0)}else g.attachOnActiveEvents()}else{a.onactivate=i;c.onactivate=backupEvent2}}}};FpSpreadJS.prototype._checkIgnore=function(b){if(!$$.browser.mozilla){var c=$$.utils.getDocActiveElement();if((window.parent==window||document.readyState=="complete")&&c!=null&&this.spread.getEditor(b)==c)return true;if($$.browser.ie){var a=this.spread.getEditor(b);if(a!=null&&(a.getAttribute("Extenders")!=null||a.getAttribute("FpEditor")=="MultiColumnComboBoxCellType"))return true}}return false};FpSpreadJS.prototype.isReadOnly=function(a){return a.getAttribute("FpCellType")=="readonly"||a.getAttribute("locked")=="true"||this.spread.isHeaderCell(a)};FpSpreadJS.prototype.setCellLocked=function(a,e,i){if(this._isLockCell(a)==i)return false;var b=a.GetCellType();if(i)if(b=="ButtonCellType"||b=="TagCloudCellType"||b=="HyperLinkCellType"){a.setAttribute("locked","1");if(b=="ButtonCellType"&&a.firstChild!=null)a.firstChild.setAttribute("disabled","disabled");else if(b=="HyperLinkCellType"||b=="TagCloudCellType"){var h=b=="TagCloudCellType";if(h)a.firstChild.disabled="disabled";for(var f=a.getElementsByTagName("a"),c=0;c<f.length;c++){f[c].setAttribute("disabled","disabled");this._backupProperties(f[c],"href");f[c].setAttribute("onclick","javascript:return false;")}}}else{a.setAttribute("locked","true");a.setAttribute("CellType",e);a.setAttribute("FpCellType","readonly");if(e=="ComboBoxCellType")this._disableAllChild(a,"select");else if(e=="ExtenderCellType"||e=="MultiColumnComboBoxCellType"){a.firstChild!=null&&a.firstChild.tagName!=null&&a.firstChild.tagName.toUpperCase()=="DIV"&&a.firstChild.setAttribute("disabled","disabled");var g=a.getAttribute("CellType2");if(g=="RatingCellType")this._disableRating(a);else if(g=="SliderCellType")this._disableSlider(a.firstChild.id);else{this._disableAllChild(a,"input");this._disableAllChild(a,"button")}}else if(e=="RadioButtonListCellType"||e=="text"||e=="CheckBoxCellType"||e=="TextCellType"){this._disableAllChild(a,"input");this._disableAllChild(a,"table");this._disableAllChild(a,"textarea")}}else{if(this.spread.getTopSpread().getAttribute("allowUnlock")==null)return false;a.removeAttribute("locked");b!="LabelCellType"&&a.getAttribute("FpCellType")=="readonly"&&a.removeAttribute("FpCellType");if(b=="ButtonCellType"||b=="TagCloudCellType"||b=="HyperLinkCellType"){if(b=="ButtonCellType"&&a.firstChild!=null)a.firstChild.removeAttribute("disabled");else if(b=="HyperLinkCellType"||b=="TagCloudCellType"){var h=b=="TagCloudCellType";h&&a.firstChild.removeAttribute("disabled");for(var f=a.getElementsByTagName("a"),c=0;c<f.length;c++){f[c].removeAttribute("disabled");this._restoreProperties(f[c],"href");f[c].setAttribute("onclick",null)}}}else{var d=a.getAttribute("CellType");d!=null&&a.setAttribute("FpCellType",d);if(d=="ComboBoxCellType")this._enableAllChild(a,"select");else if(d=="ExtenderCellType"||d=="MultiColumnComboBoxCellType"){a.firstChild!=null&&a.firstChild.tagName!=null&&a.firstChild.tagName.toUpperCase()=="DIV"&&a.firstChild.removeAttribute("disabled");var g=a.getAttribute("CellType2");if(g=="RatingCellType")this._enableRating(a);else if(g=="SliderCellType")this._enableSlider(a.firstChild.id);else{(g=="MutuallyExclusiveCheckBoxCellType"||g=="AjaxComboBoxCellType")&&this._enableAllChild(a,"div");this._enableAllChild(a,"input");this._enableAllChild(a,"button")}}else if(d=="RadioButtonListCellType"||d=="text"||d=="CheckBoxCellType"||d=="TextCellType"){this._enableAllChild(a,"input");this._enableAllChild(a,"span");this._enableAllChild(a,"table");this._enableAllChild(a,"textarea")}}}return true};FpSpreadJS.prototype._disableSlider=function(b){var a=$find(b+"_SliderExtender");if(a!=null){$clearHandlers(a._handle);$clearHandlers(a._railElement)}};FpSpreadJS.prototype._enableSlider=function(b){var a=$find(b+"_SliderExtender");if(a!=null){$addHandlers(a._handle,{mousedown:a._onMouseDown,dragstart:a._IEDragDropHandler,drag:a._IEDragDropHandler,dragend:a._IEDragDropHandler},a);$addHandlers(a._railElement,{click:a._onRailClick},a)}};FpSpreadJS.prototype._enableRating=function(b){var a=$find(b.firstChild.id+"_input_RatingExtender");a!=null&&a.set_ReadOnly(false)};FpSpreadJS.prototype._disableRating=function(c){var b=c.firstChild,a=$find(b.id+"_input_RatingExtender");a!=null&&a.set_ReadOnly(true)};FpSpreadJS.prototype._disableAllChild=function(e,d){for(var b=e.getElementsByTagName(d),a=0;a<b.length;a++){var c=b[a].getAttribute("disabled");c!=null&&c.toString()!=""&&b[a].setAttribute("bkdisabled",c);b[a].setAttribute("disabled","disabled")}};FpSpreadJS.prototype._enableAllChild=function(e,d){for(var b=e.getElementsByTagName(d),a=0;a<b.length;a++){var c=b[a].getAttribute("bkdisabled");if(c!=null){b[a].setAttribute("disabled",c);b[a].removeAttribute("bkdisabled")}else b[a].removeAttribute("disabled")}};FpSpreadJS.prototype._backupProperties=function(b,a){var c=b.getAttribute(a);c!=null&&b.setAttribute("bk"+a,c);b.removeAttribute(a,"")};FpSpreadJS.prototype._restoreProperties=function(b,a){var c=b.getAttribute("bk"+a);c!=null&&b.setAttribute(a,c);b.removeAttribute("bk"+a)};FpSpreadJS.prototype._isLockCell=function(a){return a.getAttribute("locked")=="1"||a.getAttribute("locked")=="true"};FpSpreadJS.prototype._getViewPort=function(e,b,f,c,d){var a=null;if($$.browser.webkit)a=e;else if(r<d)if(b!=null&&r>=0&&r<b.rows.length)a=b;else a=f;else{r-=d;if(c!=null&&r>=0&&r<c.rows.length)a=c;else a=e}return a};FpSpreadJS.prototype.setHiddenValue=function(h,b,c,g,l,i,j,k,f){if(b==null)return-1;r=this.getDisplayIndex(h);var d=this._getViewPort(l,i,j,k,f);if(d!=null&&r>=0&&r<d.rows.length){var e=d.rows[r];for(var a in c)if(c[a]==b||c[a]==b.toUpperCase()){if(e.getAttribute("previewRow")=="true")return-1;e.setAttribute(a,g);return parseInt(a.substr(2,a.length-2),10)}}return-1};FpSpreadJS.prototype.getHiddenValue=function(g,b,e,f,h,i,j,d){if(b==null)return;r=this.getDisplayIndex(g);var a=null;v2=null;if($$.browser.webkit)a=f;else if(r<d){a=h;v2=i}else{r-=d;a=j;v2=f}var c=this._getHiddenValueFromViewPort(r,b,a,e);if(c==null)c=this._getHiddenValueFromViewPort(r,b,v2,e);return c};FpSpreadJS.prototype._getHiddenValueFromViewPort=function(d,e,b,a){if(b!=null&&d>=0&&d<b.rows.length){var f=b.rows[d];for(var c in a)if(a[c]==e||a[c]==e.toUpperCase())return f.getAttribute(c)}return null};FpSpreadJS.prototype.initHiddenColumns=function(e){for(var b=[],d=0,c=e.attributes.length-1;c>=0;c--){var a=e.attributes[c];if(a.name.length>2&&a.name.charAt(0).toUpperCase()=="C"&&a.name.charAt(1)=="_"){b[a.name]=a.value;d++}}b.count_of_hidden_cols=d;return b};FpSpreadJS.prototype.getNumOfHiddenColumn=function(a){return a==null?0:a.count_of_hidden_cols};FpSpreadJS.prototype.getValueOfHiddenCell=function(e,d,b){if(e&&d!=null){var c=b.selectSingleNode("hiddenCells"),a=c!=null?b.firstChild(c):null;while(a!=null){if(e.toLowerCase()==a.getAttribute("rn").toLowerCase()&&d.toLowerCase()==a.getAttribute("cn").toLowerCase())return a.getAttribute("v");a=b.nextSibling(a)}}return null};FpSpreadJS.prototype.setValueOfHiddenCell=function(c,f,g,d,b){if((c||b)&&f!=null){var e=d.selectSingleNode("hiddenCells"),a=e!=null?d.firstChild(e):null;while(a!=null){if((c&&c.toLowerCase()==a.getAttribute("rn").toLowerCase()||b&&b==a.getAttribute("r"))&&f.toLowerCase()==a.getAttribute("cn").toLowerCase()){a.setAttribute("v",g);return{r:a.getAttribute("r"),c:a.getAttribute("c")}}a=d.nextSibling(a)}}return null};FpSpreadJS.prototype.removeHiddenCellsInfo=function(a){var b=a.indexOf("%253ChiddenCells%253E");if(b<0)return a;var c=a.indexOf("%253C%252FhiddenCells%253E");return a.substring(0,b)+a.substring(c+26)};FpSpreadJS.prototype.loadScriptResources=function(b){var e=this.spread.getXmlDataObject(),a=e.selectSingleNode("scripts");if(a==null||a.childNodes.length==0){b();return}for(var g=a.childNodes.length,c=[],d=g-1;d>=0;d--){var f=e.textContent(a.childNodes[d]);!FarPoint.System.ExtenderHelper.checkInclude(f)&&c.push({Type:"resource",Url:f})}if(c.length==0){b();return}this.appendScripts(c,b,true)};FpSpreadJS.prototype.appendScripts=function(e,d,p){if(e==null||e.length==0)return;for(var a=[],b=[],c=null,j=0;j<e.length;j++){var h=e[j];if(h.Type=="resource"){var g=document.createElement("SCRIPT");g.type="text/javascript";g.src=h.Url;a.push(g)}else b.push(h.Content)}if(b.length>0&&$$.browser.ie&&$$.browser.version<10){if(d!=null){var o=this.spread.id,i=document.getElementById(o);if(i.appendScriptsCallbacks==null)i.appendScriptsCallbacks=[];i.appendScriptsCallbacks.push(d);b.push("(function(){  var ss = document.getElementById('"+o+"');  var cbs = ss.appendScriptsCallbacks;  if(cbs != null && cbs.length > 0) {    var cb = cbs.pop();    cb();  }})();")}var n=document.createElement("DIV");n.style.display="none";c=n}var m=a.length;function f(b){if(!b)b=window.event;var a=b.srcElement||b.target;if(a.readyState!=null&&a.readyState!="loaded"&&a.readyState!="complete")return;a.removeEventListener&&a.removeEventListener("load",f,false);if(a.onreadystatechange)a.onreadystatechange=null;m--;if(m==0)l();else k()}function k(){var b=null;if(p)b=a.pop();else{b=a[0];a.splice(0,1)}if(b.addEventListener)b.addEventListener("load",f,false);else b.onreadystatechange=f;document.body.appendChild(b)}function l(){if(c!=null){document.body.appendChild(c);c.innerHTML="&nbsp;<SCRIPT DEFER>"+b.join("")+"</SCRIPT>"}else{if(b.length>0)try{var a=b.join("");if(window.execScript)window.execScript(a);else eval.call(window,a)}catch(e){}d&&d()}}if(a.length>0)k();else l()};FpSpreadJS.OverrideAutoFocus=function(){if(FpSpreadJS._autoFocusOverrided)return;if(typeof WebForm_AutoFocus=="function"){FpSpreadJS.originalWebForm_AutoFocus=WebForm_AutoFocus;WebForm_AutoFocus=function(b){var a=document.getElementById(b);if(a!=null&&(a.getAttribute("FpSpread")||a.FpSpread)=="Spread"&&document.getElementById(a.id+"_data")!=null&&a.focus){($$.browser.ieversion>9||!$$.browser.ie)&&$$.j(document).ready(function(){$$.browser.webkit&&$$.utils.isElementHidden(a,document.body,true)&&a.scrollIntoView();a.focus(null,null,{RaiseActivateEvent:true,SynchronizeScroll:true})});return}FpSpreadJS.originalWebForm_AutoFocus.call(window,b)};FpSpreadJS._autoFocusOverrided=true}};function mvcSpread(a){this.element=a;this.inMvcFramework()&&this._createDefaultHiddenFields()}mvcSpread.MVC_SPREAD_VIRTUAL_FILENAME="__GrapeCityMvcSpreadPage__.aspx";mvcSpread.prototype={inMvcFramework:function(){if(this.element.__inMvcFramework==null)this.element.__inMvcFramework=this.element.getAttribute("framework")=="mvc";return this.element.__inMvcFramework},doPrint:function(n,r,k){var a=this.getForm();if(a==null)return;var j=this.element;if(a.SpreadHiddenFields==null){var b=document.createElement("DIV");b.style.position="absolute";b.style.width="0px";b.style.height="0px";b.style.left="-100px";b.style.top="-100px";b.id="SpreadHiddenFields";b.name="SpreadHiddenFields";a.appendChild(b);a.SpreadHiddenFields=b}var h=a.SpreadHiddenFields,d=a.__VIEWSTATE;if(d==null){d=this.createHiddenField("__VIEWSTATE");h.appendChild(d)}var m=d.value,e=j.getAttribute("TopSpread");if(e==null||e.length==0)e=j.id;var g=document.getElementById(e+"__VIEWSTATE");if(g!=null){d.value=g.value;g.value=""}var c=a.__EVENTVALIDATION;if(c==null){c=this.createHiddenField("__EVENTVALIDATION");h.appendChild(c)}var l=c.value,f=document.getElementById(e+"__EVENTVALIDATION");if(f!=null){c.value=f.value;f.value=""}var i=a.__FPSPREAD;if(i==null){i=this.createHiddenField("__FPSPREAD");h.appendChild(i)}i.value=e;a.__EVENTTARGET.value=n;a.__EVENTARGUMENT.value=r;var p=a.target,o=a.action,q=this._defaultSpreadMvcPage();a.action=q;if(k!=null)a.target=k;a.submit();a.target=p;a.action=o;a.__EVENTARGUMENT.value="";a.__EVENTARGUMENT.value="";if(d!=null&&g!=null){g.value=d.value;d.value=m}if(c!=null&&f!=null){f.value=c.value;c.value=l}a.__FPSPREAD.value="";if(h!=null)h.innerHTML=""},getForm:function(){var a=this.element.parentNode;while(a!=null&&a.tagName!="FORM")a=a.parentNode;return a},createHiddenField:function(c,b){var a=document.createElement("INPUT");a.type="hidden";a.id=c;a.name=c;if(b!=null)a.value=b;return a},_createDefaultHiddenFields:function(){var a=this.getForm();if(a!=null){if(a.__EVENTTARGET==null){var b=this.createHiddenField("__EVENTTARGET","");a.appendChild(b);if(a.__EVENTTARGET==null)a.__EVENTTARGET=b}if(a.__EVENTARGUMENT==null){var b=this.createHiddenField("__EVENTARGUMENT","");a.appendChild(b);if(a.__EVENTARGUMENT==null)a.__EVENTARGUMENT=b}}},_defaultSpreadMvcPage:function(){var b=this.element,a=null,d=b.getAttribute("TopSpread");if(d!=null&&d.length>0)a=document.getElementById(d);else if(b.getTopSpread)a=b.getTopSpread();else a=b;if(a!=null){var c=a.getAttribute("AppRootPath");if(c!=null&&c!="")return"/"+c+"/"+mvcSpread.MVC_SPREAD_VIRTUAL_FILENAME}return"/"+mvcSpread.MVC_SPREAD_VIRTUAL_FILENAME},_initPrintSpread:function(){if(document.printSpread==null)if($$.browser.mozilla){var a=document.createElement("IFRAME");a.name="printSpread";a.style.position="absolute";a.style.left="-10px";a.style.width="0px";a.style.height="0px";document.body.insertBefore(a,null);if(document.printSpread==null)document.printSpread=a;document.printSpread.addEventListener("load",function(){mvcSpread._startPrintSpread()},false);a.src="scid=dummy.htm"}else document.body.insertAdjacentHTML("beforeEnd","<iframe onload='javascript:mvcSpread._startPrintSpread();' name=printSpread style='position:absolute;left:-10px;' width=0 height=0 src='scid=dummy.htm'></iframe>")}};mvcSpread._startPrintSpread=function(){var b=document.printSpread;if(b==null)return;var a=document.activeElement;if($$.browser.mozilla){document.printSpread.contentWindow.focus();document.printSpread.contentWindow.print();window.focus()}else{document.printSpread.focus();document.printSpread.print()}if($$.browser.ie)a&&!a.disabled&&a.focus();else window.focus()};mvcSpread.__doPostBack=function(d,c){var g=d.replace(/\$/g,"_"),a=document.getElementById(g);if(a==null)return;while(!a.getAttribute||a.getAttribute("name")==null)a=a.nextSibling;var e=new mvcSpread(a);e._createDefaultHiddenFields();if(c=="PrintPDF"){if(typeof mvcSpread=="undefined")return false;var f=null;e.doPrint(d,c,f);return true}var b=e.getForm();if(b!=null&&(!b.onsubmit||b.onsubmit()!=false)){b.__EVENTTARGET.value=d;b.__EVENTARGUMENT.value=c;b.submit()}};function ClientSparklinesController(a){this.element=a;this.updateSparkline=function(d,c,a){if(a!=null&&a.length>0){var b=this.element.GetCellByRowCol(d,c);if(b!=null)b.style.backgroundImage="url('"+a+"')"}}}(function(c){var b=c.document;$$.__cssReferences=c.__spreadCssReferences||[];$$.__existedCssReferences;$$.RegisterCssReference=function(a){var c=!$$.j.isArray(a)?[a]:a,b=$$.__cssReferences;$$.j.each(c,function(c,a){$$.j.inArray(a,b)==-1&&b.push(a)})};var a={None:"None",Loading:"Loading",Loaded:"Loaded"};function h(d,e,f,c,b){this.Type=d;this.Key=e;this.Url=f;this.State=a.None;this.ScriptLoadedCallback=c;this.ExistenceConstrain=b}function f(){this.scripts=[];this.checkScriptExist=true;this.notReadyCount=0;this.readyHandlers=[];this.loadedHandlers=[];this.cachedScripts=[]}f.prototype={ATTRIBUTE_STATE:"__state",GetScripts:function(){return this.scripts},Clear:function(){this.scripts=[];this.notReadyCount=0;this.readyHandlers=[];this.loadedHandlers=[];this.cachedScripts=[]},RegisterScript:function(a,b){if(a==null)return;if(!this.IsScriptRegistered(a.Type,a.Key)){var c=this.scripts.push(a);this.notReadyCount++;b&&this._AppendScript(a);return c}return-1},UnRegisterScript:function(b,c){for(var a=this.scripts.length-1;a>=0;a--)if(this.scripts[a].Type==b&&this.scripts[a].Key==c){this.scripts.splice(a,1);return this.scripts.length}return-1},IsScriptRegistered:function(b,c){for(var a=0;a<this.scripts.length;a++)if(this.scripts[a].Type==b&&this.scripts[a].Key==c)return true;return false},IsScriptLoaded:function(c,d){for(var b=0;b<this.scripts.length;b++)if(this.scripts[b].Type==c&&this.scripts[b].Key==d&&this.scripts[b].State==a.Loaded)return true;return false},IsReady:function(){return this.notReadyCount==0},NotifyScriptLoad:function(d,e,c){if(d==null)return;if(this.IsScriptLoaded(d,e)){c&&c();return}var b=this.GetScript(d,e);if(b!=null){this.loadedHandlers.push({Script:b,Handler:c});if(b.State==a.Loading)return;this._AppendScript(b)}},NotifyAllScriptLoad:function(b){if(this.IsReady()){b&&b();return true}if(this.scripts.length==0){b();return true}else this.readyHandlers.push(b);for(var c=0;c<this.scripts.length;c++){var d=this.scripts[c];d.State==a.None&&this._AppendScript(d)}return false},GetScript:function(b,c){if(b==null)return null;for(var a=0;a<this.scripts.length;a++)if(this.scripts[a].Type==b&&this.scripts[a].Key==c)return this.scripts[a];return null},_AppendScript:function(c,h){if(c==null||c.Url==null){throw"Invalid script descriptor!";return}var f=function(f){var d=f.target||f.srcElement;if($$.browser.ie&&$$.browser.version<11&&d.readyState!="complete"&&d.readyState!="loaded")return;d.setAttribute(this.ATTRIBUTE_STATE,a.Loaded);c.State=a.Loaded;if(this.notReadyCount>0){this.notReadyCount--;this.notReadyCount==0&&this._InvokeReadyHandlers()}if(c.ScriptLoadedCallback!=null){var g=c.ScriptLoadedCallback;try{g()}catch(i){}}h&&h();var b=0;while(this.loadedHandlers.length>0&&b<this.loadedHandlers.length){var e=this.loadedHandlers[b];if(e.Script==c){var g=e.Handler;try{g()}catch(i){}this.loadedHandlers.splice(b,1);continue}b++}},g=null;if(this.checkScriptExist&&(g=this.IsExist(c.Url))!=null){var i=this._GetScriptState(g);if(i==a.Loaded&&(!c.ExistenceConstrain||c.ExistenceConstrain()))f.call(this,{target:g});else $$.utils.attachEvent("load",Function.CreateDelegate(this,f),false);return}var d=b.createElement("SCRIPT");d.type="text/javascript";d.src=c.Url;d.async=false;if("onload"in d)$$.utils.attachEvent(d,"load",Function.CreateDelegate(this,f),false);else"onreadystatechange"in d&&$$.utils.attachEvent(d,"readystatechange",Function.CreateDelegate(this,f),false);var e=b.head||(e=b.getElementsByTagName("HEAD")).length>0&&e[0];if(e==null){e=b.createElement("HEAD");b.insertBefore(e,b.body)}d.setAttribute(this.ATTRIBUTE_STATE,a.Loading);c.State=a.Loading;e.appendChild(d)},_InvokeReadyHandlers:function(){for(var a=this.readyHandlers.length-1;a>=0;a--){var b=this.readyHandlers[a];try{b();this.readyHandlers.splice(a,1)}catch(c){}}},IsExist:function(e){for(var a=0;a<this.cachedScripts.length;a++)if(e==this.cachedScripts[a].src)return this.cachedScripts[a];for(var f=e.toLowerCase(),d=b.getElementsByTagName("SCRIPT"),a=0;a<d.length;a++){var c=d[a];if(c.src&&c.src.toLowerCase()==f){this.cachedScripts.push(c);return c}}return null},_GetScriptState:function(b){return b?b.readyState=="complete"||b.getAttribute(this.ATTRIBUTE_STATE)==a.Loaded?a.Loaded:a.Loading:a.None},_Unload:function(f,g){for(var e=0,a=0;a<this.scripts.length;a++)if(this.scripts[a].Type==f&&this.scripts[a].Key==g)for(var d=b.getElementsByTagName("SCRIPT"),c=0;c<d.length;c++)if(d[c].src==this.scripts[a].Url){d[c].parentNode.removeChild(d[c]);e++}return e}};function d(a){if($$.j&&$$.j.fn&&($$.j.fn.version||$$.j.fn.jquery))return true;var d="FarPoint.Web.Spread.FpSpread",f="FpSreadJQuery";if(c.$&&g())$$.j=c.$;else{$$.j=e.createInstance();if($$.j==null){var b=$$.browser.ie&&$$.browser.version<11?"1x":"2x";$$.ScriptManager.NotifyScriptLoad(d,f+b,function(){$$.j=e.createInstance();a()});return false}}return true}function g(){var a=$$.browser.ie&&$$.browser.version<11?{Marjor:1,Minor:9}:{Marjor:2,Minor:0},c=$.fn.version||$.fn.jquery;if(c==null||c.length=="")return false;var b=c.split(".");if(b.length>1){var d=parseInt(b[0]),e=parseInt(b[1]);return isNaN(d)||isNaN(e)?false:d>a.Marjor||d==a.Marjor&&e>=a.Minor}return false}var e={createInstance:function(){return!$$.browser.ie||$$.browser.version>10?$$.jQuery2x||c.$spreadjQuery2x:$$.jQuery1x||c.$spreadjQuery1x}};$$.ScriptState=a;$$.ScriptDescriptor=h;$$.ScriptManager=new f;$$.JQueryBootstrap=d;d()})(window)