//
//	  Copyright (C) 2003-2014 GrapeCity Inc.	All rights reserved.
//

if(typeof GrapeCity=="undefined")GrapeCity={};if(!GrapeCity.Web)GrapeCity.Web={};if(!GrapeCity.Web.Spread)GrapeCity.Web.Spread={};GrapeCity.Web.Spread.Dialog=function(c,d,f){this.HostSpread=null;if(arguments.length==0)return;this.__quirksMode=$$.browser.ie&&$$.browser.version<10&&$$.browser.quirksMode;if(typeof d=="string")d=document.getElementById(d);this.DialogContent=d;if(!f)f=this.DialogContent.getAttribute("caption");var j=.3;if(!c){c=document.body;j=.001}this.Control=c;var b=document.getElementById(c.id+"_mask");if(b==null){b=document.createElement("DIV");b.id=c.id+"_mask";b.style.outline="none";b.style.position="absolute";b.style.display="none";b.style.backgroundColor="#000000";b.style.opacity=j;b.style.filter='alpha(opacity="'+j*100+'")';b.className="SpreadMaskDialog";if(c==document.body||c.getAttribute("inDesign")!="true")document.body.appendChild(b);else c.parentNode.appendChild(b);$$.utils.attachEvent(b,"mousedown",function(a){a=a||window.event;return $$.utils.cancelBubble(a)});$$.utils.attachEvent(b,"dblclick",function(a){a=a||window.event;return $$.utils.cancelBubble(a)})}this.Mask=b;var n=GcResources.GetCulture(c),h=GcResources[n].Common,a=document.createElement("DIV");a.className="SpreadDialog";a.innerHTML='<div class="DialogCaption" '+(this.__quirksMode?'style="float:left"':"")+($$.browser.webkit?' tabIndex="-1" ':"")+'><span></span><a title="'+h.Close+'" class="Close"></a></div><div class="Window"><div align="right" style="margin-top: 3px;overflow:hidden"><input tabIndex="1000" type="button" value="'+h.OK+'" style="margin-right: 3px;width:75px;" class="Button"/><input tabIndex="1000" type="button" value="'+h.Cancel+'" style="width:75px;" class="Button"/></div></div>';if(c==document.body||c.getAttribute("inDesign")!="true")document.body.appendChild(a);else c.parentNode.appendChild(a);this.Dialog=a;var g=this.Dialog.childNodes[1];g.insertBefore(d,g.firstChild);a.id=d.id+"_TopDiv";a.tabIndex=-1;a.style.top="-1000px";a.style.left="-1000px";d.style.display="";c.getAttribute("FpSpread")=="Spread"&&a.setAttribute("HostSpreadID",c.id);var i=this.Dialog.firstChild;if($$.browser.ie&&$$.browser.version<=7){var e=g.currentStyle,r=parseInt(e.paddingLeft)+parseInt(e.paddingRight)+parseInt(e.marginLeft)+parseInt(e.marginRight)+$$(a).getBorderWidth();a.style.width=d.offsetWidth+r+"px";var s=parseInt(e.paddingTop)+parseInt(e.paddingBottom)+parseInt(e.marginTop)+parseInt(e.marginBottom)+$$(a).getBorderHeight()}a.style.zIndex=999997;b.style.zIndex=999996;a.style.display="none";a.Behavior=this;var k=Function.CreateDelegate(this,this.OnClose),m=Function.CreateDelegate(this,this.OnAccept),l=g.lastChild,q=l.firstChild,o=l.lastChild;$$.utils.attachEvent(q,"click",m);$$.utils.attachEvent(o,"click",k);if(f!=null&&f.length>0)i.firstChild.innerHTML=f;i.ondragstart=function(){return false};var p=i.childNodes[1];$$.utils.attachEvent(p,"click",k)};GrapeCity.Web.Spread.Dialog.prototype={ShowMask:function(c){var b=this.Control,a=this.Mask;a.style.width=b.offsetWidth+"px";a.style.height=b.offsetHeight+"px";this._SetMaskLocation();if(c){if(!a._setMaskLocation)a._setMaskLocation=Function.CreateDelegate(this,this._SetMaskLocation);$$.utils.attachEvent(window,"scroll",a._setMaskLocation);a.style.display="block"}},_SetMaskLocation:function(){var e=this.Control,a=this.Mask,c=document.documentElement.scrollLeft||document.body.scrollLeft,d=document.documentElement.scrollTop||document.body.scrollTop,b=e.getBoundingClientRect();a.style.left=c+b.left+"px";a.style.top=d+b.top+"px"},Show:function(e,f){e=e||0;f=f||0;var g=this.Dialog.firstChild;this._OnCaptionMouseDownDelegate=Function.CreateDelegate(this,this.OnCaptionMouseDown);$$.utils.attachEvent(g,"mousedown",this._OnCaptionMouseDownDelegate);$$.browser.isTouchEventModel&&$$.utils.attachEvent(g,$$.TouchEvents.TouchStart,this._OnCaptionMouseDownDelegate);this._OnDocumentKeyDownDelegate=Function.CreateDelegate(this,this.OnDocumentKeyDown);$$.utils.attachEvent(document,"keydown",this._OnDocumentKeyDownDelegate);var i=this.Control;this.ShowMask(true);var c=this.Dialog;c.style.opacity=0;c.style.display="block";var b=e.toString(),d=b.length;if(b.charAt(d-1)=="%"){var h=parseInt(b.substr(0,d-1));e=Math.round((window.innerWidth-c.offsetWidth)*h/100)}b=f.toString(),d=b.length;if(b.charAt(d-1)=="%"){var h=parseInt(b.substr(0,d-1));f=Math.round((window.innerHeight-c.offsetHeight)*h/100)}c.style.top=f+"px";c.style.left=e+"px";this.isShowing=true;if(i.getAttribute("FpSpread")=="Spread"){var a=i.getSpreadView();if(a!=null){a=a.GetTopSpreadView();a.ActiveDialog=this;!a.IsTrackingLocation()&&a.StartTrackingLocation(500)}}if($$.browser.webkit){var a=typeof this.Control.getSpreadView=="function"?this.Control.getSpreadView().GetTopSpreadView():null;this.safariMaskScrollShield=FarPoint.Web.Spread.SafariPatch.FixUnderLayerScroll(a?a.Spread:this.Dialog,a?a.Spread:null);this.safariScrollShield=FarPoint.Web.Spread.SafariPatch.FixUnderLayerScroll(this.Dialog,null,"dialogPreventScrollLayer")}var j=new GrapeCity.Web.Effects.Fade(this.Dialog,0,1,250,Function.CreateDelegate(this,function(){this.Focus()}));j.Apply()},Hide:function(){if($$.browser.webkit){if(this.safariScrollShield&&this.safariScrollShield.parentNode){this.safariScrollShield.parentNode.removeChild(this.safariScrollShield);this.safariScrollShield=null}if(this.safariMaskScrollShield&&this.safariMaskScrollShield.parentNode){this.safariMaskScrollShield.parentNode.removeChild(this.safariMaskScrollShield);this.safariMaskScrollShield=null}}var c=this.Control;if(c.getAttribute("FpSpread")=="Spread"){var a=c.getSpreadView();if(a!=null){a=a.GetTopSpreadView();a.ActiveDialog=null;!a.RequireTrackingLocation()&&a.StopTrackingLocation()}}if($$.browser.webkit){var d=this.DialogContent,b=this.HostSpread;setTimeout(function(){var a=window.document.activeElement;if($$.utils.contains(d,a)&&$$.utils.isTextControl(a)&&b&&b.getSpreadView().IsSpreadActive()){a.blur();b.getSpreadContext().setTextBoxFocus()}},200)}this.isShowing=false;this.Dialog.style.display="none";this.Mask.style.display="none";this.HostSpread=null;this.Dispose(true)},Dispose:function(b){if(this.Control!=null){if(this.Mask._setMaskLocation){$$.utils.detachEvent(window,"scroll",this.Mask._setMaskLocation);this.Mask._setMaskLocation=null}this.OnCaptionMouseUp();var a=this.Dialog.firstChild;$$.utils.detachEvent(a,"mousedown",this._OnCaptionMouseDownDelegate);$$.utils.detachEvent(a,$$.TouchEvents.TouchStart,this._OnCaptionMouseDownDelegate);$$.utils.detachEvent(document,"keydown",this._OnDocumentKeyDownDelegate);this._OnCaptionMouseDownDelegate=null;this._OnDocumentKeyDownDelegate=null;if(!b){this.Dialog.Behavior=null;this.Control=null}}},SetCaption:function(a){var b=this.Dialog.firstChild;b.firstChild.innerHTML=a},_HideInternal:function(){this._HideWithAnimation();if(this._closeCallback){this._closeCallback(this);this._closeCallback=null}},OnClose:function(){this._HideInternal()},OnAccept:function(){this._HideInternal()},_HideWithAnimation:function(){this.isShowing=false;var a=new GrapeCity.Web.Effects.Fade(this.Dialog,1,0,250,Function.CreateDelegate(this,function(){this.Hide();this.Dialog.style.opacity=""}));a.Apply()},OnCaptionMouseDown:function(a){a=a||window.event;var b=$$.utils.isTouchEvent(a);if(b){var d=$$.j(this.Dialog).find("A.Close");if(d.get(0)==a.target)return;$$.utils.FixPositionProperties(a);$$.j(this.Dialog).find("DIV.DialogCaption").get(0).focus()}var c=a.target||a.srcElement;if(c.nodeType==3)c=c.parentNode;var e=b?true:a.which?a.which==1:a.button==0||a.button==1&&window.event;if(e){this._screenX=a.screenX;this._screenY=a.screenY;if(!this._OnDocumentMouseMoveDelegate)this._OnDocumentMouseMoveDelegate=Function.CreateDelegate(this,this.OnDocumentMouseMove);if(!this._OnDocumentMouseUpDelegate)this._OnDocumentMouseUpDelegate=Function.CreateDelegate(this,this.OnCaptionMouseUp);$$.utils.attachEvent(document,b?$$.TouchEvents.TouchMove:"mousemove",this._OnDocumentMouseMoveDelegate);$$.utils.attachEvent(document,b?$$.TouchEvents.TouchEnd:"mouseup",this._OnDocumentMouseUpDelegate)}},OnDocumentMouseMove:function(a){if(!a)a=window.event;if($$.utils.isTouchEvent(a)){$$.utils.FixPositionProperties(a);$$.utils.cancelBubble(a,true)}var b=this.Dialog,d=a.screenX-this._screenX,e=a.screenY-this._screenY;if(d!=0||e!=0){this._screenX=a.screenX;this._screenY=a.screenY;b.style.left=parseInt(b.style.left)+d+"px";b.style.top=parseInt(b.style.top)+e+"px";if(this.safariScrollShield){var c=b.getBoundingClientRect();$$(this.safariScrollShield).moveToPosition(c.left,c.top)}}$$.utils.cancelBubble(a)},OnDocumentKeyDown:function(a){if(!a)a=window.event;if(a.cancelBubble)return false;if(this.Control!=null&&this.Control.getAttribute("FpSpread")=="Spread"){var f=this.Control.getSpreadView(),g=f.GetSpreadContext(),e=f.GetHostSpread(a.srcElement||a.target);if(g.getTopSpread(e)!=g.getTopSpread(this.Control))return false;if(e==null)return}switch(a.keyCode){case GCWS.Keys.ESCAPE:this.OnClose();$$.utils.cancelBubble(a);break;case GCWS.Keys.ENTER:this.OnAccept();$$.utils.cancelBubble(a);break;case GCWS.Keys.TAB:if(this.GetProcessTab()){var h=a.target||a.srcElement;if(this._btnCancel==null)for(var d=this.Dialog.getElementsByTagName("INPUT"),c=d.length-1;c>=0;c--)if(d[c].getAttribute("type")=="button"){this._btnCancel=d[c];break}var b=this.GetFirstFocusableControl();if(b==null||b==this._btnCancel)break;if(this._btnCancel==h&&!a.shiftKey){b.focus();return FarPoint.System.CancelDefault(a)}else if(b==h&&a.shiftKey){this._btnCancel.focus();return FarPoint.System.CancelDefault(a)}}}},OnCaptionMouseUp:function(a){$$.utils.detachEvent(document,$$.utils.isTouchEvent(a)?$$.TouchEvents.TouchMove:"mousemove",this._OnDocumentMouseMoveDelegate);$$.utils.detachEvent(document,$$.utils.isTouchEvent(a)?$$.TouchEvents.TouchEnd:"mouseup",this._OnDocumentMouseUpDelegate);$$.utils.cancelBubble(a)},SetCloseCallback:function(a){this._closeCallback=a},GetProcessTab:function(){var a=this.Control!=null?this.Control.getAttribute("ProcessTab"):"false";return a.toLowerCase()=="true"},Focus:function(){if(this.isShowing){var a=this.Dialog.getElementsByTagName("INPUT");okButton=a[a.length-2];okButton.focus()}},GetFirstFocusableControl:function(){if(this._btnCancel==null)for(var b=this.Dialog.getElementsByTagName("INPUT"),a=b.length-1;a>=0;a--)if(b[a].getAttribute("type")=="button"){this._btnCancel=b[a];break}return this._btnCancel!=null?this._btnCancel.previousSibling:null}};GrapeCity.Web.Spread.FilterDialogBase=function(c,a,b){if(arguments.length==0)return;GrapeCity.Web.Spread.Dialog.call(this,c,a,b)};GrapeCity.Web.Spread.FilterDialogBase.prototype=new GrapeCity.Web.Spread.Dialog;GrapeCity.Web.Spread.FilterDialogBase.prototype.constructor=GrapeCity.Web.Spread.FilterDialogBase;GrapeCity.Web.Spread.FilterDialogBase.prototype.OnAccept=function(){GrapeCity.Web.Spread.Dialog.prototype.OnAccept.call(this);if(this._callback){this._callback(this);this._callback=null}};GrapeCity.Web.Spread.FilterDialogBase.prototype.Focus=function(b){if($$.browser.webkit){this.Dialog.focus();return}var a=this.GetFirstFocusableControl(!b);a!=null&&$$(a).focus(true)};GrapeCity.Web.Spread.FilterDialog=function(c){var a=GcResources.GetCulture(c),b=GcResources[a].FilterDialog,d=e(c);this.DialogContent=d;GrapeCity.Web.Spread.Dialog.call(this,c,d,b.Title);function e(){this.__quirksMode=$$.browser.ie&&$$.browser.version<10&&$$.browser.quirksMode;var d=document.getElementById(c.id+"_gcFilterDialog");if(d!=null)return d;d=document.createElement("DIV");d.style.height="145px";d.style.width="600px";d.style.display="none";d.id=c.id+"_gcFilterDialog";d.setAttribute("FpSpread","dialog");var m='<td id="'+d.id+'_tdop1" dir="ltr"></td>',n='<td id="'+d.id+'_tdop2" align="right" dir="ltr"></td>',o=$$.browser.ie&&$$.browser.version<=7,l=a!="ja-JP"?"margin-left:"+(o?"5px;":"10px;"):"",w="<div>"+b.Header+'</div>      <div>        <div style="height:7px"></div>      </div>      <table>        <tr>'+(a!="ja-JP"?m:"")+'          <td dir="ltr">            <div style="padding:0px;width:'+b.Width+"px;"+l+'"><input tabIndex="'+(a=="ja-JP"?"1":"2")+'" id="'+d.id+'_text1" type="text" class="Text" style="padding:0px;'+(this.__quirksMode?"height:22px;":"")+'" /></div>          </td>          <td id="'+d.id+'_tddp1" dir="ltr">          </td>'+(a=="ja-JP"?m:"")+'        </tr>        <tr>          <td colspan="3" style="padding-left: 20px" dir="ltr">            <input tabIndex="4"  type="radio" name="_gcFilterRadio'+c.id+'" id="'+d.id+'_RadioAnd" checked="checked" /><label for="'+d.id+'_RadioAnd" accesskey="a" '+(this.__quirksMode?'style="font-size:8pt;"':"")+">"+b.And+'</label>            <input tabIndex="5" type="radio" name="_gcFilterRadio'+c.id+'" id="'+d.id+'_RadioOr" /><label for="'+d.id+'_RadioOr" accesskey="o" '+(this.__quirksMode?'style="font-size:8pt;"':"")+">"+b.Or+"</label>          </td>        </tr>        <tr>"+(a!="ja-JP"?n:"")+'          <td dir="ltr">            <div style="padding:0px;width:'+b.Width+"px;"+l+'"><input tabIndex="'+(a=="ja-JP"?"6":"7")+'" id="'+d.id+'_text2" type="text" class="Text" style="padding:0px;'+(this.__quirksMode?"height:22px;":"")+'" /></div>          </td>          <td id="'+d.id+'_tddp2" dir="ltr">          </td>'+(a=="ja-JP"?n:"")+"        </tr>      </table>      <div><br/>"+b.Description+"<br/></div>";d.innerHTML=w;document.body.appendChild(d);var t=b.Operators,j=["=","!=",">",">=","<","<=","begin","notbegin","end","notend","contain","notcontain"],f=h(),g=h(),e=d.id;f.id=e+"_op1";f.tabIndex=a=="ja-JP"?3:1;g.id=e+"_op2";g.tabIndex=a=="ja-JP"?8:6;var r=document.getElementById(e+"_tdop1"),s=document.getElementById(e+"_tdop2");r.appendChild(f);s.appendChild(g);if(a=="ja-JP"){var k=(o?15:10)+"px";r.style.paddingLeft=k;s.style.paddingLeft=k}var u=document.getElementById(e+"_tddp1"),v=document.getElementById(e+"_tddp2"),p=i(e+"_text1",a),q=i(e+"_text2",a);p.tabIndex=a=="ja-JP"?2:3;q.tabIndex=a=="ja-JP"?7:8;u.appendChild(p);v.appendChild(q);return d;function h(){var c=document.createElement("SELECT"),a=document.createElement("OPTION");c.options.add(a);for(var b=0;b<j.length;b++){a=document.createElement("OPTION");a.value=j[b];a.text=t[b];c.options.add(a)}return c}function i(d,e){var a=document.createElement("DIV");a.id=d+"_dp";$$(a).appendCssClass("FilterBarDatePicker");a.style.position="relative";if(!$$.browser.ie||$$.browser.version>7)a.style.marginTop="2px";else a.style.top="2px";a.style.height="15px";a.style.width="17px";if(!$$.browser.ie||$$.browser.version>7)a.style.marginLeft="10px";else a.style.left="5px";if($$.browser.mozilla)a.style.display="block";a.title=b.DatePicker;FarPoint.System.AttachEvent(a,"click",function(a){if($$.utils.isRightClick(a))return;var b=a.srcElement||a.target;return GrapeCity.Web.DatePicker.GetDate(b,d,e,c.getSpreadView().IsInTouchMode())});FarPoint.System.AttachEvent(a,"keydown",function(a){if(a.keyCode==GCWS.Keys.SPACE||a.keyCode==GCWS.Keys.ENTER){FarPoint.System.CancelDefault(a);var b=a.srcElement||a.target;return GrapeCity.Web.DatePicker.GetDate(b,d,e,c.getSpreadView().IsInTouchMode())}});return a}}};GrapeCity.Web.Spread.FilterDialog.prototype=new GrapeCity.Web.Spread.FilterDialogBase;GrapeCity.Web.Spread.FilterDialog.prototype.constructor=GrapeCity.Web.Spread.FilterDialog;GrapeCity.Web.Spread.FilterDialog.prototype.OnClose=function(){if(this.Type=="Date"){var a=document.getElementById(this.DialogContent.id+"_text1"),b=document.getElementById(this.DialogContent.id+"_text2");if(a.__isShowingDatePicker||b.__isShowingDatePicker)return}this.SetDateTimeFormat(null,null);GrapeCity.Web.Spread.FilterDialogBase.prototype.OnClose.call(this)};GrapeCity.Web.Spread.FilterDialog.prototype.Show=function(q,r,n,o,f){this._callback=o;this.Type=n;var d=GcResources.GetCulture(this.Control),c=GcResources[d].FilterDialog,b=this.DialogContent.id,g=document.getElementById(b+"_tddp1"),h=document.getElementById(b+"_tddp2"),l=document.getElementById(b+"_text1"),m=document.getElementById(b+"_text2"),i=document.getElementById(b+"_op1"),j=document.getElementById(b+"_op2");if(n=="Date"){for(var a=3;a<7;a++){i.options[a].text=c.DateOperators[a-3];j.options[a].text=c.DateOperators[a-3]}g.style.display="block";h.style.display="block";for(var a=1;a<3;a++)document.getElementById(b+"_text"+a+"_dp").style.visibility="visible";if(d=="ja-JP"||$$.browser.ie&&($$.browser.version==8||$$.browser.ieversion==8)){l.parentNode.style.width=c.Width-($$.browser.version!=7||$$.browser.ieversion!=8?20:22)+"px";m.parentNode.style.width=c.Width-($$.browser.version!=7||$$.browser.ieversion!=8?20:22)+"px"}}else{for(var a=3;a<7;a++){i.options[a].text=c.Operators[a-1];j.options[a].text=c.Operators[a-1]}g.style.display="none";h.style.display="none";for(var a=1;a<3;a++)document.getElementById(b+"_text"+a+"_dp").style.visibility="hidden";if(d=="ja-JP"||$$.browser.ie&&($$.browser.version==8||$$.browser.ieversion==8)){l.parentNode.style.width=c.Width+"px";m.parentNode.style.width=c.Width+"px"}}GrapeCity.Web.Spread.Dialog.prototype.Show.call(this,q,r);for(var k=this.DialogContent.getElementsByTagName("INPUT"),a=0,p=k.length;a<p;a++){var e=k[a];if(e.getAttribute("type")=="text")e.style.width=e.parentNode.offsetWidth+"px"}f&&f(this)};GrapeCity.Web.Spread.FilterDialog.prototype.SetDateTimeFormat=function(b,a){this.formatString=b;this.dateTimeFormat=a;var e=this.DialogContent.id,c=document.getElementById(e+"_text1"),d=document.getElementById(e+"_text2");if(c!=null){c._formatString=b;c._dateTimeFormat=a}if(d!=null){d._formatString=b;d._dateTimeFormat=a}};GrapeCity.Web.Spread.FilterDialog.prototype.SetSelectedOperators=function(h){for(var b=this.DialogContent.id,f=[document.getElementById(b+"_op1"),document.getElementById(b+"_op2")],a=0;a<f.length;a++){var c=h[a],d=f[a];d.selectedIndex=a==0?1:0;if(c==null||c.length==0)continue;for(var e=0;e<d.options.length;e++){var g=d.options[e];if(g.value==c){g.selected=true;break}}}$$(document.getElementById(b+"_text1")).focus(true)};GrapeCity.Web.Spread.FilterDialog.prototype.SetAnd=function(a){document.getElementById(this.DialogContent.id+"_Radio"+(a?"And":"Or")).checked=true};GrapeCity.Web.Spread.FilterDialog.prototype.SetText=function(c){for(var b=this.DialogContent.id,d=[document.getElementById(b+"_text1"),document.getElementById(b+"_text2")],a=0,e=d.length;a<e;a++)d[a].value=c==null?"":c[a]||""};GrapeCity.Web.Spread.FilterDialog.prototype.OnAccept=function(){if(!this.ValidateForm()){var b=GcResources.GetCulture(this.Control),a=GcResources[b].FilterDialog;alert(a.MsgInvalid);return false}GrapeCity.Web.Spread.FilterDialogBase.prototype.OnAccept.call(this);return true};GrapeCity.Web.Spread.FilterDialog.prototype.ValidateForm=function(){return document.getElementById(this.DialogContent.id+"_op1").selectedIndex>0};GrapeCity.Web.Spread.FilterDialog.prototype.GetSelectedCommand=function(){var b=this.DialogContent,a=b.id,c=document.getElementById(a+"_RadioAnd"),f=c.checked,h=document.getElementById(a+"_op1"),i=document.getElementById(a+"_op2"),d=document.getElementById(a+"_text1"),e=document.getElementById(a+"_text2"),g=h.value+"|"+encodeURIComponent(d.value)+"|"+(f?"and":"or")+"|"+i.value+"|"+encodeURIComponent(e.value);return g};GrapeCity.Web.Spread.FilterDialog.prototype.GetFirstFocusableControl=function(a){return a||GcResources.GetCulture(this.Control)=="ja-JP"?document.getElementById(this.DialogContent.id+"_text1"):document.getElementById(this.DialogContent.id+"_op1")};GrapeCity.Web.Spread.FilterColorDialog=function(a){var d=GcResources.GetCulture(a),b=GcResources[d].FilterDialog,c=e();this.DialogContent=c;GrapeCity.Web.Spread.Dialog.call(this,a,c,b.Title);function e(){var c=document.getElementById(a.id+"_gcFilterColorDialog");if(c!=null)return c;c=document.createElement("DIV");c.style.height="160px";c.style.width="276px";c.style.display="none";c.id=a.id+"_gcFilterColorDialog";var d='<div id="'+c.id+'_header"></div>        <div style="height:3px"></div>        <div class="IconBlock"><a id="'+c.id+'_nocolor" style="width: 270px; margin-left:0px;text-decoration:none;height: 18px;" href="#"><div style="height: 16px;margin-top:0px; border: 1px solid rgb(160,160,160);color:#000;text-align:center;"></div></a></div>        <div style="height:2px"></div>        <div class="ColorBlock" style="width: 274px; overflow:auto;background-color:#ffffff; border: 1px solid rgb(130,135,144); positive: relative;">        <div id="'+c.id+'_container" style="width: 256px;">        </div>        </div>        <div style="height:7px"></div>        <div>          <table width="100%">            <tr>              <td><b>'+b.ColorSelected+'</b></td>              <td align="right"><div id="'+c.id+'_selectedColor" style="border: 1px solid rgb(130,135,144); background-color: red; height: 15px; width: 200px;"></div></td>            </tr>          </table>        </div>        <div style="width: 100%; "><hr/></div>        <div style="height:7px"></div>      ';c.innerHTML=d;document.body.appendChild(c);return c}};GrapeCity.Web.Spread.FilterColorDialog.prototype=new GrapeCity.Web.Spread.FilterDialogBase;GrapeCity.Web.Spread.FilterColorDialog.prototype.constructor=GrapeCity.Web.Spread.FilterColorDialog;GrapeCity.Web.Spread.FilterColorDialog.prototype.Show=function(s,t,k,d,j,o){this._callback=o;var p=GcResources.GetCulture(this.Control),c=GcResources[p].FilterDialog;this.SetCaption(k?c.ColorForeTitle:c.ColorTitle);var g=this.DialogContent.id,l=document.getElementById(g+"_header");l.innerHTML=k?c.ColorForeHeader:c.ColorHeader;var h=document.getElementById(g+"_nocolor");h.className="";h.firstChild.innerHTML=k?c.ColorAutomatic:c.ColorNoFill;var b=document.getElementById(g+"_container");b.innerHTML="";this._ColorSelected=Function.CreateDelegate(this,this.OnColorSelected);for(var a=null,f=0,r=d.length;f<r;f++){var e=document.createElement("A"),n=document.createElement("DIV");n.style.backgroundColor=d[f];e.appendChild(n);b.appendChild(e);e._color=d[f];$$.utils.attachEvent(e,"click",this._ColorSelected);if(!a&&j&&j==d[f])a=e}$$.utils.attachEvent(h,"click",this._ColorSelected);if(!a&&j=="")a=h;if(!a)a=b.childNodes[0];a.className="Selected";this._Selected=a;document.getElementById(g+"_selectedColor").style.backgroundColor=a.firstChild.style.backgroundColor;GrapeCity.Web.Spread.Dialog.prototype.Show.call(this,s,t);this.DialogContent.parentNode.style.backgroundColor="#f0f0f0";var q=8,m=Math.min(q,Math.floor((d.length+7)/8)),i=b.parentNode;i.style.height=m*26+"px";if(i.scrollHeight<=i.offsetHeight)b.style.marginLeft=Math.floor((i.offsetWidth-b.offsetWidth)/2)+"px";else b.style.marginLeft="0px";this.DialogContent.style.height=m*26+l.offsetHeight+80+"px"};GrapeCity.Web.Spread.FilterColorDialog.prototype.Hide=function(){GrapeCity.Web.Spread.Dialog.prototype.Hide.call(this);for(var b=this.DialogContent.id,d=document.getElementById(b+"_container"),c=d.getElementsByTagName("A"),a=0;a<c.length;a++)$$.utils.detachEvent(c[a],"click",this._ColorSelected);$$.utils.detachEvent(document.getElementById(b+"_nocolor"),"click",this._ColorSelected)};GrapeCity.Web.Spread.FilterColorDialog.prototype.OnColorSelected=function(b){if(!b)b=window.event;if(this._Selected)this._Selected.className="";var a=b.target||b.srcElement;while(a.tagName.toLowerCase()!="a")a=a.parentNode;a.className="Selected";this._Selected=a;document.getElementById(this.DialogContent.id+"_selectedColor").style.backgroundColor=a._color?a.firstChild.style.backgroundColor:"#ffffff";$$.utils.cancelDefault(b)};GrapeCity.Web.Spread.FilterColorDialog.prototype.GetSelectedColor=function(){return this._Selected?this._Selected._color||"":null};GrapeCity.Web.Spread.FilterColorDialog.prototype.SetNoFill=function(b){var e=this.DialogContent.id,a=document.getElementById(e+"_nocolor").parentNode,c=b?"":"none";if(a.style.display!=c){a.style.display=c;var d=parseInt(this.DialogContent.style.height);if(b)this.DialogContent.style.height=d+30+"px";else this.DialogContent.style.height=d-30+"px"}};GrapeCity.Web.Spread.FilterIconDialog=function(b){var d=GcResources.GetCulture(b),a=GcResources[d].FilterDialog,c=e();this.DialogContent=c;GrapeCity.Web.Spread.Dialog.call(this,b,c,a.Title);this.SetCaption(a.IconTitle);function e(){var c=document.getElementById(b.id+"_gcFilterIconDialog");if(c!=null)return c;c=document.createElement("DIV");c.style.height="160px";c.style.width="280px";c.style.display="none";c.id=b.id+"_gcFilterIconDialog";var d='<div id="'+c.id+'_header">'+a.IconHeader+'</div>        <div style="height:3px"></div>        <div class="IconBlock"><a id="'+c.id+'_noicon" style="width: 274px; margin-left:0px;text-decoration:none;height: 18px;" href="#"><div style="height: 16px;margin-top:0px; border: 1px solid rgb(160,160,160);color:#000;text-align:center;">'+a.IconNone+'</div></a></div>        <div style="height:2px"></div>        <div class="IconBlock" style="width: 277px; overflow:auto;background-color:#ffffff; border: 1px solid rgb(130,135,144); positive: relative;">        <div id="'+c.id+'_container" style="width: 256px;">        </div>        </div>        <div style="height:7px"></div>        <div>          <table width="100%">            <tr>              <td width="60px"><b>'+a.ColorSelected+'</b></td>              <td style="padding-left: 10px;"><div id="'+c.id+'_selectedIcon" height: 16px; width: 16px;"></div></td>            </tr>          </table>        </div>        <div style="width: 100%; "><hr/></div>        <div style="height:7px"></div>      ';c.innerHTML=d;document.body.appendChild(c);return c}};GrapeCity.Web.Spread.FilterIconDialog.prototype=new GrapeCity.Web.Spread.FilterDialogBase;GrapeCity.Web.Spread.FilterIconDialog.prototype.constructor=GrapeCity.Web.Spread.FilterIconDialog;GrapeCity.Web.Spread.FilterIconDialog.prototype.Show=function(r,s,j,i,m){this._callback=m;var n=GcResources.GetCulture(this.Control),t=GcResources[n].FilterDialog,c=this.DialogContent.id,b=document.getElementById(c+"_container");b.innerHTML="";this._IconSelected=Function.CreateDelegate(this,this.OnIconSelected);for(var a=null,f=j.icons,h=0,q=f.length;h<q;h++){var g=document.createElement("A"),l=document.createElement("DIV");l.className="SpreadCFIcon"+f[h];g.appendChild(l);b.appendChild(g);$$.utils.attachEvent(g,"click",this._IconSelected);if(!a&&i&&i==f[h])a=g}var d=document.getElementById(c+"_noicon");d.className="";$$.utils.attachEvent(d,"click",this._IconSelected);d.style.display=j.noIcon?"":"none";if(i==52)a=document.getElementById(c+"_noicon");if(!a)a=b.childNodes[0];a.className="Selected";this._Selected=a;document.getElementById(c+"_selectedIcon").className=a.firstChild.className;GrapeCity.Web.Spread.Dialog.prototype.Show.call(this,r,s);this.DialogContent.parentNode.style.backgroundColor="#f0f0f0";var o=8,k=Math.min(o,Math.floor((f.length+7)/8)),e=b.parentNode;e.style.height=k*26+2+"px";if(e.scrollHeight<=e.offsetHeight)b.style.marginLeft=Math.floor((e.offsetWidth-b.offsetWidth)/2)+"px";else b.style.marginLeft="0px";var p=document.getElementById(c+"_header");this.DialogContent.style.height=k*26+p.offsetHeight+80-(j.noIcon?0:parseInt(d.style.height))+"px"};GrapeCity.Web.Spread.FilterIconDialog.prototype.Hide=function(){GrapeCity.Web.Spread.Dialog.prototype.Hide.call(this);for(var b=this.DialogContent.id,d=document.getElementById(b+"_container"),c=d.getElementsByTagName("A"),a=0;a<c.length;a++)$$.utils.detachEvent(c[a],"click",this._IconSelected);$$.utils.detachEvent(document.getElementById(b+"_noicon"),"click",this._IconSelected)};GrapeCity.Web.Spread.FilterIconDialog.prototype.OnIconSelected=function(b){if(!b)b=window.event;if(this._Selected)this._Selected.className="";var a=b.target||b.srcElement;while(a.tagName.toLowerCase()!="a")a=a.parentNode;a.className="Selected";this._Selected=a;document.getElementById(this.DialogContent.id+"_selectedIcon").className=a.firstChild.className;$$.utils.cancelDefault(b)};GrapeCity.Web.Spread.FilterIconDialog.prototype.GetSelectedIcon=function(){if(this._Selected){var a=document.getElementById(this.DialogContent.id+"_selectedIcon").className;return a==null||a.length==0?52:parseInt(a.substr(12,a.length-12))}return null};GrapeCity.Web.Spread.Top10FilterDialog=function(b){var d=GcResources.GetCulture(b),a=GcResources[d].FilterDialog,c=e();this.DialogContent=c;GrapeCity.Web.Spread.Dialog.call(this,b,c,a.Top10Title);function e(){var c=document.getElementById(b.id+"_gcFilterTop10Dialog");if(c!=null)return c;c=document.createElement("DIV");c.style.height="60px";c.style.width="280px";c.style.display="none";c.id=b.id+"_gcFilterTop10Dialog";var d="<div>"+a.Top10Header+'</div>        <div style="height:5px"></div>        <div id="'+c.id+'_container" style="width: 256px;">          <table style="width:100%">            <tr>              <td>                <select id="'+c.id+'_direction" style="width:100px;" tabindex="1">                  <option value="0">'+a.Top10Directions.Top+'</option>                  <option value="1">'+a.Top10Directions.Bottom+'</option>                </select>              </td>              <td><input type="text" id="'+c.id+'_rank" class="Text" style="width:60px;" tabindex="2"/></td>              <td>                <select id="'+c.id+'_type" style="width:100px;" tabindex="3">                  <option value="0">'+a.Top10Types.Items+'</option>                  <option value="1">'+a.Top10Types.Percent+"</option>                </select>              </td>            </tr>          </table>        </div>      ";c.innerHTML=d;document.body.appendChild(c);return c}};GrapeCity.Web.Spread.Top10FilterDialog.prototype=new GrapeCity.Web.Spread.FilterDialogBase;GrapeCity.Web.Spread.Top10FilterDialog.prototype.constructor=GrapeCity.Web.Spread.Top10FilterDialog;GrapeCity.Web.Spread.Top10FilterDialog.prototype.Show=function(c,d,b,a){this._callback=b;GrapeCity.Web.Spread.Dialog.prototype.Show.call(this,c,d);a&&a(this)};GrapeCity.Web.Spread.Top10FilterDialog.prototype.SetFilter=function(g,e,f){var a=this.DialogContent.id,c=document.getElementById(a+"_direction"),d=document.getElementById(a+"_rank"),b=document.getElementById(a+"_type");c.selectedIndex=g;d.value=e;b.selectedIndex=f};GrapeCity.Web.Spread.Top10FilterDialog.prototype.GetFilter=function(){var a=this.DialogContent.id,c=document.getElementById(a+"_direction"),d=document.getElementById(a+"_rank"),b=document.getElementById(a+"_type");return{top10Dir:c.selectedIndex,top10Rank:parseInt(d.value,10),top10Type:b.selectedIndex}};GrapeCity.Web.Spread.Top10FilterDialog.prototype.OnAccept=function(){var g=GcResources.GetCulture(this.Control),c=GcResources[g].FilterDialog,d=this.DialogContent.id,a=document.getElementById(d+"_rank").value,e=document.getElementById(d+"_type").selectedIndex==1;if(a==""){alert(e?c.Top10InvalidRangePercent:c.Top10InvalidRangeItems);return}else{a=a.trim();var b=parseInt(a,10),f=parseFloat(a);if(isNaN(b)||isNaN(f)||f!=b||isNaN(a)){alert(c.Top10InvalidData);return}if(e){if(b<=0||b>100){alert(c.Top10InvalidRangePercent);return}}else if(b<=0||b>2147483647){alert(c.Top10InvalidRangeItems);return}}GrapeCity.Web.Spread.FilterDialogBase.prototype.OnAccept.call(this)};GrapeCity.Web.Spread.Top10FilterDialog.prototype.GetFirstFocusableControl=function(a){return a?GrapeCity.Web.Spread.FilterDialogBase.prototype.GetFirstFocusableControl.call(this):document.getElementById(this.DialogContent.id+"_direction")};GrapeCity.Web.Spread.AlertDialog=function(){var a=b();this.DialogContent=a;GrapeCity.Web.Spread.Dialog.call(this,null,a,"GrapeCity Spread");function b(){var a=document.createElement("DIV");a.style.height="60px";a.style.width="280px";a.style.display="none";a.id="_gcAlertDialog"+(new Date).toString();var b='<div></div>        <div style="height:5px"></div>        <div id="'+a.id+'_container" style="width: 256px;">'+this._message+"</div>      ";a.innerHTML=b;document.body.appendChild(a);return a}};GrapeCity.Web.Spread.AlertDialog.prototype=new GrapeCity.Web.Spread.FilterDialogBase;GrapeCity.Web.Spread.AlertDialog.prototype.constructor=GrapeCity.Web.Spread.AlertDialog;GrapeCity.Web.Spread.AlertDialog.prototype.Show=function(b,c,a){this._callback=a;GrapeCity.Web.Spread.Dialog.prototype.Show.call(this,b,c)};GrapeCity.Web.Spread.AlertDialog.prototype.SetText=function(a){this._message=a};GrapeCity.Web.Spread.Alert=function(c,b){var a=GrapeCity.Web.Spread._alertDialog;if(!a){a=new GrapeCity.Web.Spread.AlertDialog;GrapeCity.Web.Spread._alertDialog=a}a.SetText(c);a.Show("50%","50%",b)}