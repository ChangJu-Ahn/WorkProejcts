//
//	  Copyright (C) 2003-2014 GrapeCity Inc.	All rights reserved.
//

var GrapeCity;(function(a){var b;(function(a){var b;(function(a){"use strict";(function(a){a[a.Viewport=0]="Viewport";a[a.RowHeader=1]="RowHeader";a[a.ColumnHeader=2]="ColumnHeader"})(a.ContextMenuType||(a.ContextMenuType={}));var c=a.ContextMenuType,b=function(){function a(a,e,c,d,b){this.ActiveChildMenu=null;this.IsChildMenu=false;this._Items=[];this.isCorrectJapaneseTextCalled=false;this.isTapped=false;if(a==null)return;this.Initialize(a,e,c,d,b)}a.prototype.GetEventMan=function(){if($$.browser.mb)this.__eventMan=FarPoint.Web.Spread.EventManipulator.Create();return this.__eventMan};a.prototype.Initialize=function(a,b,d,e,c){this.Spread=a;if(b!=null)this.Type=b;this.Holder=d;this.Owner=e;this.IsChildMenu=c;this.__SpreadView=a==null?null:a.getSpreadView();$$.browser.webkit&&$$(this.Holder).appendCssClass(this.__SpreadView.GenerateBrowserBaseCssClass("SpreadContextMenu"));this.__BuildStructure();this.Holder.Behavior=this};a.prototype._isActivated=function(){return document.activeElement==this.Holder||$$.utils.contains(this.Holder,document.activeElement)};a.prototype._SetSpreadView=function(b){this.__SpreadView=b;for(var a=0;a<this._Items.length;a++)this._Items[a].ChildMenu!=null&&this._Items[a].ChildMenu._SetSpreadView(b)};a.prototype.__CreateChildMenu=function(b,c){return new a(b,this.Type,c,this,true)};a.prototype.__BuildStructure=function(){var p=$$.utils,l=this.Holder;l.style.listStyleType="none";for(var q=$$.browser,j=0,b=0;b<l.childNodes.length;b++){var e=l.childNodes[b];if(e.tagName!="LI")continue;var m=p.firstTaggedChild(e,"UL");if(m!=null){var n=this.__CreateChildMenu(this.Spread,m);e.ChildMenu=n}e.Owner=this;e.Index=j;this._Items[j]=e;if($$.browser.ie&&$$.browser.version<8){var i=$$(e).firstChild("A");if(i!=null)i.style.borderColor=$$(i).style("background-color")}j++}if(!this.IsChildMenu){var c=this.Holder.parentNode,o=c.parentNode,d=a.FindMenuHostElement(this.Spread);if(d.querySelectorAll){for(var g=d.querySelectorAll("DIV[id='"+c.id+"']"),b=0;b<g.length;b++)if(g[b]!=c){$$.utils.removeBackgroundImages(g[b]);d.removeChild(g[b])}}else for(var b=d.childNodes.length-1;b>=0;b--){var h=d.childNodes[b];if(h.id==c.id&&h!=c){$$.utils.removeBackgroundImages(h);d.removeChild(h);break}}c.parentNode!=d&&d.appendChild(c);c.setAttribute("HostSpreadID",this.Spread.id);c.__oldParent=o;var k=this.__SpreadView,f=k._menuHolders;if(f==null){f=[];k._menuHolders=f}f.push(c)}if(!this.IsChildMenu){this.focusDiv=document.createElement("DIV");this.focusDiv.id=this.Holder.parentElement.id+"_focusDiv";this.focusDiv.tabIndex=-1;this.focusDiv.style.lineHeight="0px";this.focusDiv.style.height="0px";this.focusDiv.style.outline="none";if(k.IsMultiBrowserMode())$$.j(this.focusDiv).insertBefore(this.Holder.firstChild);else this.Holder.insertBefore(this.focusDiv,this.Holder.firstChild)}};a.prototype.__AdjustForQuirksMode=function(){for(var c=0;c<this._Items.length;c++){var b=this._Items[c],a=$$(b).firstChild("A");if(a!=null){a.style.position="absolute";a.style.width="100%";a.style.zIndex=1}b.style.paddingTop="2px";b.style.paddingBottom="5px";var d=this.__GetIconDiv(b);if(d!=null)d.style.zIndex=2}};a.prototype.OnItemAttachEvents=function(){};a.prototype.OnItemDetachEvents=function(){};a.prototype.__AttachEvents=function(){if(!this.IsShowing())return;if(this.__onHoverItemDelegate==null){this.__onHoverItemDelegate=Function.CreateDelegate(this,this.OnHoverItem);this.__onOutItemDelegate=Function.CreateDelegate(this,this.OnOutItem);this.__onSelectionStart=function(a){$$.utils.cancelDefault(a);return false};for(var b=0;b<this._Items.length;b++){var a=this._Items[b];$$.utils.attachEvent(a,"mouseover",this.__onHoverItemDelegate);$$.utils.attachEvent(a,"mouseout",this.__onOutItemDelegate);!$$(a).hasCssClass("template")&&$$.utils.attachEvent(a,"selectstart",this.__onSelectionStart);this.OnItemAttachEvents(a)}}if(!this.IsChildMenu&&this.__holderMouseWheelHandler==null){this.__holderMouseWheelHandler=Function.CreateDelegate(this,this.OnMouseWheel);if($$.browser.mozilla)$$.utils.attachEvent(this.Holder.parentNode,"DOMMouseScroll",this.__holderMouseWheelHandler);else $$.utils.attachEvent(this.Holder,"mousewheel",this.__holderMouseWheelHandler)}if(this.__holderMouseDownHandler==null){this.__holderMouseDownHandler=Function.CreateDelegate(this,this.Holder_MouseDown);if($$.browser.webkit){if(this.__onTouchStartDelegate==null)this.__onTouchStartDelegate=Function.CreateDelegate(this,this.OnTouchStart);$$.utils.attachEvent(this.Holder,$$.TouchEvents.TouchStart,this.__onTouchStartDelegate);if(this.__onTouchMoveDelegate==null)this.__onTouchMoveDelegate=Function.CreateDelegate(this,this.OnTouchMove);$$.utils.attachEvent(this.Holder,$$.TouchEvents.TouchMove,this.__onTouchMoveDelegate);if(this.__onTouchEndDelegate==null)this.__onTouchEndDelegate=Function.CreateDelegate(this,this.OnTouchEnd);$$.utils.attachEvent(this.Holder,$$.TouchEvents.TouchEnd,this.__onTouchEndDelegate);if(this.__holderMouseClickHandler==null)this.__holderMouseClickHandler=Function.CreateDelegate(this,this.OnHolderMouseClick);$$.utils.attachEvent(this.Holder,"click",this.__holderMouseClickHandler)}$$.utils.attachEvent(this.Holder,"mousedown",this.__holderMouseDownHandler)}if(this.__holderMouseUpHandler==null){this.__holderMouseUpHandler=Function.CreateDelegate(this,this.Holder_MouseUp);$$.utils.attachEvent(this.Holder,"mouseup",this.__holderMouseUpHandler)}};a.prototype.__DetachEvents=function(c){for(var b=0;b<this._Items.length;b++){var a=this._Items[b];$$.utils.detachEvent(a,"mouseover",this.__onHoverItemDelegate);$$.utils.detachEvent(a,"mouseout",this.__onOutItemDelegate);$$.utils.detachEvent(a,"selectstart",this.__onSelectionStart);this.OnItemDetachEvents(a)}this.__onHoverItemDelegate=null;this.__onOutItemDelegate=null;this.__onSelectionStart=null;if(!c){if(!this.IsChildMenu){$$.utils.detachEvent(this.Holder,"mousewheel",this.__holderMouseWheelHandler);this.__holderMouseWheelHandler=null}$$.utils.detachEvent(this.Holder,"mousedown",this.__holderMouseDownHandler);$$.utils.detachEvent(this.Holder,"mouseup",this.__holderMouseUpHandler);if($$.browser.webkit){$$.utils.detachEvent(this.Holder,$$.TouchEvents.TouchStart,this.__onTouchStartDelegate);$$.utils.detachEvent(this.Holder,$$.TouchEvents.TouchMove,this.__onTouchMoveDelegate);$$.utils.detachEvent(this.Holder,$$.TouchEvents.TouchEnd,this.__onTouchEndDelegate);$$.utils.detachEvent(this.Holder,"click",this.__holderMouseClickHandler)}this.__holderMouseDownHandler=null;this.__holderMouseUpHandler=null}};a.prototype.__FireSpreadEvent=function(c,a){var b=$$.browser;if(!b.ie||b.version>8)this.Spread.dispatchEvent(a);else{var d=this.__SpreadView.GetSpreadContext();if(d.fireSpreadEvent)d.fireSpreadEvent(c,a);else this.__SpreadView.Spread.fireSpreadEvent&&this.__SpreadView.Spread.fireSpreadEvent(c,a)}};a.prototype.IsShowing=function(){return $$(this.Holder).style("display")!="none"&&this.Holder.parentElement.style.overflow!="hidden"};a.prototype.CorrectJapaneseText=function(){$$.browser.webkit&&this.lastTappedElement&&this.lastTappedElement!=document.activeElement&&$$.utils.isTextControl(this.lastTappedElement)&&this.GetFocusTextBox().focus()};a.prototype.OnHolderMouseClick=function(){if(!this.isCorrectJapaneseTextCalled){this.CorrectJapaneseText();this.isCorrectJapaneseTextCalled=true}};a.prototype.OnTouchStart=function(a){$$.utils.cancelBubble(a,false);this.isCorrectJapaneseTextCalled=false;this.isTapped=true};a.prototype.OnTouchMove=function(){this.isTapped=false};a.prototype.OnTouchEnd=function(a){if(this.isTapped){this.lastTappedElement=this.currentTappedElement;this.currentTappedElement=a.target}};a.prototype.OnMenuMouseDown=function(){return true};a.prototype.Holder_MouseDown=function(a){if(!this.OnMenuMouseDown(a))return false;var b=a.target||a.srcElement;$$.utils.cancelBubble(a,false);if(!$$.browser.ie&&!$$.utils.isNativeControl(b)){if($$.browser.webkit)this.Focus();else $$(this.Holder).focus();return $$.utils.cancelDefault(a)}};a.prototype.Holder_MouseUp=function(a){$$.utils.cancelBubble(a,false)};a.prototype.OnItemKeyDown=function(){return true};a.prototype.OnKeyDown=function(a){if(a._gcProcessed)return a._gcResult;if(this.ActiveChildMenu==null||this.ActiveChildMenu.OnKeyDown(a))if(this.ActiveItem==null||this.OnItemKeyDown(this.ActiveItem,a)){var b=a.keyCode,c=this.__SpreadView;switch(b){case GCWS.Keys.ESCAPE:this.Hide();if(this.Owner==null)this.OnEscapePressed();else this.Owner.Focus();$$.utils.cancelBubble(a)}}a._gcResult=false;a._gcProcessed=true;return false};a.prototype.OnEscapePressed=function(){this.__SpreadView.FocusSpread()};a.prototype.OnMouseWheel=function(a){$$.utils.cancelDefault(a);return false};a.prototype.OnHoverItem=function(a){var c=a.target||a.srcElement,b=$$.utils.FindParent(c,"LI");!b.disabled&&this.__HoverItem(b);return $$.utils.cancelDefault(a)};a.prototype.OnOutItem=function(a){this.__OutItem(a)};a.prototype.OnBeforeShow=function(){};a.prototype.Show=function(){var r=$$.utils;if(!this.IsChildMenu){var b;if(this.Type!=null&&this.Type>=0){var i={spread:this.Spread,ContextMenu:this};b=r.createEvent("ContextMenuOpening",false,true,i,true);b.cancel=false;this.__FireSpreadEvent("ContextMenuOpening",b);if(b.cancel)return false}else this.__FireInternalOpeningEvents()}$$.browser.ie&&!this.IsChildMenu&&$$.utils.contains(this.Spread,document.activeElement)&&document.releaseCapture();var a=this.Holder;a.style.display="block";if(!this.IsChildMenu){a=a.parentElement;a.style.top="-1000px";a.style.left="-1000px";a.style.overflow="visible";a.style.display="block"}a.style.visibility="visible";if($$.browser.webkit&&this.Holder.parentElement.style.visibility=="hidden")this.Holder.parentElement.style.visibility="visible";var g=document.documentElement.scrollLeft||document.body.scrollLeft,h=document.documentElement.scrollTop||document.body.scrollTop,k=document.documentElement.offsetWidth+g,j=document.documentElement.offsetHeight+h;if(!this.IsChildMenu){var c,d;if(arguments.length==1){var b=arguments[0];if(this.Type>=0){c=b.clientX+g;d=b.clientY+h}else{var m=b.srcElement?b.srcElement:b.target,f=m.getBoundingClientRect();c=Math.max(f.left-this.GetWidth()+m.offsetWidth,0)+g;d=f.bottom+1+h}}else if(arguments.length==2){c=arguments[0];d=arguments[1]}if(this.Type>=0){if(c+this.GetWidth()>k){var p=c-this.GetWidth();if(p>0)c=p}}else if(c<0)c=f!=null?f.left:0;if(this.Type>=0&&d+this.GetHeight()>j){var q=d-this.GetHeight();if(q>0)d=q}this.OnBeforeShow();a.style.left=c+"px";a.style.top=d+1+"px"}else{var s=a.parentElement,e=s.getBoundingClientRect(),l=this.GetPreferredLocation(),n=l.X,o=l.Y;if(e.right+this.GetWidth()+g>k)if(e.left-this.GetWidth()>0)n=-this.GetWidth();if(e.top+this.GetHeight()+h>j)if(e.top-this.GetHeight()>0)o=-this.GetHeight();a.style.marginLeft=n+"px";a.style.marginTop=o+"px";a.style.display="block";this.__LayoutMenu()}if($$.browser.webkit){var t=this.Spread.getSpreadView().GetTopSpreadView();this.safariScrollShield=FarPoint.Web.Spread.SafariPatch.FixUnderLayerScroll(this.Holder,t.Spread)}if(!this.IsChildMenu&&this.CanUseAsActiveContextMenu())this.__SpreadView.GetTopSpreadView().ActiveContextMenu=this;else if(this.IsChildMenu)this.Owner.ActiveChildMenu=this;if(!this.IsChildMenu)if(this.Type>=0){i={spread:this.Spread,ContextMenu:this};b=r.createEvent("ContextMenuOpened",false,true,i);this.__FireSpreadEvent("ContextMenuOpened",b)}this.Focus();this.__AttachEvents();return true};a.prototype.GetPreferredLocation=function(){var a=this.Holder.parentElement;return{X:a.offsetWidth,Y:-a.offsetHeight}};a.prototype.CanUseAsActiveContextMenu=function(){return true};a.prototype.Hide=function(c){if(this.Holder==null)return;if(this.safariScrollShield!=null&&this.safariScrollShield.parentNode!=null){this.safariScrollShield.parentElement.removeChild(this.safariScrollShield);this.safariScrollShield=null}var b=this.IsShowing();if(this.IsChildMenu){this.Holder.style.display="none";this.Holder.style.visibility="hidden"}else if($$.browser.chrome||$$.browser.webkit){this.Holder.style.display="none";if($$.browser.webkit)this.Holder.parentElement.style.visibility="hidden"}else this.Holder.parentElement.style.overflow="hidden";var f=$$.utils;if(this.ActiveChildMenu!=null){var a=this.ActiveChildMenu;while(a!=null){a.Hide();a=a.ActiveChildMenu}}if(this.ActiveItem!=null){this.__SetActiveStyle(this.ActiveItem,false);this.ActiveItem=null}if(!this.IsChildMenu){if(this.CanUseAsActiveContextMenu())this.__SpreadView.GetTopSpreadView().ActiveContextMenu=null;if(b)if(this.Type>=0){var d={spread:this.Spread,ContextMenu:this},e=$$.utils.createEvent("ContextMenuClosed",false,false,d);this.__FireSpreadEvent("ContextMenuClosed",e)}else this.__FireInternalClosedEvents()}else this.Owner.ActiveChildMenu=null;this.__DetachEvents();this.lastTappedElement=null;this.currentTappedElement=null;if(c&&this.Owner!=null){var a=this.Owner;while(a!=null){a.Hide();a=a.Owner}this.Owner.ActiveItem!=null&&this.__SetActiveStyle(this.Owner.ActiveItem,false)}};a.prototype.ShowChildMenu=function(a){if(this.ActiveItem!=null&&this.ActiveItem.Index!=a)return;this.ActiveItem.ChildMenu.Show()};a.prototype.HideChildMenu=function(a){if(this.ActiveItem!=null&&this.ActiveItem.Index==a)return;var b=this._Items[a];b.ChildMenu!=null&&b.ChildMenu.Hide()};a.prototype._GetCommand=function(a){return"Menu$"+a};a.prototype.GetFocusTextBox=function(){var b=this.GetTopMenu();if(this!=b)return b.GetFocusTextBox();var a=this.focusTextBox;if(a==null){var a=document.createElement("input");a.type="text";a.readOnly=true;a.style.position="absolute";a.style.left="-1000px";a.style.top="-1000px";this.Holder.appendChild(a);this.focusTextBox=a}return a};a.prototype.OnItemClick=function(b){var g=b.target?b.target:b.srcElement;g.tagName=="A"&&g.href=="#"&&$$.utils.cancelDefault(b);var m=$$.utils,a=m.FindParent(g,"LI");if(a==null||a.Owner!=this)return;if(a.getAttribute("disabled"))return $$.utils.cancelDefault(b);var j=$$.utils.isNativeControl(g);if(j||a.getAttribute("controlhost")!=null)return;$$.utils.cancelBubble(b,!j);var k=$$(a).getCssClass();if(this.__IsCaption(a)||k!=null&&k.indexOf("sep")!=-1)return false;this.ActiveItem!=a&&this.__HoverItem(a);if(this.ManualOpenChildMenu&&this.ActiveItem==a&&a.ChildMenu!=null){a.ChildMenu.EnableTouchMode(a.ChildMenu.__SpreadView.IsInTouchMode());a.ChildMenu.Show();this.__SetActiveStyle(a,true);return}if(this.ActiveItem!=a||this.ActiveItem.ChildMenu==null||!this.ActiveItem.ChildMenu.IsShowing())if(this.__FireInternalClickEvents(a)){this.Hide(true);return}var e;if(this.Type>=0){var p={spread:this.Spread,SelectedItem:a,ContextMenu:this};e=m.createEvent("MenuItemClicked",true,true,p);e.cancel=false;this.__FireSpreadEvent("MenuItemClicked",e)}var d=true,f=a.getAttribute("OnClientClick");if(f!=null&&f.length>0){var h=window[f];if(h==null)h=new Function(f);try{var l=h.call(a);if(l!=null&&!l)d=false}catch(q){d=false}}if(d&&a.Owner&&a.Owner.ProcessCommandName)d=!a.Owner.ProcessCommandName(a);if(a.ChildMenu==null)this.Hide(true);else{if(!this.isCorrectJapaneseTextCalled){this.CorrectJapaneseText();this.isCorrectJapaneseTextCalled=true}return false}if(e!=null&&e.cancel||!d||a.getAttribute("autoPostBack")=="0"){if(document.activeElement==null||document.activeElement!=this.Spread&&!$$.utils.contains(this.Spread,document.activeElement))if(!this.__SpreadView.IsInTouchMode()||$$.browser.ie)this.__SpreadView.FocusSpread();else this.__SpreadView.FocusSpread(null,null,null,true);return false}else{var c=this.__SpreadView,n=this._GetCommand(a.getAttribute("index")),o=this.Spread.getAttribute("name");c.GetSpreadContext().saveData();var i=c.GetActiveSpread();i!=null&&i!=this.Spread&&i.getSpreadView().GetSpreadContext().saveData();if(c.Spread.IsValid())if(c.IsAjaxEnabled)c.SyncData(o,n);else __doPostBack(o,n);else setTimeout(function(){c.FocusSpread()},0)}};a.prototype.SelectItem=function(c,d){var a=this._Items[c];if(a==null)return;var b=this.__GetIconDiv(a);if(d){a.setAttribute("selected","true");$$(b).appendCssClass("checked")}else{$$(a).removeOrResetAttribute("selected","false");$$(b).removeCssClass("checked")}};a.prototype.GetSelectedItems=function(){for(var a=[],b=0;b<this._Items.length;b++){var c=this._Items[b];c.getAttribute("selected")=="true"&&a.push(c)}return a.length>0?a:null};a.prototype.ClearSelectedItems=function(){var a=this.GetSelectedItems();if(a!=null)for(var b=0;b<a.length;b++)this.SelectItem(a[b].Index,false)};a.prototype.GetTopMenu=function(){var a=this;while(a.IsChildMenu)a=a.Owner;return a};a.prototype.Focus=function(){if(this.focusDiv!=null){if(this.__SpreadView.EditModePermanent){var a=this.__SpreadView.GetSpreadContext();a.switchHiddenTextBox&&a.switchHiddenTextBox(true,true)}$$(this.focusDiv).focus();this.__SpreadView.IsInTouchMode()&&this.__SpreadView.GetTopSpreadView().Spread.GetActiveChart()==null&&this.__SpreadView.GetActiveSpreadView(false,true).Touch.ShowTouchHandles()}};a.prototype.EnableTouchMode=function(a){if(a&&this.Holder.className.indexOf(" touch")==-1)this.Holder.className+=" touch";else if(!a&&this.Holder.className.indexOf(" touch")>-1)this.Holder.className=this.Holder.className.toString().replace(" touch","")};a.prototype.__GetIconDiv=function(a){return $$(a).getChildTag("DIV","class","icon")};a.prototype.__HoverItem=function(a){if(a==null||a.Owner!=this)return;if(this.ActiveItem==a)return;var b=this.ActiveItem;if(b!=null){b.ChildMenu!=null&&b.ChildMenu.Hide();this.__SetActiveStyle(b,false)}if(this.__IsItemLink(a)||this.__IsControlHostItem(a)){if(a.ChildMenu!=null&&!this.ManualOpenChildMenu){a.ChildMenu.EnableTouchMode(a.ChildMenu.__SpreadView.IsInTouchMode());a.ChildMenu.Show()}this.ActiveItem=a;!this.__IsCaption(a)&&this.__SetActiveStyle(a,true)}else this.ActiveItem=null};a.prototype.__OutItem=function(b){var a=this.ActiveItem;if(a!=null&&a.ChildMenu!=null&&a.ChildMenu.IsShowing())return;if(a!=null&&(a.ChildMenu==null||!this.__IsInMenu(b.clientX,b.clientY,a.ChildMenu))){this.__SetActiveStyle(a,false);this.ActiveItem=null;a.ChildMenu!=null&&a.ChildMenu.Hide()}};a.prototype.__LayoutMenu=function(){if(this.isLayouted)return;for(var g=$$.browser,l=$$.utils,d=0,f=0;f<this._Items.length;f++){var e=this._Items[f];if($$(e).hasClass("sep"))continue;var a=$$(e).firstChild("A"),c=0;if(g.ie&&g.version<8&&a!=null&&(a.style.width==""||a.style.width=="auto")){var j=a.style.overflow,k=a.style.display,b=$$.browser.quirksMode&&$$.browser.ieversion<10?$$(a).firstChild("DIV"):null,h,i;if(b!=null){h=b.style.overflow;i=b.style.display;b.style.overflow="visible";b.style.display="inline"}a.style.overflow="visible";a.style.display="inline";c=a.offsetWidth;if(a.className.indexOf(" caption")<0)c+=30;if(b!=null){b.style.overflow=h;b.style.display=i}a.style.display=k;a.style.overflow=j}else c=e.offsetWidth;if(d<c)d=c}if(d>0)this.Holder.style.width=d+10+"px";this.isLayouted=true};a.prototype.GetAttribute=function(a){return this.Holder.parentElement.getAttribute(a)};a.prototype.IsMenuElement=function(d,c){var b=false,a=d;while(a!=null){if(a==this.Holder){b=true;break}a=a.__oldParent||a.parentNode}return c&&!b&&this.Owner!=null?this.Owner.IsMenuElement(d,c):b};a.prototype.GetWidth=function(){return this.Holder.offsetWidth};a.prototype.GetHeight=function(){return this.Holder.offsetHeight};a.prototype.GetBound=function(){return this.Holder.getBoundingClientRect()};a.prototype.__SetSelectedStyle=function(a,c){var b=$$.utils;if(a.tagName!="A")a=b.firstTaggedChild(a,"A");if(c)b.appendCssClass(a,"sel");else b.removeCssClass(a,"sel")};a.prototype.__SetActiveStyle=function(a,d){var b=$$.utils,c=a.tagName=="LI"?a:b.FindParent(a,"LI");if(c!=null&&!this.__IsItemLink(c))return;if(a.tagName!="A")a=$$(a).firstChild("A");if(d){b.appendCssClass(a,"active");if($$.browser.ie&&$$.browser.version<8){a.__borderColor=a.style.borderColor;a.style.borderColor=""}}else{b.removeCssClass(a,"active");if($$.browser.ie&&$$.browser.version<8&&a.__borderColor!=null)a.style.borderColor=a.__borderColor}};a.prototype.__IsCaption=function(b){var a=$$.utils.firstTaggedChild(b,"A");return a==null?false:$$(a).hasClass("caption")};a.prototype.__IsInMenu=function(d,e,a){if(a==null)return false;var c=false;while(!c&&a!=null){var b=a.GetBound();c=d>=b.left&&d<=b.right&&e>=b.top&&e<=b.bottom;a=a.ActiveChildMenu}return c};a.prototype.__IsItemLink=function(a){return a.getAttribute("item_link")!=null};a.prototype.__IsControlHostItem=function(a){return a.getAttribute("controlhost")!=null};a.prototype.AddInternalClickEvent=function(a){this.IsChildMenu&&this.Owner.AddInternalClickEvent(a);if(this.__InternalClickEvents==null)this.__InternalClickEvents=[];this.__InternalClickEvents.push(a)};a.prototype.RemoveInternalClickEvent=function(b){this.IsChildMenu&&this.Owner.RemoveInternalClickEvent(b);if(this.__InternalClickEvents==null)return null;for(var a=this.__InternalClickEvents.length-1;a>=0;a--)this.__InternalClickEvents[a]==b&&this.__InternalClickEvents.splice(a,1);return null};a.prototype.AddInternalOpeningEvent=function(a){this.IsChildMenu&&this.Owner.AddInternalOpeningEvent(a);if(this.__InternalOpeningEvents==null)this.__InternalOpeningEvents=[];this.__InternalOpeningEvents.push(a)};a.prototype.RemoveInternalOpeningEvent=function(b){this.IsChildMenu&&this.Owner.RemoveInternalOpeningEvent(b);if(this.__InternalOpeningEvents==null)return null;for(var a=this.__InternalOpeningEvents.length-1;a>=0;a--)this.__InternalOpeningEvents[a]==b&&this.__InternalOpeningEvents.splice(a,1);return null};a.prototype.AddInternalClosedEvent=function(a){this.IsChildMenu&&this.Owner.AddInternalClosedEvent(a);if(this.__InternalClosedEvents==null)this.__InternalClosedEvents=[];this.__InternalClosedEvents.push(a)};a.prototype.RemoveInternalClosedEvent=function(b){this.IsChildMenu&&this.Owner.RemoveInternalClosedEvent(b);if(this.__InternalClosedEvents==null)return null;for(var a=this.__InternalClosedEvents.length-1;a>=0;a--)this.__InternalClosedEvents[a]==b&&this.__InternalClosedEvents.splice(a,1);return null};a.prototype.__FireInternalOpeningEvents=function(){if(this.IsChildMenu){this.Owner.__FireInternalOpeningEvents();return}if(this.__InternalOpeningEvents==null)return;for(var a=0;a<this.__InternalOpeningEvents.length;a++)this.__InternalOpeningEvents[a]()};a.prototype.__FireInternalClosedEvents=function(){if(this.IsChildMenu){this.Owner.__FireInternalClosedEvents();return}if(this.__InternalClosedEvents==null)return;for(var a=0;a<this.__InternalClosedEvents.length;a++)this.__InternalClosedEvents[a]()};a.prototype.__FireInternalClickEvents=function(b){if(this.IsChildMenu)return this.Owner.__FireInternalClickEvents(b);if(this.__InternalClickEvents==null)return;for(var c=false,a=0;a<this.__InternalClickEvents.length;a++)if(this.__InternalClickEvents[a](b))c=true;return c};a.FindMenuHostElement=function(b){var a=b.parentElement;if(!b.getSpreadView().__InDesign){if(document.forms.length==0)return document.body;if(document.forms.length==1)return document.forms[0];while(a!=document.body){if(a.tagName.toLowerCase()=="form")break;a=a.parentElement}}return a};a.DELAY_INTERVAL=500;return a}();a.ContextMenu=b})(b=a.Spread||(a.Spread={}))})(b=a.Web||(a.Web={}))})(GrapeCity||(GrapeCity={}))