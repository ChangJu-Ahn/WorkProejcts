//
//	  Copyright (C) 2003-2015 GrapeCity Inc.	All rights reserved.
//

var __extends=this.__extends||function(b,a){for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c];function d(){this.constructor=b}d.prototype=a.prototype;b.prototype=new d};String.prototype.startWith=function(a){return a==null||a==""||this.length==0||a.length>this.length?false:this.substr(0,a.length)==a?true:false};var GCIMCalendar;(function(GCIMCalendar){"use strict";var FadeType=function(){function a(){}a.FadeIn="FadeIn";a.FadeOut="FadeOut";a.FadeInOut="FadeInOut";return a}();GCIMCalendar.FadeType=FadeType;var ScrollType=function(){function a(){}a.Up="Up";a.Down="Down";return a}();GCIMCalendar.ScrollType=ScrollType;var AnimationType=function(){function a(){}a.ScrollToLeft="ScrollToLeft";a.ScrollToRight="ScrollToRight";a.ScrollToTop="ScrollToTop";a.ScrollToBottom="ScrollToBottom";a.Fade="Fade";a.Slide="Slide";a.Center="Center";a.Extend="Extend";a.Drag="Drag";a.Scroll="Scroll";return a}();GCIMCalendar.AnimationType=AnimationType;var ControlEffect=function(){function a(){}a.NotSet="";a.Normal="normal";a.XPTheme="xptheme";a.VistaTheme="vistatheme";a.Windows8Theme="windows8theme";a.JQueryUI="jqueryui";a.Ipad="ipad";a.Chrome="chrome";return a}();GCIMCalendar.ControlEffect=ControlEffect;(function(a){a[a.Default=-1]="Default";a[a.Left=0]="Left";a[a.Middle=1]="Middle";a[a.Right=2]="Right"})(GCIMCalendar.MouseButton||(GCIMCalendar.MouseButton={}));var MouseButton=GCIMCalendar.MouseButton,CalendarType=function(){function a(){}a.MonthDay="monthday";a.YearMonth="yearmonth";return a}();GCIMCalendar.CalendarType=CalendarType;(function(a){a[a.Normal=0]="Normal";a[a.Blue=1]="Blue";a[a.Olive=2]="Olive";a[a.Silver=3]="Silver";a[a.Vista=4]="Vista";a[a.Win8=5]="Win8"})(GCIMCalendar.ColorScheme||(GCIMCalendar.ColorScheme={}));var ColorScheme=GCIMCalendar.ColorScheme;(function(a){a[a.Default=0]="Default";a[a.January=1]="January";a[a.February=2]="February";a[a.March=3]="March";a[a.April=4]="April";a[a.May=5]="May";a[a.June=6]="June";a[a.July=7]="July";a[a.August=8]="August";a[a.September=9]="September";a[a.October=10]="October";a[a.November=11]="November";a[a.December=12]="December"})(GCIMCalendar.Months||(GCIMCalendar.Months={}));var Months=GCIMCalendar.Months,FontStyle=function(){function a(){}a.NotSet="";a.Normal="normal";a.Italic="italic";a.Oblique="oblique";return a}();GCIMCalendar.FontStyle=FontStyle;var FontWeight=function(){function a(){}a.NotSet="";a.Normal="normal";a.Bold="bold";a.Bolder="bolder";a.Lighter="lighter";a.Weight100="100";a.Weight200="200";a.Weight300="300";a.Weight400="400";a.Weight500="500";a.Weight600="600";a.Weight700="700";a.Weight800="800";a.Weight900="900";return a}();GCIMCalendar.FontWeight=FontWeight;var TextDecoration=function(){function a(){}a.NotSet="";a.None="none";a.Underline="underline";a.OverLine="overline";a.LineThrough="line-through";a.Blink="blink";return a}();GCIMCalendar.TextDecoration=TextDecoration;var HorizontalAlignment=function(){function a(){}a.NotSet="";a.Left="left";a.Right="right";a.Center="center";return a}();GCIMCalendar.HorizontalAlignment=HorizontalAlignment;var VerticalAlignment=function(){function a(){}a.NotSet="";a.Top="top";a.Bottom="bottom";a.Middel="middle";return a}();GCIMCalendar.VerticalAlignment=VerticalAlignment;var LineStyle=function(){function a(){}a.NotSet="";a.None="none";a.Dotted="dotted";a.Dashed="dashed";a.Solid="solid";a.Double="double";a.Groove="groove";a.Ridge="ridge";a.Inset="inset";a.Outset="outset";return a}();GCIMCalendar.LineStyle=LineStyle;var XPTheme=function(){function a(){}a.Default="default";a.OliveGreen="olivegreen";a.Silver="silver";return a}();GCIMCalendar.XPTheme=XPTheme;var Cursor=function(){function a(){}a.NotSet="";a.Auto="auto";a.CrossHair="crosshair";a.Default="default";a.EResize="e-resize";a.Help="help";a.Move="move";a.NResize="n-resize";a.NEResize="ne-resize";a.NWResize="nw-resize";a.Pointer="pointer";a.Progres="progress";a.SResize="s-resize";a.SEResize="se-resize";a.SWResize="sw-resize";a.Text="text";a.WResize="w-resize";a.Wait="wait";a.Hand="hand";return a}();GCIMCalendar.Cursor=Cursor;var Key=function(){function a(){}a.BackSpace=8;a.Tab=9;a.Clear=12;a.Return=13;a.Shift=16;a.Control=17;a.Alt=18;a.Pause=19;a.CapsLock=20;a.Escape=27;a.Space=32;a.PageUp=33;a.PageDown=34;a.End=35;a.Home=36;a.Left=37;a.Up=38;a.Right=39;a.Down=40;a.Select=41;a.Print=42;a.Execute=43;a.Insert=45;a.Delete=46;a.Help=47;a.D0=48;a.D1=49;a.D2=50;a.D3=51;a.D4=52;a.D5=53;a.D6=54;a.D7=55;a.D8=56;a.D9=57;a.A=65;a.B=66;a.C=67;a.D=68;a.E=69;a.F=70;a.G=71;a.H=72;a.I=73;a.J=74;a.K=75;a.L=76;a.M=77;a.N=78;a.O=79;a.P=80;a.Q=81;a.R=82;a.S=83;a.T=84;a.U=85;a.V=86;a.W=87;a.X=88;a.Y=89;a.Z=90;a.NumPad0=96;a.NumPad1=97;a.NumPad2=98;a.NumPad3=99;a.NumPad4=100;a.NumPad5=101;a.NumPad6=102;a.NumPad7=103;a.NumPad8=104;a.NumPad9=105;a.Multiply=106;a.Add=107;a.Separator=108;a.Subtract=109;a.Decimal=110;a.Divide=111;a.NumLock=136;a.ScrollLock=137;a.F1=112;a.F2=113;a.F3=114;a.F4=115;a.F5=116;a.F6=117;a.F7=118;a.F8=119;a.F9=120;a.F10=121;a.F11=122;a.F12=123;a.F13=124;a.F14=125;a.F15=126;a.F16=127;a.F17=128;a.F18=129;a.F19=130;a.F20=131;a.F21=132;a.F22=133;a.F23=134;a.F24=135;return a}();GCIMCalendar.Key=Key;var Size=function(){function a(a,c){if(typeof a=="string"){var b=a.split(",");if(b.length==2){this.Width=parseInt(b[0]);this.Height=parseInt(b[1])}else if(b.length==1){this.Width=parseInt(b[0]);this.Height=parseInt(b[0])}}else{if(a!=undefined)this.Width=a;if(c!=undefined)this.Height=c;else if(a!=undefined)this.Height=a}}a.prototype.ToString=function(){return this.Width+","+this.Height};return a}();GCIMCalendar.Size=Size;var CollectionBase=function(){function a(){}return a}();GCIMCalendar.CollectionBase=CollectionBase;var ArrayInit=function(){function a(){}a.Init=function(){if(!Array.prototype.indexOf)Array.prototype.indexOf=function(c,a){var b=this.length>>>0,a=Number(arguments[1])||0;a=a<0?Math.ceil(a):Math.floor(a);if(a<0)a+=b;for(;a<b;a++)if(this[a]===c)return a;return-1}};return a}();GCIMCalendar.ArrayInit=ArrayInit;ArrayInit.Init();var Utility=function(){function Utility(){}Utility.Init=function(){Utility.Sep1=Utility.Hold+";";Utility.Sep4="1"+Utility.Hold+";";Utility.IsIE=Utility.ie!==undefined;Utility.IsFireFox4OrLater=Utility.firefox!=null&&parseFloat(Utility.firefox)>=4;Utility.IsIE11OrLater=Utility.IsIE&&Utility.engine>=11;Utility.IsIE10OrLater=Utility.IsIE&&Utility.engine>=10;Utility.IsIE9OrLater=Utility.IsIE&&Utility.engine>=9;Utility.IsIE9OrBelow=Utility.IsIE&&Utility.engine<=9;Utility.IsIE8OrLater=Utility.IsIE&&Utility.engine>=8;Utility.IsIE8OrBelow=Utility.IsIE&&Utility.engine<=8;Utility.IsIE8=Utility.IsIE&&Utility.engine==8;Utility.IsIE7=Utility.IsIE&&Utility.engine==7;Utility.IsIE7OrLater=Utility.IsIE&&Utility.engine>=7;Utility.IsIE9=Utility.IsIE&&Utility.engine==9;Utility.IsIE10=Utility.IsIE&&Utility.engine==10;Utility.IsIE11=Utility.IsIE&&Utility.engine==11;Utility.webkit=Utility.chrome||Utility.safari||Utility.IsPad();Utility.IsQuriksMode=!Utility.IsStandCompliantModeOn();if(!Utility.IsIE){Utility.HasGetFocus=false;Utility.ShouldInvokeKeyPress=true}if(a==null)var a="";if(Utility.IsIE10OrLater)document.addEventListener("MSPointerDown",function(a){Utility.onMSPointerDown(a)},true);else if(Utility.firefox||Utility.safari||Utility.chrome){document.addEventListener("touchstart",function(a){Utility.onTouchStart(a)},true);document.addEventListener("mousedown",function(a){Utility.onMouseDown(a)},true)}Utility.AttachEvent(window,"load",Utility._onDocumentLoadComplete);Utility.AddDocumentLoadTask(Utility._commonOnLoadHandler);if(!Utility.IsIE&&!Utility.firefox)Utility.HighlightColor="#3399ff"};Utility._onDocumentLoadComplete=function(){Utility._onLoadCallBackList.sort(function(b,a){return b.Priority-a.Priority});for(var a=0;a<Utility._onLoadCallBackList.length;a++)Utility._onLoadCallBackList[a].CallBack.call(window);Utility._onLoadCallBackList=[];Utility.OnLoadFinished=true};Utility.AddDocumentLoadTask=function(c,a){if(a===undefined)a=10;var b={CallBack:c,Priority:a};Utility._onLoadCallBackList.push(b)};Utility.CreateImageCache=function(b,c){if(typeof b==="string"){if(Utility.imageCacheList[b])return;var a=document.getElementById("imageCacheContainer");if(!a){a=document.createElement("div");a.id="imageCacheContainer";a.style.display="none";a.style.position="absolute";a.style.left="-1000";a.style.top="-1000";document.body.appendChild(a)}var f=c!==undefined?c:"div",d=document.createElement(f);if(c==="img")d.setAttribute("src",b);else d.style.backgroundImage=b;a.appendChild(d);Utility.imageCacheList[b]=b}else if(b instanceof Array)for(var g=b,e=0;e<g.length;e++)Utility.CreateImageCache(b[e],c)};Utility.FireEvent=function(oControl,eventName,eArgs,eventType){if(!eventName)return false;var evalContext=oControl;if(oControl!=null){var element=document.getElementById(oControl._getId());if(element!=null)evalContext=element}if(evalContext==null)evalContext=window;if(typeof eventName=="function"){try{eventName.call(evalContext,oControl,eArgs,eventType);window.GC_LastFiredEvent=eventType}catch(ex){return false}return true}if(eventName instanceof Array)for(var k=0;k<eventName.length;k++)Utility.FireEvent(oControl,eventName[k],eArgs,eventType);var eventItems=eventName.split(";");if(eventItems.length==0)return false;var isEventFired=false;try{window.__gcarg1=oControl;window.__gcarg2=eArgs;window.__gcarg3=eventType;for(var i=0;i<eventItems.length;i++){var sEventArgs=eventItems[i]+"(window['__gcarg1'], window['__gcarg2'], window['__gcarg3']);";try{if(eventItems[i].IndexOf("(")!=-1&&eventItems[i].IndexOf(")")!=-1)throw"command";eval(sEventArgs);isEventFired=true;window.GC_LastFiredEvent=eventType}catch(ex){try{Utility.EvalForControl.call(oControl,eventItems[i]);isEventFired=true}catch(e){window.status="Sorry! Can't fire the "+eventName+" client event.";return false}}}}finally{try{delete window.__gcarg1;delete window.__gcarg2;delete window.__gcarg3}catch(e){}}if(isEventFired==false){window.status="Sorry! Can't fire the "+eventName+" client event.";return false}return true};Utility.DetachEvent=function(a,c,b,d){if(a!==null&&a!==undefined)if(a.removeEventListener)a.removeEventListener(c,b,d);else a.detachEvent&&a.detachEvent("on"+c,b)};Utility.AttachEvent=function(b,a,c,d){if(b!==null&&b!==undefined)if(b.addEventListener&&b.attachEvent&&a==="propertychange")b.attachEvent("on"+a,c);else if(b.addEventListener){if(Utility.IsIE11OrLater)if(a.startWith("MSPointer")||a.startWith("MSGotPointer")||a.startWith("MSLostPointer")){a=a.substr(2);a=a.toLowerCase()}b.addEventListener(a,c,d)}else b.attachEvent&&b.attachEvent("on"+a,c)};Utility.GetBrowserType=function(){var a=navigator.userAgent.toLowerCase();if(window.ActiveXObject)Utility.ie=a.match(/msie ([\d.]+)/)[1];else if(a.indexOf("chrome")!=-1)Utility.chrome=a.match(/chrome\/([\d.]+)/)[1];else if(a.indexOf("safari")!=-1)Utility.safari=a.match(/version\/([\d.]+)/)[1];else if(a.indexOf("firefox")!=-1)Utility.firefox=a.match(/firefox\/([\d.]+)/)[1];else if(a.indexOf("opera")!=-1)Utility.opera=a.match(/opera.([\d.]+)/)[1];if(a.indexOf("ipad")!=-1)Utility.IPad=true;Utility.engine=null;if(window.navigator.appName=="Microsoft Internet Explorer")if(document.documentMode)Utility.engine=document.documentMode;else{Utility.engine=5;if(document.compatMode)if(document.compatMode=="CSS1Compat")Utility.engine=7;if(Utility.ie&&Utility.ie.indexOf("6")==0)Utility.engine=6}if(a.indexOf("rv:")!==-1&&a.indexOf("firefox")===-1)Utility.ie=Utility.engine=a.match(/rv:([\d.]+)/)[1]};Utility.GetAnimationTypeByTouch=function(a,e,b,f){var c=Utility.GetTouchPathX(a,e),d=Utility.GetTouchPathY(b,f),g=Math.abs(a-e),h=Math.abs(b-f);if(g>=h){if(c==="ToLeft")return AnimationType.ScrollToRight;else if(c==="ToRight")return AnimationType.ScrollToLeft}else if(d==="ToBottom")return AnimationType.ScrollToTop;else if(d==="ToTop")return AnimationType.ScrollToBottom;return null};Utility.GetTouchPathX=function(a,b){return a===-1||b===-1?"Error":a>b?a-b>20?"ToLeft":"NotMove":a<b?b-a>20?"ToRight":"NotMove":"NotMove"};Utility.GetTouchPathY=function(a,b){return a===-1||b===-1?"Error":a>b?a-b>20?"ToTop":"NotMove":a<b?b-a>20?"ToBottom":"NotMove":"NotMove"};Utility.IsPad=function(){return Utility.IPad||Utility.GetClientOS().toLowerCase()=="android"};Utility.IsTouch=function(){return Utility.IsIE&&window.navigator.msMaxTouchPoints>0};Utility.SetZoomStyle=function(a,b){if(a===undefined||a===null)return;var c="top left";if(Utility.firefox){a.style.MozTransformOrigin=b===""?"":c;a.style.MozTransform=b===""?"":"scale("+b+")";a.setAttribute("ZoomValue",b)}else if(Utility.chrome||Utility.safari)if(b!==""){a.style.MozTransform="scale("+b+")";a.style.WebkitTransform="scale("+b+")";a.style.webkitTransformOrigin=c}else{a.style.MozTransform="";a.style.WebkitTransform="";a.style.WebkitTransformOrigin=""}else if(Utility.IsIE9OrLater)if(b!==""){a.style.msTransform="scale("+b+")";a.style.msTransformOrigin=c}else{a.style.msTransform="";a.style.msTransformOrigin=""}else a.style.zoom=b};Utility.IsJapan=function(){var a=Utility.SpreadCulture;if(!a)a=Utility.ServerCulture;if(!a)a=navigator.userLanguage;if(!a)a=navigator.language;return a.indexOf("ja")!=-1};Utility.PreventDefault=function(a){if(a.preventDefault)a.preventDefault();else a.returnValue=false};Utility.PreventTouchZoom=function(b){if(Utility.IsPad()&&Utility.LastTouchStartTime){var a=(new Date).valueOf()-Utility.LastTouchStartTime.valueOf();a<500&&Utility.PreventDefault(b)}Utility.LastTouchStartTime=new Date};Utility.CancelBubble=function(a){if(a.stopPropagation)a.stopPropagation();else a.cancelBubble=true};Utility.GetClientOS=function(){var a;if(!Utility.IsIE){var b=navigator.userAgent,f=b.indexOf("("),g=b.indexOf(")");a=b.substring(f+1,g)}else a=navigator.appVersion;if(a.indexOf("NT 6.0")!=-1)return"vista";else if(a.indexOf("NT 5.2")!=-1)return"win2003";else if(a.indexOf("NT 5.1")!=-1)return"winxp";else if(a.indexOf("NT 5.0")!=-1)return"win2000";else if(a.indexOf("NT 6.1")!=-1)return"Win7";else if(a.indexOf("NT 6.2")!=-1)return"Win8";else if(a.indexOf("NT 6.3")!=-1)return"Win8";var c=a.indexOf("NT ");if(c>=0){var e=a.substr(c+3,3),d=parseFloat(e);if(d>=6.3)return"Win8"}return a.indexOf("Android")!=-1?"Android":"unknow"};Utility.CreateStyleElement=function(b){var a=document.createElement("style");a.id=b;a.type="text/css";return a};Utility.CreateClassStyle=function(a){return Utility.CreateSelectorStyle("."+a)};Utility.CreateSelectorStyle=function(e,c,g){c=c||"gc_imjs_styleelement";var a=document.getElementById(c);if(a==null){a=this.CreateStyleElement(c);document.body.appendChild(a)}var b=a.sheet||a.styleSheet,d=b.cssRules||b.rules;if(b.insertRule){var f=e+"{ }";if(g)f=e;b.insertRule(f,d.length)}else b.addRule(e,"{ }",d.length);return d.item(d.length-1)};Utility.GetMouseButton=function(b){var a=-1,c=Utility.IsIE8OrBelow?1:0;if(b.button==c)a=0;else if(b.button==1)a=1;else if(b.button==2)a=2;return a};Utility.GetPageZoomRate=function(){if(Utility.IsIE&&Utility.engine===8)return screen.deviceXDPI/screen.logicalXDPI;var c="gc_im_standard_control_for_get_normal_position",b=document.getElementById(c);if(!b){var a=document.createElement("div");document.body.appendChild(a);a.id=c;a.style.visibility="hidden";a.style.left="100px";a.style.top="1px";a.style.width="1px";a.style.height="1px";a.style.position="absolute";b=a}return b.offsetLeft/100};Utility.ToString=function(d,c,b,e){var a=d+"";if(b!=null){while(a.length<c)if(e)a=a+b;else a=b+a;return a}while(a.length<c)a+=d+"";return a};Utility.GetCurrentDate=function(){var a=new Date;a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);return a};Utility.CreateElement=function(b){var a=document.createElement(b);switch(b.toLowerCase()){case"table":a.style.borderCollapse="separate";a.style.margin="0px";break;case"td":a.style.padding="0px";break;case"input":a.style.margin="0px";if(Utility.chrome||Utility.safari)a.style.outline="none";break;case"textarea":if(Utility.chrome||Utility.safari)a.style.outline="none"}return a};Utility.GetSrcElement=function(a){return a.srcElement||a.target};Utility.IsStandCompliantModeOn=function(){return!Utility.IsIE?document.compatMode=="CSS1Compat"||document.compatMode=="BackCompat":document.compatMode=="CSS1Compat"};Utility.IsUndefined=function(a){return typeof a==="undefined"};Utility._commonOnLoadHandler=function(){if(Utility.firefox){window.addEventListener&&window.addEventListener("unload",function(){},false);Utility._addAutoCompleteToHidden()}Utility._attachResetNotifyForAllForms()};Utility._addAutoCompleteToHidden=function(){for(var c=document.getElementsByTagName("input"),b=0;b<c.length;b++){var a=c.item(b),d=a.id;if(a.type=="hidden")d.search("^__.+_State$")!=-1&&a.setAttribute("autocomplete","off")}};Utility.EvalForControl=function(args){eval(args)};Utility.Trim=function(a){return a.trim?a.trim():a.replace(/(^\s*)|(\s*$)/g,"")};Utility.AddClass=function(a,b){if(a.classList)for(var d=b.split(" "),c=0;c<d.length;c++)d[c]&&a.classList.add(d[c]);else if(a.className.indexOf(b)==-1)if(a.className=="")a.className+=b;else a.className+=" "+b};Utility.GetFontSizeUnitValue=function(a){if(typeof a==="number")return a;if(typeof a==="string")switch(a.toLowerCase()){case"smaller":return Utility.Unit2Pixel(10,"Point");case"larger":return Utility.Unit2Pixel(13.5,"Point");case"xx-small":return Utility.Unit2Pixel(7,"Point");case"x-small":return Utility.Unit2Pixel(7.5,"Point");case"small":return Utility.Unit2Pixel(10,"Point");case"medium":return Utility.Unit2Pixel(12,"Point");case"large":return Utility.Unit2Pixel(13.5,"Point");case"x-large":return Utility.Unit2Pixel(17,"Point");case"xx-large":return Utility.Unit2Pixel(24,"Point");default:if(parseInt(a,10)==a)return parseInt(a,10);var c=a.indexOf("px");if(c!=-1)return parseInt(a.substring(0,c),10);var b=a.indexOf("pt");if(b!=-1){var d=a.substring(0,b);return Utility.Unit2Pixel(d,"Point")}}return 0};Utility.Unit2Pixel=function(b,c){var a=-1;switch(c){case"Pica":a=12*b/72;break;case"Point":a=4*b/3}return a};Utility.ClearChildren=function(a){for(var b=a.childNodes.length-1;b>=0;b--)a.removeChild(a.childNodes.item(b))};Utility.Log=function(d,v,s,t){var a=document.getElementById("divDocumentLog"),c=null,b=null,i=false,j,k,l,m,r=600,D=d;if(v===true)try{try{var J=arguments.caller.caller}catch(K){r=Utility.IsPad()?800:1e3;var H=K.stack.indexOf("at"),g=K.stack;g=g.substring(H,g.length);d=d+"\r\n  ====================================  CallStack  ================================";d=d+"\r\n   "+g;d=d+"\r\n  ================================================================================="}}catch(K){d=D+"\r\n CallStack Error : "+K.message||K}if(a===null){a=document.createElement("div");c=document.createElement("textarea");b=document.createElement("div");var B=h("Clear",C),E=h("Hide",F),z=h("Suspend",y);a.id="divDocumentLog";a.style.width=r+"px";a.style.height="250px";a.style.position="absolute";a.style.zIndex="100000";a.style.left=typeof s==="undefined"?"330px":s+"px";a.style.top=typeof t==="undefined"?"80px":t+"px";c.id="lstDocumentLog";c.style.width="100%";c.style.height="100%";c.readOnly="readonly";c.style.backgroundColor="lightblue";b.style.width="100%";b.style.height="50px";b.style.cursor="move";b.style.border="black solid 1px";b.style.backgroundColor="lightgray";Utility.AttachEvent(b,"mousedown",e,false);Utility.AttachEvent(b,"mousedown",e,false);Utility.AttachEvent(document,"mousemove",p,false);Utility.AttachEvent(b,"mouseup",q,false);Utility.AttachEvent(b,"mousedown",e,false);Utility.AttachEvent(b,"touchstart",u,false);Utility.AttachEvent(b,"touchmove",w,false);Utility.AttachEvent(b,"touchend",x,false);b.appendChild(B);b.appendChild(E);b.appendChild(z);a.appendChild(b);a.appendChild(c);document.body.appendChild(a)}var G=a.getAttribute("Suspend");if(G==="Suspend")return;c=document.getElementById("lstDocumentLog");a.style.display="";var f=new Date,A=f.getHours()+":"+f.getMinutes()+":"+f.getSeconds()+":"+f.getMilliseconds(),I="[ "+A+" ]  "+d;c.value=I+"\r\n"+c.value;function h(c,b){var a=document.createElement("input");a.type="button";a.value=c;a.style.width="80px";a.style.height="50px";Utility.AttachEvent(a,"click",b,false);return a}function C(){c.value=""}function F(){a.style.display="none"}function y(d){var b=Utility.GetSrcElement(d),c=a.getAttribute("Suspend");if(c==="Suspend"){a.setAttribute("Suspend","");b.value="Suspend"}else{a.setAttribute("Suspend","Suspend");b.value="Resume"}}function e(b){i=true;j=n(b);k=o(b);l=parseInt(a.style.left);m=parseInt(a.style.top)}function p(b){if(i===false)return;var c=n(b),d=o(b);a.style.left=l+(c-j)+"px";a.style.top=m+(d-k)+"px"}function q(){i=false;j=-1;k=-1;l=-1;m=-1}function u(a){e(a)}function w(a){p(a);Utility.PreventDefault(a)}function x(a){q(a)}function n(a){var b=a.clientX;if(a.touches)if(a.touches.length>0)b=a.touches[0].clientX;return b}function o(a){var b=a.clientY;if(a.touches)if(a.touches.length>0)b=a.touches[0].clientY;return b}};Utility.CheckInt=function(b,d,c){var a=parseInt(b,10);if(isNaN(a))throw"value is invalid";if(typeof d!=="undefined"&&a<d)throw b+" should great than "+d;if(typeof c!=="undefined"&&a>c)throw b+" should less than "+c;return a};Utility.CheckFloat=function(a,d,c){var b=parseFloat(a);if(isNaN(b))throw"value is invalid";if(a<d||a>c)throw a+" is out of range, should between "+d+" and "+c;return b};Utility.CheckDate=function(a,c,b){if(!(Date&&a instanceof Date))throw"Type is invalid";if(isNaN(a))throw"Date is a invalid date";if(typeof b!="undefined")if(a<c||a>b)throw a+" is out of range, should between "+c+" and "+b;return a};Utility.CheckBool=function(a){if(typeof a==="string"){if(a.toLowerCase()==="true")return true;if(a.toLowerCase()==="false")return false}return a==true};Utility.GetCheckElement=function(){if(Utility.CheckElement==null){var a=document.createElement("div");Utility.CheckElement=a;a.style.display="none"}return Utility.CheckElement};Utility.CheckFunction=function(a){return a};Utility.CheckString=function(a){if(typeof a==="undefined"||typeof a!="string"&&!(a instanceof String))throw a+" type is not a string.";if(a==null)a="";return a.toString()};Utility.GetCSSLength=function(b){var a=parseInt(b,10);return isNaN(a)?0:a};Utility.CheckCSSLength=function(a,b){var c=false;if(b===true){var d=/^\d+%$/;c=typeof a==="string"&&d.test(a)}if(!b||!c){a=Utility.CheckInt(a,0);if(parseInt(a,10)==a)a+="px"}Utility.GetCheckElement().style.width="";Utility.GetCheckElement().style.width=a;return Utility.GetCheckElement().style.width};Utility.CheckFontSizeValue=function(a){if(parseFloat(a)==a)a+="px";Utility.GetCheckElement().style.fontSize="";Utility.GetCheckElement().style.fontSize=a;return Utility.GetCheckElement().style.fontSize};Utility.CheckColor=function(a){Utility.GetCheckElement().style.backgroundColor="";try{Utility.GetCheckElement().style.backgroundColor=a}catch(b){}return Utility.GetCheckElement().style.backgroundColor};Utility.GetCssImageUrl=function(a){if(a.startWith('url("'))a=a.substring(5,a.length-2);else if(a.startWith("url("))a=a.substring(4,a.length-1);return a};Utility.CheckCssImageUrl=function(a){if(a.length>0&&!a.startWith("url("))a="url("+a+")";Utility.GetCheckElement().style.backgroundImage="";Utility.GetCheckElement().style.backgroundImage=a;return Utility.GetCheckElement().style.backgroundImage};Utility.CheckEnum=function(b,a){if(b==HorizontalAlignment&&a&&a.toString()==="notset")return HorizontalAlignment.NotSet;if(b==VerticalAlignment&&a&&a.toString()==="notset")return VerticalAlignment.NotSet;if(b===Cursor&&a===Cursor.Hand)return Cursor.Pointer;for(var c in b)if(b[c]==a||b[c].toString().toLowerCase()==a.toString().toLowerCase())return b[c];throw"Enum value is invalid";};Utility.CreateInnerTable=function(c,b){var a=Utility.CreateElement("table");if(c){a.style.width=c+"px";a.style.maxWidth=c+"px";a.style.minWidth=c+"px"}if(b){a.style.height=b+"px";a.style.maxHeight=b+"px";a.style.minHeight=b+"px"}a.setAttribute("cellSpacing","0");return a};Utility.CreateInnerTbody=function(){return Utility.CreateElement("tbody")};Utility.CreateInnerDiv=function(c,b){var a=Utility.CreateElement("div");a.style.overflow="hidden";if(c)a.style.width=c+"px";if(b)a.style.height=b+"px";return a};Utility.CreateInnerTextNode=function(a){return Utility.CreateTextNode(a)};Utility.CreateInnerImage=function(e,c,b,d){var a=Utility.CreateElement("img");a.setAttribute("src",e);a.style.display="block";if(d)a.style.verticalAlign=d;if(c!=undefined){c=c<0?0:c;a.style.width=c+"px"}if(b!=undefined){b=b<0?0:b;a.style.height=b+"px"}Utility.AttachEvent(a,"dragstart",function(a){Utility.PreventDefault(a)},false);return a};Utility.CreateInnerTableRow=function(){var a=Utility.CreateElement("tr");a.style.padding="0px";return a};Utility.CreateInnerTableCell=function(d,c,b){var a=Utility.CreateElement("td");if(typeof c!=="undefined"){a.style.width=c+"px";a.style.maxWidth=c+"px";a.style.minWidth=c+"px"}if(typeof b!=="undefined"){a.style.height=b+"px";a.style.maxHeight=b+"px";a.style.minHeight=b+"px"}if(typeof d!=="undefined")a.className=d;return a};Utility.GetMultipleStringEnum=function(b){var a=b.toString().split(" ");a.sort();return a.join(",")};Utility.CheckMultipleStringEnum=function(f,b){var a=b.split(","),d=[];if(a.length===1)if(a[0]===b){var e=b.split(" ");if(e.length>1)return b}for(var c=0;c<a.length;c++)d.push(Utility.CheckEnum(f,Utility.Trim(a[c])));return d.join(" ")};Utility.EncodingTextForCreateTextCode=function(a){if(a&&Utility.IsJapan())while(a.indexOf(" ")!=-1)a=a.replace(" "," ");return a};Utility.CreateTextNode=function(a){return document.createTextNode(Utility.EncodingTextForCreateTextCode(a))};Utility.AddIMControl=function(b,a){Utility._iMControlList[b]=a};Utility.RemoveIMControl=function(a){try{Utility._iMControlList[a]=null;delete Utility._iMControlList[a]}catch(b){}};Utility.onMSPointerDown=function(a){Utility.IsTouchMouseDown=a.pointerType===a.MSPOINTER_TYPE_TOUCH||a.pointerType==="touch"};Utility.onTouchStart=function(){Utility.IsTouchMouseDown=true;Utility.ignoreTouchMouseDown=true};Utility.onMouseDown=function(){if(Utility.ignoreTouchMouseDown!==true)Utility.IsTouchMouseDown=false;Utility.ignoreTouchMouseDown=false};Utility.GetClientControlEffect=function(){if(Utility.ClientControlEffectCache!==null)return Utility.ClientControlEffectCache;var a=ControlEffect.Normal;if(Utility.IPad)a=ControlEffect.Ipad;else if(Utility.chrome)a=ControlEffect.Chrome;else switch(Utility.GetClientOS()){case"winxp":a=ControlEffect.Windows8Theme;break;case"vista":a=ControlEffect.VistaTheme;break;case"Win7":if(Utility.IsIE10OrLater)a=ControlEffect.Windows8Theme;else a=ControlEffect.VistaTheme;break;case"Win8":a=ControlEffect.Windows8Theme}Utility.ClientControlEffectCache=a;return a};Utility.FindIMControl=function(b){var a=Utility._iMControlList[b];if(a===undefined)a=null;return a};Utility.MeasureText=function(d,b,c,a){return TextMeasure.MeasureText(d,b,c,a)};Utility.IsEnumFlagSet=function(b,a){return(b&a)==a};Utility.FindParentElementByType=function(c,b){var a=c;while(a!=null){if(a.nodeType==1&&a.nodeName.toLowerCase()===b)return a;a=a.parentNode}return null};Utility._attachResetNotifyForAllForms=function(){var a=document.forms;if(a==null)return;for(var b=0;b<a.length;b++)Utility.AttachEvent(a[b],"reset",Utility._onReset)};Utility._onReset=function(b){var a=b.target||b.srcElement;if(b.returnValue===false||a.onreset&&!a.onreset())return;for(var c=0;c<Utility._onResetAwareElementList.length;c++){var e=Utility._onResetAwareElementList[c],d=e.Element,f=Utility.FindParentElementByType(d._getContainer(),"form");f===a&&e.Callback.call(d)}};Utility.Hold="g-C2";Utility.DefaultControlStyle="default-controlfont";Utility.IMControlIDAttribute="IMControlID";Utility._iMControlList={};Utility.BaseImageUrl="../../Source/Images/";Utility.IsTouchMouseDown=false;Utility.ServerCulture="";Utility.SpreadCulture="En";Utility._onLoadCallBackList=[];Utility.ClientControlEffectCache=null;Utility._onResetAwareElementList=[];Utility.HighlightColor="highlight";Utility.imageCacheList={};return Utility}();GCIMCalendar.Utility=Utility;var TextMeasure=function(){function a(){}a._getFromCache=function(b){return a._measureCache[b]};a._addCache=function(c,b){if(a._cacheCount>2e3){a._measureCache={};a._cacheCount=0}a._cacheCount++;a._measureCache[c]=b};a._createMeasureElement=function(){if(a._measureElement==null){var b=document.createElement("div");b.style.position="absolute";b.style.border="solid 0px";b.style.left="-100000px";b.style.top="-100000px";var c=Utility.CreateTextNode("");b.appendChild(c);document.body.appendChild(b);a._measureElement=b;a._measureTextElement=c}};a._realMeasure=function(n,h,l,k,i,g,j){var b=a._measureElement,f=a._measureTextElement;b.style.fontFamily=h;b.style.fontSize=l;b.style.fontStyle=k;b.style.fontWeight=i;b.style.textDecoration=g;b.style.lineHeight=j;f.nodeValue=n;var c,e,d;if(b.getBoundingClientRect){c=b.getBoundingClientRect();if(c.width!==undefined){e=Math.ceil(c.width);d=Math.ceil(c.height)}else{e=Math.ceil(c.right-c.left);d=Math.ceil(c.bottom-c.top)}}else{e=b.clientWidth;d=b.clientHeight}var m={Width:e,Height:d};if(!Utility.IsPad())f.nodeValue="";return m};a.MeasureText=function(q,d,v,n){a._createMeasureElement();var w=d.parentNode,e=d,s=document.body.contains(d);if(!s){e=d.cloneNode(true);document.body.appendChild(e)}var c=e.currentStyle||window.getComputedStyle(e,null),h=c.fontFamily,l=c.fontSize,k=c.fontStyle,i=c.fontWeight,g=c.textDecoration,j=c.lineHeight===""?"normal":c.lineHeight;!s&&document.body.removeChild(e);var t=[q,h,l,k,i,g,j].join("_"),o=a._getFromCache(t);if(o!==undefined)return{Width:o.Width,Height:o.Height};var f;if(v){for(var r=q.split("\n"),u=0,p=0,m=0;m<r.length;m++){var b=a._realMeasure(r[m],h,l,k,i,g,j,d);if(r[m]==="")b.Height=a._realMeasure("1",h,l,k,i,g,j,d).Height;if(b.Width>n){b.Height=(Math.floor(b.Width/n)+1)*b.Height;b.Width=n}u+=b.Height;if(p<b.Width)p=b.Width}f={Width:p,Height:u}}else f=a._realMeasure(q,h,l,k,i,g,j,d);a._addCache(t,f);return{Width:f.Width,Height:f.Height}};a._measureCache={};a._cacheCount=0;return a}();Utility.GetBrowserType();Utility.Init();window.FindIMControl=function(a){return Utility.FindIMControl(a)};var HtmlElementHelper=function(){function a(){}a.GenerateElementTempID=function(){if(a._elementTempID==null)a._elementTempID=-1;a._elementTempID++;return"GrapeCityTempID"+a._elementTempID.toString()};a.GetRadioControlID=function(d,c){var a=document.getElementById(c[d].ID),e=a.name;if(a.checked==true)return d;for(var b=0;b<c.length;b++){a=document.getElementById(c[b].ID);if(a.type=="radio")if(a.checked==true)return b}return d};a.GetAllElements=function(a){if(document.body.querySelectorAll){var b=a?a:"button, input, object, select, textarea";return document.body.querySelectorAll(b)}return Utility.IsIE?document.body.all:document.body.getElementsByTagName("*")};a.ElementsSort=function(a,b){return a.TabIndex===b.TabIndex?0:a.TabIndex<b.TabIndex?-1:1};a.GetSortedElements=function(){var b=a.GetElements();return b.sort(a.ElementsSort)};a.GetElements=function(){for(var f=[],g="button,input,object,select,textarea,div",i=g.split(","),c=a.GetAllElements(g),j=0,b=0;b<c.length;b++){if(c[b].disabled||c[b].style.visibility==="hidden"||c[b].type==="hidden"||c[b].style.display==="none")continue;if(c[b].tagName==="DIV"){var e=c[b].getAttribute("iMControlType");if(e!=="Calculator"&&e!=="Calendar"&&e!=="ListBox")continue}else{var h=c[b].getAttribute("isCalculatorButton");if(h==="true")continue}if(i.indexOf(c[b].tagName.toLowerCase())!==-1){var d={};d.ElementObj=c[b];d.ID=c[b].id;d.TabIndex=c[b].tabIndex;f[j++]=d}}return f};return a}();GCIMCalendar.HtmlElementHelper=HtmlElementHelper;var CSSHelper=function(){function a(){}a.SetTouchAction=function(a,b){if(a==null)return;if(Utility.IsIE10)a.msTouchAction=b;else if(Utility.IsIE11OrLater)a.touchAction=b};return a}();GCIMCalendar.CSSHelper=CSSHelper;var AnimationSettting=function(){function a(){this.FadeType=FadeType.FadeIn}return a}();GCIMCalendar.AnimationSettting=AnimationSettting;var Animation=function(){function a(b,a){this._type=null;this._animation=null;this._element=null;this._elementOld=null;this.onAnimationComplete=null;this.onFirstAnimationComplete=null;this.Setting=new AnimationSettting;if(typeof b!=="undefined"&&typeof a!=="undefined"){this._type=b;this._element=a;this._animation=this._getAnimation()}}a.prototype.Show=function(a,c,b){if(this.IsBusy)return;if(typeof a!=="undefined"){this._type=a;this._element=c;this._elementOld=b;this._animation=this._getAnimation()}if(this._animation===null)return;this.IsBusy=true;this._updateAnimationBeginDate();this._animation._initContainer();this._animation._initData();this._animation._doAnimation()};a.prototype._updateAnimationBeginDate=function(){this._animationBeginDate=new Date};a.prototype._animationComplete=function(){this.IsBusy=false;this.onAnimationComplete!==null&&typeof this.onAnimationComplete==="function"&&this.onAnimationComplete.call(this)};a.prototype._firstAnimationComplete=function(){this.onFirstAnimationComplete!==null&&typeof this.onFirstAnimationComplete==="function"&&this.onFirstAnimationComplete.call(this)};a.prototype._getAnimation=function(){if(typeof this._element==="undefined"||typeof this._type==="undefined")return null;switch(this._type){case AnimationType.ScrollToLeft:return new ScrollToLeftAnimation(this);break;case AnimationType.ScrollToRight:return new ScrollToRightAnimation(this);break;case AnimationType.ScrollToTop:return new ScrollToTopAnimation(this);break;case AnimationType.ScrollToBottom:return new ScrollToBottomAnimation(this);break;case AnimationType.Fade:return new FadeAnimation(this)}return null};return a}();GCIMCalendar.Animation=Animation;var BaseAnimation=function(){function a(a){this._owner=a;this._element=a._element;this._elementOld=a._elementOld;this._elementParent=a._element.parentElement;this._elementWidth=a._element.clientWidth;this._elementHeight=a._element.clientHeight;this._elementTop=a._element.style.posTop||parseInt(a._element.style.top);this._elementLeft=a._element.style.posLeft||parseInt(a._element.style.left)}a.prototype._animationType=function(){return null};a.prototype._initContainer=function(){this._div=Utility.CreateInnerDiv();this._table=Utility.CreateInnerTable();this._elementParent.appendChild(this._table)};a.prototype._initData=function(){this._frameTo=0;this._frameCurrent=0;this._isFirstAnimationComplate=true};a.prototype._doAnimation=function(){var a=this;if(this._useCss()){this._doCssAnimation();return}if(this._frameTo===this._frameCurrent)if(this._isFirstAnimationComplate){this._lastFrame();this._animationComplete();return}else{this._isFirstAnimationComplate=true;this._firstAnimationComplete()}this._nextFrame();setTimeout(function(){a._doAnimation()},0)};a.prototype._getDurationPercent=function(){var b=new Date,a=b.valueOf()-this._owner._animationBeginDate.valueOf();return Math.min(a/this._duration(),1)};a.prototype._doCssAnimation=function(){var a=this._cssName();if(Utility.IsIE10OrLater){this._table.style.animation=a;this._table.style.animationFillMode="forwards"}else if(Utility.chrome||Utility.safari)this._table.className=a};a.prototype._duration=function(){return Utility.IsPad()?400:300};a.prototype._useCss=function(){return false};a.prototype._cssName=function(){return""};a.prototype._nextFrame=function(){var a=this._getDurationPercent();if(this._frameTo>this._frameCurrent)this._frameCurrent=Math.min(this._frameBegin+this._totalOffset*a,this._frameTo);else this._frameCurrent=Math.max(this._frameBegin-this._totalOffset*a,this._frameTo)};a.prototype._lastFrame=function(){this._frameCurrent=this._frameTo};a.prototype._animationComplete=function(){this._owner._animationComplete()};a.prototype._firstAnimationComplete=function(){this._owner._firstAnimationComplete()};a.prototype._setTransform=function(b,c){var a="translate("+b.toString()+"px,"+c+"px)";if(Utility.IsIE10OrLater)this._table.style.transform=a;else if(Utility.IsIE9)this._table.style.msTransform=a;else if(Utility.IsIE8OrBelow){this._table.style.position="relative";this._table.style.left=b.toString()+"px";this._table.style.top=c.toString()+"px"}else if(Utility.chrome||Utility.safari){this._table.style.MozTransform=a;this._table.style.WebkitTransform=a}};return a}();GCIMCalendar.BaseAnimation=BaseAnimation;var BaseScrollAnimation=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype._initContainer=function(){this._table=Utility.CreateInnerTable();this._table.style.position="relative";this._div=Utility.CreateInnerDiv();this._div.style.width=this._elementWidth+"px";this._div.style.height=this._elementHeight+"px";this._div.style.overflow="hidden";this._div.appendChild(this._table);this._elementParent.appendChild(this._div);this._cell1=Utility.CreateInnerTableCell();this._cell2=Utility.CreateInnerTableCell()};a.prototype._initData=function(){this._frameBegin=this._frameCurrent;this._totalOffset=Math.abs(this._frameTo-this._frameCurrent)};a.prototype._nextFrame=function(){b.prototype._nextFrame.call(this);this._element.style.opacity=this._getDurationPercent().toString();this._elementOld.style.opacity=(1-this._getDurationPercent()).toString()};a.prototype._animationComplete=function(){this._elementParent.appendChild(this._element);this._elementParent.removeChild(this._div);delete this._div;b.prototype._animationComplete.call(this)};return a}(BaseAnimation);GCIMCalendar.BaseScrollAnimation=BaseScrollAnimation;var ScrollToLeftAnimation=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype._animationType=function(){return AnimationType.ScrollToLeft};a.prototype._initContainer=function(){b.prototype._initContainer.call(this);var a=Utility.CreateInnerTableRow();this._table.appendChild(a);a.appendChild(this._cell1);a.appendChild(this._cell2);this._cell1.appendChild(this._element);this._cell2.appendChild(this._elementOld)};a.prototype._initData=function(){this._frameTo=0;this._frameCurrent=this._elementWidth*-1;b.prototype._initData.call(this)};a.prototype._cssName=function(){return Utility.chrome||Utility.safari?"ScrollToLeft":"ScrollToLeft_IE 0.5s"};a.prototype._nextFrame=function(){b.prototype._nextFrame.call(this);this._setTransform(this._frameCurrent,0)};return a}(BaseScrollAnimation);GCIMCalendar.ScrollToLeftAnimation=ScrollToLeftAnimation;var ScrollToRightAnimation=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype._animationType=function(){return AnimationType.ScrollToRight};a.prototype._initContainer=function(){b.prototype._initContainer.call(this);var a=Utility.CreateInnerTableRow();this._table.appendChild(a);a.appendChild(this._cell1);a.appendChild(this._cell2);this._cell1.appendChild(this._elementOld);this._cell2.appendChild(this._element)};a.prototype._initData=function(){this._frameTo=this._elementWidth*-1;this._frameCurrent=0;b.prototype._initData.call(this)};a.prototype._cssName=function(){return Utility.chrome||Utility.safari?"ScrollToRight":"ScrollToRight_IE 0.5s"};a.prototype._nextFrame=function(){b.prototype._nextFrame.call(this);this._setTransform(this._frameCurrent,0)};return a}(BaseScrollAnimation);GCIMCalendar.ScrollToRightAnimation=ScrollToRightAnimation;var ScrollToTopAnimation=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype._animationType=function(){return AnimationType.ScrollToTop};a.prototype._initContainer=function(){b.prototype._initContainer.call(this);var a=Utility.CreateInnerTableRow(),c=Utility.CreateInnerTableRow();this._cell1.appendChild(this._element);this._cell2.appendChild(this._elementOld);a.appendChild(this._cell1);c.appendChild(this._cell2);this._table.appendChild(a);this._table.appendChild(c)};a.prototype._initData=function(){this._frameTo=0;this._frameCurrent=this._elementHeight*-1;b.prototype._initData.call(this)};a.prototype._cssName=function(){return Utility.chrome||Utility.safari?"ScrollToTop":"ScrollToTop_IE 0.5s"};a.prototype._nextFrame=function(){b.prototype._nextFrame.call(this);this._setTransform(0,this._frameCurrent)};return a}(BaseScrollAnimation);GCIMCalendar.ScrollToTopAnimation=ScrollToTopAnimation;var ScrollToBottomAnimation=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype._animationType=function(){return AnimationType.ScrollToBottom};a.prototype._initContainer=function(){b.prototype._initContainer.call(this);var a=Utility.CreateInnerTableRow(),c=Utility.CreateInnerTableRow();this._table.appendChild(a);this._table.appendChild(c);a.appendChild(this._cell1);c.appendChild(this._cell2);this._cell1.appendChild(this._elementOld);this._cell2.appendChild(this._element)};a.prototype._initData=function(){this._frameTo=this._elementHeight*-1;this._frameCurrent=0;b.prototype._initData.call(this)};a.prototype._cssName=function(){return Utility.chrome||Utility.safari?"ScrollToBottom":"ScrollToBottom_IE 0.5s"};a.prototype._nextFrame=function(){b.prototype._nextFrame.call(this);this._setTransform(0,this._frameCurrent)};return a}(BaseScrollAnimation);GCIMCalendar.ScrollToBottomAnimation=ScrollToBottomAnimation;var FadeAnimation=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype._animationType=function(){return AnimationType.Fade};a.prototype._initContainer=function(){if(typeof this._elementOld!=="undefined"&&this._owner.Setting.FadeType===FadeType.FadeInOut){this._oldDisplay=this._element.style.display;this._element.style.display="none";this._element.style.opacity=0;this._elementParent.appendChild(this._elementOld)}};a.prototype._initData=function(){b.prototype._initData.call(this);switch(this._owner.Setting.FadeType){case FadeType.FadeIn:this._frameCurrent=0;this._frameTo=1;break;case FadeType.FadeOut:this._frameCurrent=1;this._frameTo=0;break;case FadeType.FadeInOut:this._frameCurrent=1;this._frameTo=0;this._isFirstAnimationComplate=false}this._frameBegin=this._frameCurrent;this._totalOffset=Math.abs(this._frameTo-this._frameCurrent)};a.prototype._firstAnimationComplete=function(){this._frameCurrent=0;this._frameTo=1;this._owner._updateAnimationBeginDate();this._frameBegin=this._frameCurrent;this._totalOffset=Math.abs(this._frameTo-this._frameCurrent);if(typeof this._elementOld!=="undefined"&&this._owner.Setting.FadeType===FadeType.FadeInOut){this._elementParent.removeChild(this._elementOld);this._element.style.display=this._oldDisplay}};a.prototype._cssName=function(){return Utility.chrome||Utility.safari?"Fade":"Fade_IE 1s"};a.prototype._nextFrame=function(){b.prototype._nextFrame.call(this);if(typeof this._elementOld!=="undefined"&&this._owner.Setting.FadeType===FadeType.FadeInOut&&!this._isFirstAnimationComplate)this._elementOld.style.opacity=this._frameCurrent;else this._element.style.opacity=this._frameCurrent};return a}(BaseAnimation);GCIMCalendar.FadeAnimation=FadeAnimation;var Component=function(){function a(b,c,a){this._isLoadingOldControlData=0;this._isDoingDispose=0;this._initingServerData=false;this._disposed=false;this._specialClientEvents={};this._standardClientEvents={};this._initContainerAndID(b,c,a)}a.prototype._initContainerAndID=function(c,a,d){if(d)if(c===undefined||c===null)throw"'container' can't be null.";if(a===null||a===undefined)a=c.id;if(a==="")a=this._createUniqueId();var b=Utility.FindIMControl(a);if(b){this._oldControlData=this._saveOldControlData(b);b._isDoingDispose++;try{b._doDispose()}finally{b._isDoingDispose--}}Utility.AddIMControl(a,this);this._id=a;this._container=c};a.prototype._createUniqueId=function(){a.TotalCount++;return this._getComponentType()+a.TotalCount};a.prototype._getComponentType=function(){throw"abstract method called";};a.prototype._dispose=function(){Utility.RemoveIMControl(this._id)};a.prototype._doDispose=function(){try{if(!this._disposed){this._disposed=true;this._dispose()}}catch(a){}};a.prototype._getId=function(){return this._id};a.prototype._getServerUniqueId=function(){return this._serverUniqueId||this._id};a.prototype._getContainer=function(){return this._container};a.prototype._setContainerDirectly=function(a){this._container=a};a._getImageExtends=function(b){var a;if(Utility.IsIE8OrBelow)a=b;else a=".svg";return a};a.prototype._saveOldControlData=function(){return{}};a.prototype._loadOldControlData=function(){};a.prototype._canFireEvent=function(){return!this._initingServerData&&!this._isLoadingOldControlData&&!this._isDoingDispose};a.TotalCount=-1;return a}();GCIMCalendar.Component=Component;var Control=function(b){__extends(a,b);function a(c,d,a){b.call(this,c,d,a);this._isInited=false;this._beginInit();this._createUIRender();this._createUIProcess();this._renderHtmlElement();this._endInit();this._registEvent();this._updateLayout()}a.prototype._beginInit=function(){this._isInited=false;this._autoPostBack=false;this._backColor="";this._backgroundImageUrl="";this._foreColor="";this._borderColor="";this._borderStyle=LineStyle.NotSet;this._borderWidth="";this._fontFamily="";this._fontSize="";this._fontStyle=FontStyle.NotSet;this._fontWeight=FontWeight.NotSet;this._textDecoration=TextDecoration.NotSet;this._autoSize=false;this._cursor=Cursor.NotSet;this._enabled=true;this._visible=true;this._controlEffect=ControlEffect.NotSet;this._xpTheme=XPTheme.Default;this._touchContextMenuScale=1.5};a.prototype._createUIRender=function(){};a.prototype._createUIProcess=function(){};a.prototype._renderHtmlElement=function(){};a.prototype._endInit=function(){this._isInited=true};a.prototype._registEvent=function(){Utility.AttachEvent(this._getContainer(),"touchstart",function(a){Utility.PreventTouchZoom(a)},false)};a.prototype._updateLayout=function(){};a.prototype._setLayoutStyle=function(a){a=a||this._getContainer();if(this._position!==undefined)a.style.position=this._position;if(this._left!==undefined)a.style.left=this._left;if(this._top!==undefined)a.style.top=this._top;if(this._right!==undefined)a.style.right=this._right;if(this._bottom!==undefined)a.style.bottom=this._bottom;if(this._marginTop!==undefined)a.style.marginTop=this._marginTop+"px";if(this._marginRight!==undefined)a.style.marginRight=this._marginRight+"px";if(this._marginBottom!==undefined)a.style.marginBottom=this._marginBottom+"px";if(this._marginLeft!==undefined)a.style.marginLeft=this._marginLeft+"px"};a.GetEnableChromeThemeOutline=function(){return this._enableChromeThemeOutline};a.SetEnableChromeThemeOutline=function(a){this._enableChromeThemeOutline=a};a.prototype._clearLayoutStyle=function(a){a=a||this._getContainer();a.style.position="";a.style.left="";a.style.top="";a.style.right="";a.style.bottom="";a.style.marginTop="";a.style.marginRight="";a.style.marginBottom="";a.style.marginLeft=""};a.prototype._setServerAttribute=function(b){b=b||this._getContainer();if(this._attributes)for(var a=0;a<this._attributes.length;a++){var c=this._attributes[a].Key;if(c.toLowerCase()=="class")Utility.AddClass(b,this._attributes[a].Value);else b.setAttribute(this._attributes[a].Key,this._attributes[a].Value)}};a.prototype._setClassAttrbute=function(b,a){a=a||this._getContainer();Utility.AddClass(a,b)};a.prototype._getDefaultSize=function(){throw"abstract method called";};a.prototype.GetTouchContextMenuScale=function(){return this._touchContextMenuScale};a.prototype.SetTouchContextMenuScale=function(a){a=Utility.CheckFloat(a,1,4);if(a!==this._touchContextMenuScale){var b=this._touchContextMenuScale;this._touchContextMenuScale=a;this._onTouchContextMenuScaleChanged(b,a)}};a.prototype._onTouchContextMenuScaleChanged=function(){};a.prototype.GetBackColor=function(){return this._backColor};a.prototype.SetBackColor=function(a){a=Utility.CheckColor(a);if(a!==this._backColor){var b=this._backColor;this._backColor=a;this._onBackColorChanged(b,a)}return this};a.prototype._onBackColorChanged=function(){};a.prototype.GetBackgroundImageUrl=function(){return Utility.GetCssImageUrl(this._backgroundImageUrl)};a.prototype.SetBackgroundImageUrl=function(a){a=Utility.CheckCssImageUrl(a);if(a!==this._backgroundImageUrl){var b=this._backgroundImageUrl;this._backgroundImageUrl=a;this._onBackgroundImageUrlChanged(b,a)}};a.prototype._onBackgroundImageUrlChanged=function(){};a.prototype.GetForeColor=function(){return this._foreColor};a.prototype.SetForeColor=function(a){a=Utility.CheckColor(a);if(a!==this._foreColor){var b=this._foreColor;this._foreColor=a;this._onForeColorChanged(b,a)}return this};a.prototype._onForeColorChanged=function(){};a.prototype._setForeColorDirectly=function(a){this._foreColor=a};a.prototype.GetBorderColor=function(){return this._borderColor};a.prototype.SetBorderColor=function(a){a=Utility.CheckColor(a);if(a!==this._borderColor){var b=this._borderColor;this._borderColor=a;this._onBorderColorChanged(b,a)}return this};a.prototype._getAutoPostBack=function(){return this._autoPostBack};a.prototype._setAutoPostBack=function(a){a=Utility.CheckBool(a);this._autoPostBack=a};a.prototype._onBorderColorChanged=function(){};a.prototype.GetBorderStyle=function(){return this._borderStyle};a.prototype.SetBorderStyle=function(a){a=Utility.CheckEnum(LineStyle,a);if(a!==this._borderStyle){var b=this._borderStyle;this._borderStyle=a;this._onBorderStyleChanged(b,a)}return this};a.prototype._onBorderStyleChanged=function(){};a.prototype.GetBorderWidth=function(){return this._borderWidth};a.prototype.SetBorderWidth=function(a){var c=this._borderWidth===""||this._borderWidth==null?"":Utility.CheckCSSLength(this._borderWidth),b=a===""||a==null?"":Utility.CheckCSSLength(a);if(b!==c){this._borderWidth=a;this._onBorderWidthChanged(c,b)}};a.prototype._onBorderWidthChanged=function(){};a.prototype.GetFont=function(){var a=new UserFont;a.Name=this.GetFontFamily();a.Size=this.GetFontSize();a.Bold=this.GetFontWeight();a.Italic=this.GetFontStyle();a.ParseTextDecorationString(this.GetTextDecoration());return a};a.prototype.SetFont=function(a){this.SetFontFamily(a.Name);this.SetFontSize(a.Size);this.SetFontWeight(a.Bold);this.SetFontStyle(a.Italic);this.SetTextDecoration(UserFont.GetTextDecorationStringFromObj(a));return this};a.prototype.GetFontFamily=function(){return this._fontFamily};a.prototype.SetFontFamily=function(a){a=Utility.CheckString(a);if(a!==this._fontFamily){var b=this._fontFamily;this._fontFamily=a;this._onFontFamilyChanged(b,a)}};a.prototype._onFontFamilyChanged=function(){};a.prototype.GetFontSize=function(){return this._fontSize};a.prototype.SetFontSize=function(a){a=Utility.CheckFontSizeValue(a);if(a!==this._fontSize){var b=this._fontSize;this._fontSize=a;this._onFontSizeChanged(b,a)}};a.prototype._onFontSizeChanged=function(){};a.prototype.GetFontStyle=function(){return this._fontStyle};a.prototype.SetFontStyle=function(a){a=Utility.CheckEnum(FontStyle,a);if(a!==this._fontStyle){var b=this._fontStyle;this._fontStyle=a;this._onFontStyleChanged(b,a)}};a.prototype._onFontStyleChanged=function(){};a.prototype.GetFontWeight=function(){return this._fontWeight};a.prototype.SetFontWeight=function(a){a=Utility.CheckEnum(FontWeight,a);if(a!==this._fontWeight){var b=this._fontWeight;this._fontWeight=a;this._onFontWeightChanged(b,a)}};a.prototype._onFontWeightChanged=function(){};a.prototype.GetTextDecoration=function(){return Utility.GetMultipleStringEnum(this._textDecoration)};a.prototype.SetTextDecoration=function(b){var a=Utility.CheckMultipleStringEnum(TextDecoration,b);if(a!==this._textDecoration){var c=this._textDecoration;this._textDecoration=a;this._onTextDecorationChanged(c,a,b)}};a.prototype.SetTabIndex=function(){};a.prototype._onTextDecorationChanged=function(){};a.prototype._setTextDecorationDirectly=function(a){a=Utility.CheckMultipleStringEnum(TextDecoration,a);this._textDecoration=a};a.prototype.GetHeight=function(){return this._useDefaultLength(this._height)?this._getDefaultSize().Height:this._height};a.prototype.SetHeight=function(a){if(this.GetAutoSize())return;var d=a,c=this._useDefaultLength(this._height)?"":Utility.CheckCSSLength(this._height);if(this._useDefaultLength(a))a=this._getDefaultSize().Height;var b=Utility.CheckCSSLength(a);if(b!==c){this._height=d;this._onHeightChanged(c,b)}};a.prototype._onHeightChanged=function(){};a.prototype._getHeightDirectly=function(){return this._height};a.prototype._setHeightDirectly=function(a){this._height=a};a.prototype.GetWidth=function(){return this._useDefaultLength(this._width)?this._getDefaultSize().Width:this._width};a.prototype.SetWidth=function(a){if(this.GetAutoSize())return;var d=a,c=this._useDefaultLength(this._width)?"":Utility.CheckCSSLength(this._width);if(this._useDefaultLength(a))a=this._getDefaultSize().Width;var b=Utility.CheckCSSLength(a);if(b!==c){this._width=d;this._onWidthChanged(c,b)}};a.prototype._onWidthChanged=function(){};a.prototype._getWidthDirectly=function(){return this._width};a.prototype._setWidthDirectly=function(a){this._width=a};a.prototype._isSupportAutoSize=function(){return false};a.prototype.GetAutoSize=function(){return this._autoSize};a.prototype.SetAutoSize=function(a){if(!this._isSupportAutoSize())return;a=Utility.CheckBool(a);if(a!==this._autoSize){var b=this._autoSize;this._autoSize=a;this._onAutoSizeChanged(b,a)}};a.prototype._onAutoSizeChanged=function(){};a.prototype.GetCursor=function(){return this._cursor};a.prototype.SetCursor=function(a){a=Utility.CheckEnum(Cursor,a);if(a!==this._cursor){var b=this._cursor;this._cursor=a;this._onCursorChanged(b,a)}return this};a.prototype._onCursorChanged=function(){};a.prototype.GetEnabled=function(){return this._enabled};a.prototype.SetEnabled=function(a){a=Utility.CheckBool(a);if(a!==this._enabled){var b=this._enabled;this._enabled=a;this._onEnabledChanged(b,a)}return this};a.prototype._onEnabledChanged=function(){};a.prototype.GetVisible=function(){return this._visible};a.prototype.SetVisible=function(a){a=Utility.CheckBool(a);if(a!==this._visible){var b=this._visible;this._visible=a;this._onVisibleChanged(b,a)}return this};a.prototype._onVisibleChanged=function(){};a.prototype._getControlEffect=function(){return this._controlEffect};a.prototype._setControlEffect=function(a){a=Utility.CheckEnum(ControlEffect,a);if(a!==this._controlEffect){var b=this._controlEffect;this._controlEffect=a;this._onControlEffectChanged(b,a)}};a.prototype.GetEnablejQueryTheme=function(){return this._getControlEffect()==ControlEffect.JQueryUI?true:false};a.prototype.SetEnablejQueryTheme=function(a){if(a)this._setControlEffect(ControlEffect.JQueryUI);else this._setControlEffect(ControlEffect.NotSet)};a.prototype._onControlEffectChanged=function(){};a.prototype._getXPTheme=function(){return this._xpTheme};a.prototype._setXPTheme=function(a){a=Utility.CheckEnum(XPTheme,a);if(a!==this._xpTheme){var b=this._xpTheme;this._xpTheme=a;this._onXPThemeChanged(b,a)}};a.prototype._onXPThemeChanged=function(){};a.prototype.GetRealControlEffect=function(){return this._getControlEffect()===ControlEffect.NotSet?Utility.GetClientControlEffect():this._getControlEffect()};a.prototype._useDefaultLength=function(a){return a==null||a===""||a===0};a.prototype._getCSSBorderWidth=function(){return this._borderWidth===""||this._borderWidth==null?0:Utility.GetCSSLength(this._borderWidth)};a.prototype._getCSSWidth=function(){return Utility.GetCSSLength(this.GetWidth())};a.prototype._getCSSHeight=function(){return Utility.GetCSSLength(this.GetHeight())};a.prototype._getRealCSSWidth=function(){return this._getCSSWidth()};a.prototype._getRealCSSHeight=function(){return this._getCSSHeight()};a.prototype.SetFocus=function(){this._realSetFocus()};a.prototype._realSetFocus=function(){};a.prototype._typeOfImage=function(a,c){if(Utility.IsIE8OrBelow)return a;var b=this.GetRealControlEffect();switch(b){case ControlEffect.JQueryUI:case ControlEffect.Windows8Theme:case ControlEffect.Chrome:case ControlEffect.VistaTheme:return".svg";case ControlEffect.Ipad:return c==="Middle"?".png":".svg";default:return a}};a._enableChromeThemeOutline=true;return a}(Component);GCIMCalendar.Control=Control;var Font=function(){function a(b,e,c,d,a){this._owner=null;this._fontFamily=b||"";this._fontSize=e||"";this._fontWeight=c||"";this._fontStyle=d||"";this._textDecoration=a||""}a.prototype.SetOwner=function(a){this._owner=a};a.prototype.Reset=function(){this._fontFamily="";this._fontSize="";this._fontWeight="";this._fontStyle="";this._textDecoration=""};a.prototype.GetFontFamily=function(){return this._fontFamily};a.prototype.SetFontFamily=function(a){if(a!==this._fontFamily){this._fontFamily=a;this._owner!=null&&this._owner.FontChanged()}};a.prototype.GetFontSize=function(){return this._fontSize};a.prototype.SetFontSize=function(a){a=Utility.CheckFontSizeValue(a);if(a!==this._fontSize){this._fontSize=a;this._owner!=null&&this._owner.FontChanged()}};a.prototype.GetFontWeight=function(){return this._fontWeight};a.prototype.SetFontWeight=function(a){if(a!==this._fontWeight){this._fontWeight=a;this._owner!=null&&this._owner.FontChanged()}};a.prototype.GetFontStyle=function(){return this._fontStyle};a.prototype.SetFontStyle=function(a){if(a!==this._fontStyle){this._fontStyle=a;this._owner!=null&&this._owner.FontChanged()}};a.prototype.GetTextDecoration=function(){return this._textDecoration};a.prototype.SetTextDecoration=function(a){if(a!==this._textDecoration){this._textDecoration=a;this._owner!=null&&this._owner.FontChanged()}};a.prototype.IsDefaultFont=function(){return this._fontFamily===""&&this._fontSize===""&&this._fontWeight===""&&this._fontStyle===""&&this._textDecoration===""};a.prototype.CreateFont=function(d){var c=new a;if(d!=null&&typeof d=="string"&&d!=""){var b=d.split(";");if(b.length==7){c._name=b[0];c._size=b[1];c._bold=b[2];c._italic=b[3];c._underline=b[4];c._overline=b[5];c._strikeout=b[6]}}return c};a.prototype.CreateFontString=function(a){var b="";b=a._name+";"+a.Size+";"+(a._bold?"Bold":"")+";"+(a._italic?"Italic":"")+";"+(a._underline?"Underline":"")+";"+(a._overline?"Overline":"")+";"+(a._strikeout?"Strikeout":"");return b};a.prototype.CompareFont=function(a,b){return a._bold==b._bold&&a._italic==b._italic&&a._name==b._name&&a._overline==b._overline&&a._size==b._size&&a._strikeout==b._strikeout&&a._underline==b._underline?true:false};a.CloneFont=function(b){return new a(b._name,b._size,b._bold,b._italic,b._underline,b._overline,b._strikeout)};return a}();GCIMCalendar.Font=Font;var UserFont=function(){function a(){this.Name="Arial";this.Size="10pt";this.Bold="normal";this.Italic="normal";this.Underline="";this.Overline="";this.Strikeout=""}a.prototype.GetTextDecorationString=function(){return a.GetTextDecorationStringFromObj(this)};a.GetTextDecorationStringFromObj=function(b){var a="";if(b.Underline!=null&&(b.Underline.toLowerCase()=="underline"||b.Underline==""))a=b.Underline;if(b.Overline!=null&&(b.Overline.toLowerCase()=="overline"||b.Overline=="")){if(a==null)a="";else if(a!=""&&b.Overline!="")a+=" ";a+=b.Overline}if(b.Strikeout!=null&&(b.Strikeout.toLowerCase()=="strikeout"||b.Strikeout=="")){if(a!=null)if(a!=""&&b.Strikeout!="")a+=" ";if(b.Strikeout.toLowerCase()=="strikeout")a+="line-through";else if(b.Strikeout=="")a+=""}if(a!=null)if(a=="")a="none";return a};a.prototype.ParseTextDecorationString=function(a){a=a.toLowerCase();if(a.indexOf("underline")!==-1)this.Underline="underline";if(a.indexOf("overline")!==-1)this.Overline="overline";if(a.indexOf("strikeout")!==-1)this.Strikeout="strikeout"};return a}();GCIMCalendar.UserFont=UserFont;var Localization=function(){function a(){}a.GetString=function(b){if(Utility.IsJapan()){a.InitJpResource();return a.JPResource[b]}else{a.InitEnResource();return a.EnResource[b]}};a.InitJpResource=function(){if(a.JPResource!==null)return;a.JPResource={};var b=a.JPResource;b["TouchToolBar.Undo"]="????";b["TouchToolBar.Cut"]="????";b["TouchToolBar.Copy"]="???";b["TouchToolBar.Paste"]="????";b["TouchToolBar.Delete"]="??";b["TouchToolBar.SelectAll"]="?????";b["ToolTip.PreviousYear"]="???";b["ToolTip.Today"]="??";b["ToolTip.NextYear"]="???";b["ToolTip.NextDecade"]="10??";b["ToolTip.PreviousDecade"]="10??";b["ToolTip.ZoomIn"]="?????";b["ToolTip.ZoomOut"]="??????";b["Weekday.Monday"]="?";b["Weekday.Tuesday"]="?";b["Weekday.Wednesday"]="?";b["Weekday.Thursday"]="?";b["Weekday.Friday"]="?";b["Weekday.Saturday"]="?";b["Weekday.Sunday"]="?";b["ContextMenu.Undo"]="????(U)";b["ContextMenu.Cut"]="????(T)";b["ContextMenu.Copy"]="???(C)";b["ContextMenu.Paste"]="????(P)";b["ContextMenu.Delete"]="??(D)";b["ContextMenu.SelectAll"]="?????(A)";b["ContextMenu.UndoDescription"]="????????????????";b["ContextMenu.CutDescription"]="??????????????????????????";b["ContextMenu.CopyDescription"]="????????????????????";b["ContextMenu.PasteDescription"]="?????????????????????????";b["ContextMenu.DeleteDescription"]="???????????";b["ContextMenu.SelectAllDescription"]="???????????????????";b["Number.CurrencySymbol"]="¥";b["Calculator.DivideByZeroInfo"]="0 ?????????";b["Calculator.InvalidInputInfo"]="????????";b["Calculator.OverFlowInfo"]="?????????????????";b["Calculator.SqrtParameterException"]="???????";b["ValidatorAction.DefaultErroInformation"]="????????????";b["License.Trail"]="InputMan for Java EE<br>?????????????????????????????????????<br>???????????(www.grapecity.com)";b["License.Development"]="InputMan for Java EE<br>???????";b["License.ExpiredTrail"]="InputMan for Java EE<br>???????????<br>?????????????????????????<br>???????????(www.grapecity.com)";b["License.Invalid"]="InputMan for Java EE<br>????????????????<br>????????????????????<br>???????????(www.grapecity.com)"};a.InitEnResource=function(){if(a.EnResource!==null)return;a.EnResource={};var b=a.EnResource;b["TouchToolBar.Undo"]="Undo";b["TouchToolBar.Cut"]="Cut";b["TouchToolBar.Copy"]="Copy";b["TouchToolBar.Paste"]="Paste";b["TouchToolBar.Delete"]="Delete";b["TouchToolBar.SelectAll"]="Select All";b["ToolTip.PreviousYear"]="Previous Year";b["ToolTip.Today"]="Today";b["ToolTip.NextYear"]="Next Year";b["ToolTip.NextDecade"]="Next Decade";b["ToolTip.PreviousDecade"]="Previous Decade";b["ToolTip.ZoomIn"]="Zoom In";b["ToolTip.ZoomOut"]="Zoom Out";b["Weekday.Monday"]="M";b["Weekday.Tuesday"]="T";b["Weekday.Wednesday"]="W";b["Weekday.Thursday"]="T";b["Weekday.Friday"]="F";b["Weekday.Saturday"]="S";b["Weekday.Sunday"]="S";b["ContextMenu.Undo"]="Undo(U)";b["ContextMenu.Cut"]="Cut(T)";b["ContextMenu.Copy"]="Copy(C)";b["ContextMenu.Paste"]="Paste(P)";b["ContextMenu.Delete"]="Delete(D)";b["ContextMenu.SelectAll"]="Select All(A)";b["ContextMenu.UndoDescription"]="Undoes the last action";b["ContextMenu.CutDescription"]="Cuts the Selection and puts it on the Clipboard";b["ContextMenu.CopyDescription"]="Copies the Selection to the Clipboard";b["ContextMenu.PasteDescription"]="Inserts the Clipboard contents at the insertion point";b["ContextMenu.DeleteDescription"]="Delete the selection";b["ContextMenu.SelectAllDescription"]="Selects the whole context in the control";b["Number.CurrencySymbol"]="$";b["Calculator.DivideByZeroInfo"]="Cannot divide by zero.";b["Calculator.InvalidInputInfo"]="Invalid Input.";b["Calculator.OverFlowInfo"]="Arithmetic operation resulted in an overflow.";b["Calculator.SqrtParameterException"]="Invalid input for function.";b["ValidatorAction.DefaultErroInformation"]="Invalid Value.";b["License.Trail"]="InputMan for Java EE<br>Evaluation License<br>All rights reserverd by GrapeCity.Inc (www.grapecity.com)";b["License.Development"]="InputMan for Java EE<br>Development License";b["License.ExpiredTrail"]="InputMan for Java EE<br>Evaluation License Expired<br>All rights reserverd by GrapeCity.Inc (www.grapecity.com)";b["License.Invalid"]="InputMan for Java EE<br>Invalid License<br>All rights reserverd by GrapeCity.Inc (www.grapecity.com)"};a.JPResource=null;a.EnResource=null;return a}();GCIMCalendar.Localization=Localization;var DateTimeInfo=function(){function a(){if(typeof window.WEEKDAYS!="undefined")a.WeekDays=window.WEEKDAYS;if(typeof window.MONTHNAMES!="undefined")a.MonthNames=window.MONTHNAMES;if(typeof window.SHORTWEEKDAYS!="undefined")a.ShortWeekDays=window.SHORTWEEKDAYS;if(typeof window.SHORTMONTHNAMES!="undefined")a.ShortMonthNames=window.SHORTMONTHNAMES}a.IsValidEraDate=function(a){return a<this.EraMin||a>this.EraMax?false:true};a.String2Date=function(a){if(a==null||a.length==0)return null;var b=new Date(Date.parse(a));return b};a.Date2String=function(a,e,c,d){var b="";try{if(e==true)if(c==true)b=a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate();else if(d==true)b=a.getHours()+":"+Utility.ToString(a.getMinutes(),2,"0")+":"+Utility.ToString(a.getSeconds(),2,"0");else b=a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate()+" "+a.getHours()+":"+Utility.ToString(a.getMinutes(),2,"0")+":"+Utility.ToString(a.getSeconds(),2,"0");else if(c==true)b=a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear();else if(d==true)b=a.getHours()+":"+Utility.ToString(a.getMinutes(),2,"0")+":"+Utility.ToString(a.getSeconds(),2,"0");else b=a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()+" "+a.getHours()+":"+Utility.ToString(a.getMinutes(),2,"0")+":"+Utility.ToString(a.getSeconds(),2,"0")}catch(f){b=""}return b};a.Date2Long=function(a){try{return(a.getFullYear()*100+a.getMonth()+1)*100+a.getDate()}catch(b){return 0}};a.Date2Number=function(a){return a==null?0:((((a.getFullYear()*100+a.getMonth()+1)*100+a.getDate())*100+a.getHours())*100+a.getMinutes())*100+a.getSeconds()};a.Long2Date=function(a){return new Date(parseInt((a/1e4).toString(),10),parseInt((a%1e4/100-1).toString(),a%100))};a.GetEraDate=function(c){var a={};a.era=-1;a.eraYear=-1;if(!this.IsValidEraDate(c))return a;for(var b=0;b<this.EraCount;b++){var d=b+1!=this.EraCount?this.EraDates[b+1]:this.AddMilliseconds(this.EraMax,1);if(c<d){a.era=b;a.eraYear=c.getFullYear()-this.EraDates[b].getFullYear()+1;break}}return a};a.IsLeapYear=function(a){return a%400==0||a%4==0&&a%100!=0?true:false};a.DayOfYear=function(d,c,e){for(var a=0,b=1;b<c;b++)a=a+this.DaysInMonth(d,b);a=a+e;return a};a.DaysInMonth=function(b,a){if(a>12){b+=parseInt((a/12).toString(),10);a=a%12}else if(a<0){var c=a*-1;b-=Math.ceil(c/12);a=12-c%12}switch(a){case 2:if(this.IsLeapYear(b))return 29;else return 28;break;case 4:case 6:case 9:case 11:return 30;break;default:return 31}};a.Equal=function(a,b,c){if(a==null&&b==null)return true;else if(a==null)return false;else if(b==null)return false;try{return!c?a.getFullYear()==b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()?true:false:a.getFullYear()==b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()&&a.getHours()==b.getHours()&&a.getMinutes()==b.getMinutes()&&a.getSeconds()==b.getSeconds()?true:false}catch(d){return false}};a.YearMonthEqual=function(a,b){if(a==null&&b==null)return true;else if(a==null)return false;else if(b==null)return false;try{return a.getFullYear()==b.getFullYear()&&a.getMonth()==b.getMonth()?true:false}catch(c){return false}};a.SetDate=function(c,b,d){var a=new Date,f=9999*12+12;if(c*12+b>f)a=new Date(9999,11,31);else if(c*12+b<100)a=new Date(100,0,1);else{var e=this.DaysInMonth(c,b);if(d>e)d=e;a=new Date(c,b-1,d)}return a};a.AddMilliseconds=function(a,c){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds());b.setMilliseconds(b.getMilliseconds()+c);return new Date(b.valueOf())};a.LunarInfo=[44710,43856,19808,43748,42352,21104,29283,55632,27479,22176,39632,19925,19168,42208,54484,53840,54680,46400,54944,103846,38320,18864,43444,42160,45690,27216,27968,46934,11104,38320,19317,18800,25776,29859,59984,28056,21968,11104,38629,37600,51552,59732,54432,55888,30034,22208,43959,9680,37584,51893,43344,46240,111779,46416,21977,19360,42416,21877,21168,43344,47444,27296,44368,27474,19296,42726,42352,21104,27237,55600,23200,46755,38608,19415,19168,42192,118998,53840,54560,56645,46752,38608,21938,18864,42359,42160,45648,111189,27968,44448];a.EraDates=[new Date(1868,9-1,8),new Date(1912,7-1,30),new Date(1926,12-1,25),new Date(1989,1-1,8)];a.EraCount=4;a.EraYears=[45,15,64,99];a.EraMax=new Date(2087,12-1,31,23,59,59);a.EraMin=new Date(1868,9-1,8);a.EraKeys=["1","2","3","4","m","t","s","h"];a.EraIndices=[0,1,2,3,0,1,2,3];a.DateLongFormat="yyyyMMddHHmmss";a.EraNames=["M","T","S","H","?","?","?","?","??","??","??","??"];a.WeekDays=["???","???","???","???","???","???","???"];a.MonthNames=["1?","2?","3?","4?","5?","6?","7?","8?","9?","10?","11?","12?"];a.MonthNamesEn=["January","February","March","April","May","June","July","August","September","October","November","December"];a.ShortWeekDays=["?","?","?","?","?","?","?"];a.ShortWeekDaysEn=["S","M","T","W","T","F","S"];a.ShortMonthNames=["1","2","3","4","5","6","7","8","9","10","11","12"];a.ShortMonthNamesEn=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];a.DefaultTwoDigitYear=2029;a.Digits=2;a.EraYearMax=99;return a}();GCIMCalendar.DateTimeInfo=DateTimeInfo;var HeaderItem=function(){function a(c,b,a){this.Type=c;this.Text=b;this.Length=a}return a}();GCIMCalendar.HeaderItem=HeaderItem;var CalendarConstant=function(){function a(){}a.CONST_DEFAULT_CELL_STYLE="CalendarDefaultCellStyle";a.CONST_DEFAULT_TODAY_STYLE="CalendarDefaultTodayStyle";a.CONST_DEFAULT_HEADER_STYLE="CalendarDefaultHeaderStyle";a.CONST_DEFAULT_ITEM_STYLE="CalendarDefaultItemStyle";a.CONST_DEFAULT_TRAILING_STYLE="CalendarDefaultTrailingStyle";a.CONST_DEFAULT_SELECTION_STYLE="CalendarDefaultSelectionStyle";a.CONST_DEFAULT_JQUERY_SELECTION_STYLE="CalendarDefaultJquerySelectionStyle";a.CONST_DEFAULT_CONTAINER_STYLE="CalendarDefaultContainerStyle";a.CONST_DEFAULT_CONTAINER_STYLE_WIN8="CalendarDefaultContainerStyleWin8";a.CONST_DEFAULT_CONTAINER_STYLE_CHROME="CalendarDefaultContainerStyleChrome";a.CONST_DEFAULT_CONTAINER_STYLE_IPAD="CalendarDefaultContainerStyleIpad";return a}();GCIMCalendar.CalendarConstant=CalendarConstant;var CalendarUtility=function(){function a(){}a.CreateTempDomElement=function(d){var c=Utility.CreateInnerDiv(),a=d.Font,b=c.style;b.fontFamily=a.GetFontFamily();b.fontSize=a.GetFontSize()==""?"":Utility.GetFontSizeUnitValue(a.GetFontSize())+"px";b.fontStyle=a.GetFontStyle();b.fontWeight=a.GetFontWeight();c.className=Utility.DefaultControlStyle;return c};a.SetItemInlineStyle=function(c,b){a.SetSelectionInlineStyle(c,b)};a.SetDefalutItemInlineStyle=function(b){var a=b.style;a.color="";a.border="none 1px black";a.fontWeight="";a.backgroundColor="window";a.backgroundImage="";a.backgroundPosition="center center"};a.SetSelectionInlineStyle=function(c,b){var a=c.style;a.color=b.style.color;a.border=b.style.border;a.fontWeight=b.style.fontWeight;a.backgroundColor=b.style.backgroundColor;a.backgroundImage=b.style.backgroundImage;a.backgroundPosition=b.style.backgroundPosition};a.SetDefaultSelectionInlineStyle=function(c,b){var a=c.style;a.color=b?"":"white";a.border="none 0px black";a.fontWeight="";a.backgroundColor="rgb(51, 153, 255)";a.backgroundImage="";a.backgroundPosition="center center"};a.ClearInlineStyle=function(b){var a=b.style;a.color="";a.border="";a.fontWeight="";a.backgroundColor="";a.backgroundImage="";a.backgroundPosition=""};a.GetMonthLineBeginDate=function(e,i,h){for(var a=0;a<e.CalendarSectionDom.SingleCalendarDom.length;a++)for(var c=e.CalendarSectionDom.SingleCalendarDom[a],b=0;b<c.RowsDom.length;b++)for(var d=0;d<3;d++){var j=c.RowsDom[b][d].ContainerCell.getAttribute("CellValue"),l=DateTimeInfo.String2Date(j);if(DateTimeInfo.YearMonthEqual(i,l))if(h)for(var a=0;a<3;a++){var k=c.RowsDom[b][a].ContainerCell.getAttribute("CellType");if(h==k){var f=c.RowsDom[b][a].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}else{var f=c.RowsDom[b][0].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}return null};a.GetMonthLineEndDate=function(e,i,h){for(var a=0;a<e.CalendarSectionDom.SingleCalendarDom.length;a++)for(var c=e.CalendarSectionDom.SingleCalendarDom[a],b=0;b<c.RowsDom.length;b++)for(var d=0;d<3;d++){var j=c.RowsDom[b][d].ContainerCell.getAttribute("CellValue"),l=DateTimeInfo.String2Date(j);if(DateTimeInfo.YearMonthEqual(i,l))if(h)for(var a=2;a>=0;a--){var k=c.RowsDom[b][a].ContainerCell.getAttribute("CellType");if(h==k){var f=c.RowsDom[b][a].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}else{var f=c.RowsDom[b][2].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}return null};a.GetMonthBeginDate=function(f,h,l){for(var a=0;a<f.CalendarSectionDom.SingleCalendarDom.length;a++)for(var b=f.CalendarSectionDom.SingleCalendarDom[a],e=0;e<b.RowsDom.length;e++)for(var d=0;d<3;d++){var i=b.RowsDom[e][d].ContainerCell.getAttribute("CellValue"),m=DateTimeInfo.String2Date(i);if(DateTimeInfo.YearMonthEqual(h,m))for(var a=0;a<b.RowsDom.length;a++)for(var c=0;c<3;c++){var j=b.RowsDom[a][c].ContainerCell.getAttribute("CellType");if(l==j){var g=b.RowsDom[a][c].ContainerCell.getAttribute("CellValue"),k=DateTimeInfo.String2Date(g);return k}}}return null};a.GetMonthEndDate=function(f,h,l){for(var a=0;a<f.CalendarSectionDom.SingleCalendarDom.length;a++)for(var b=f.CalendarSectionDom.SingleCalendarDom[a],e=0;e<b.RowsDom.length;e++)for(var d=0;d<3;d++){var i=b.RowsDom[e][d].ContainerCell.getAttribute("CellValue"),m=DateTimeInfo.String2Date(i);if(DateTimeInfo.YearMonthEqual(h,m))for(var a=b.RowsDom.length-1;a>=0;a--)for(var c=2;c>=0;c--){var j=b.RowsDom[a][c].ContainerCell.getAttribute("CellType");if(l==j){var g=b.RowsDom[a][c].ContainerCell.getAttribute("CellValue"),k=DateTimeInfo.String2Date(g);return k}}}return null};a.GetDayLineBeginDate=function(e,i,h){for(var a=0;a<e.CalendarSectionDom.SingleCalendarDom.length;a++)for(var c=e.CalendarSectionDom.SingleCalendarDom[a],b=0;b<c.RowsDom.length;b++)for(var d=0;d<7;d++){var j=c.RowsDom[b][d].ContainerCell.getAttribute("CellValue"),l=DateTimeInfo.String2Date(j);if(DateTimeInfo.Equal(i,l))if(h)for(var a=0;a<7;a++){var k=c.RowsDom[b][a].ContainerCell.getAttribute("CellType");if(h==k){var f=c.RowsDom[b][a].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}else{var f=c.RowsDom[b][0].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}return null};a.GetDayLineEndDate=function(e,i,h){for(var a=0;a<e.CalendarSectionDom.SingleCalendarDom.length;a++)for(var c=e.CalendarSectionDom.SingleCalendarDom[a],b=0;b<c.RowsDom.length;b++)for(var d=0;d<7;d++){var j=c.RowsDom[b][d].ContainerCell.getAttribute("CellValue"),l=DateTimeInfo.String2Date(j);if(DateTimeInfo.Equal(i,l))if(h)for(var a=6;a>=0;a--){var k=c.RowsDom[b][a].ContainerCell.getAttribute("CellType");if(h==k){var f=c.RowsDom[b][a].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}else{var f=c.RowsDom[b][6].ContainerCell.getAttribute("CellValue"),g=DateTimeInfo.String2Date(f);return g}}return null};a.GetZoomRate=function(){var b=4,d=2,a=.7,c=1.5;if(Utility.IsIE9OrLater){b=2;a=.6}return{WidthOffset:b,HeightOffset:d,WidthZoomRate:a,HeightZoomRate:c}};a.CalculateHeaderAutoSize=function(c){var b=new Size(0,0),e=a.CreateTempDomElement(c),d=Utility.MeasureText(c.GetHeaderText(),e);b.Width=d.Width;b.Height=d.Height;b.Width+=2*c.DefaultOutlookArrowSize().Width;return b};a.CalculateItemSingleAutoSize=function(d){var c=new Size(0,0),e=a.GetZoomRate(d),f=a.CreateTempDomElement(d),b=Utility.MeasureText("99",f);b.Width=b.Width+b.Width*e.WidthZoomRate;b.Height=b.Height*e.HeightZoomRate;c.Width=b.Width;c.Height=b.Height;return c};a.CalculateTodayAutoSize=function(b){var c=new Size(0,0);if(b.ShowToday){var e=a.CreateTempDomElement(b),d=Utility.MeasureText(b.GetTodayText(),e);c.Width=d.Width*1.08;c.Height=d.Height}return c};a.UpdateAutoSize=function(d){var i=a.GetZoomRate(d),f=a.CalculateItemSingleAutoSize(d),e=a.CalculateItemSingleAutoSize(d),k=Math.max(e.Width,f.Width),j=Math.max(e.Height,f.Height),c=new Size(0,0);c.Width+=k*7;c.Height+=j*7;var g=a.CalculateHeaderAutoSize(d);c.Height+=g.Height;c.Width=Math.max(g.Width,c.Width);c.Height=c.Width;var b=new Size(0,0);b.Width+=c.Width;b.Height+=c.Height;b.Width+=i.WidthOffset;b.Height+=i.HeightOffset;var h=a.CalculateTodayAutoSize(d);b.Width=Math.max(b.Width,h.Width);b.Height+=h.Height;d.Width=Math.floor(b.Width);d.Height=Math.floor(b.Height)};a.GetEventCurrentTarget=function(b){if(Utility.IsIE8OrBelow){var a=b.srcElement;while(a!=null){var c=a.getAttribute("CellType");if(c!=null)return a;a=a.parentElement}return null}else return b.currentTarget};a.UpdateHeaderStyleRule=function(a,c){this.UpdateStyleRule(a,c);var b=c.style;b.color=a.HeaderForeColor;b.backgroundColor=a.HeaderBackColor};a.UpdateStyleRule=function(c,d){var b=c.Font,a=d.style;a.color=c.ForeColor;a.backgroundColor=c.BackColor;a.padding="0px";a.borderStyle="none";a.borderWidth="1px";a.borderColor="black";a.verticalAlign="middle";a.backgroundPosition="center center";a.fontFamily=b.GetFontFamily();a.fontSize=b.GetFontSize()===""?"":Utility.GetFontSizeUnitValue(b.GetFontSize())+"px";a.fontWeight=b.GetFontWeight();a.fontStyle=b.GetFontStyle();a.textDecoration=Utility.CheckMultipleStringEnum(TextDecoration,b.GetTextDecoration())};a.GetCellStyleRule=function(j,a,g,i,h){var d=a.CalendarSectionDom.SingleCalendarDom[g],f=d.RowsDom[i][h],e=f.ContainerCell.getAttribute("CellType"),c="",b=null;switch(e){case"CommonDay":case"EmptyDay":c="ItemStyleRule";b=a.ItemStyleRule;break;case"TrailingDay":case"DisableDay":c="TrailingStyleRule";b=a.TrailingStyleRule}return{RuleType:c,StyleRule:b}};a.UpdateFontData=function(b,a){typeof a.FontFamily!=="undefined"&&b.SetFontFamily(a.FontFamily);typeof a.FontSize!=="undefined"&&b.SetFontSize(a.FontSize);typeof a.FontWeight!=="undefined"&&b.SetFontWeight(a.FontWeight);typeof a.FontStyle!=="undefined"&&b.SetFontStyle(a.FontStyle);typeof a.TextDecoration!=="undefined"&&b.SetTextDecoration(a.TextDecoration)};a.GetThemeFolderName=function(a){switch(a.InnerControlEffect()){case ControlEffect.Windows8Theme:return"Win8";case ControlEffect.VistaTheme:return"Vista";case ControlEffect.Chrome:return"Chrome";case ControlEffect.Ipad:return"Ipad";case ControlEffect.XPTheme:switch(a.XPTheme){case"":case XPTheme.Default:return"Blue";case XPTheme.Silver:return"Silver";case XPTheme.OliveGreen:return"Olive"}}return"Normal"};a.ResetCellDom=function(a){var c=a.ContainerCell;c.className="";c.removeAttribute("styleName");c.style.border="";var e=a.ContainerStyleDiv;e.className="";e.removeAttribute("styleName");if(Utility.IsQuriksMode){var d=a.ContentTable;if(d!=null){d.className="";d.style.color=""}var b=a.ContentRokoyouContentTable;if(b!=null){b.className="";b.style.color=""}}};a.ResetTodayDom=function(b){var d=b.TodayText,c=d.style;c.display="";c.fontFamily="";c.fontSize="";b.TodayContainer.style.display="";b.TodayContainer.style.borderWidth="";var a=b.TodayContentTable;a.className="";a.style.marginLeft="";a.style.marginRight="";a.removeAttribute("styleName")};a.ResetMonthCellDom=function(b){a.ResetCellDom(b);a.ClearInlineStyle(b.ContainerCell);a.ClearInlineStyle(b.ContainerStyleDiv);b.ContentCell.style.display="";b.ContentCell.style.textDecoration=""};a.CreateDayCellDomStyle=function(){return{ContentCell:{vAlign:"",className:"",style:{display:"",fontFamily:"",fontSize:"",textDecoration:""}},ContentTable:{className:"",color:""},ContainerCell:{styleName:"",className:"",holidayType:"",holidayName:"",style:{padding:"",border:"",fontWeight:"",color:"",backgroundColor:"",backgroundImage:"",backgroundPosition:""}},ContainerCellDiv:{className:"",style:{marginLeft:"",marginRight:""}},ContainerStyleDiv:{styleName:"",className:"",style:{padding:"",border:"",fontWeight:"",color:"",backgroundColor:"",backgroundImage:"",backgroundPosition:""}}}};a.SetDayCellDomStyle=function(f,a){var g=f.ContainerCell,e=g.style,d=a.ContainerCell.style;g.className=a.ContainerCell.className;g.setAttribute("holidayType",a.ContainerCell.holidayType);g.setAttribute("holidayName",a.ContainerCell.holidayName);g.setAttribute("styleName",a.ContainerCell.styleName);e.padding=d.padding;e.color=d.color;e.border=d.border;e.fontWeight=d.fontWeight;e.backgroundColor=d.backgroundColor;e.backgroundImage=d.backgroundImage;e.backgroundPosition=d.backgroundPosition;var n=f.ContainerCellDiv,m=n.style,l=a.ContainerCellDiv.style;n.className=a.ContainerCellDiv.className;m.marginLeft=l.marginLeft;m.marginRight=l.marginRight;var i=f.ContainerStyleDiv,c=i.style,b=a.ContainerStyleDiv.style;i.className=a.ContainerStyleDiv.className;i.setAttribute("styleName",a.ContainerStyleDiv.styleName);c.padding=b.padding;c.color=b.color;c.border=b.border;c.fontWeight=b.fontWeight;c.backgroundColor=b.backgroundColor;c.backgroundImage=b.backgroundImage;c.backgroundPosition=b.backgroundPosition;if(Utility.IsQuriksMode&&f.ContentTable!=null){var o=f.ContentTable;o.className=a.ContentTable.className;o.style.color="black"}var p=f.ContentDiv,k=f.ContentCell,j=k.style,h=a.ContentCell.style;k.className=a.ContentCell.className;k.setAttribute("vAlign",a.ContentCell.vAlign);j.display=h.display;j.fontFamily=h.fontFamily;j.fontSize=h.fontSize;if(Utility.chrome||Utility.safari)p.style.textDecoration=a.ContentCell.style.textDecoration};a.ResetTitleCellDom=function(c){a.ResetCellDom(c);var d=c.ContainerCell.style,b=c.ContentCell.style;d.color="";d.backgroundColor="";b.display="";b.fontFamily="";b.fontSize="";if(Utility.chrome||Utility.safari)b.textDecoration=""};a.ResetHeaderDom=function(a){a.HeaderContainer.style.display="";a.HeaderContainer.style.borderWidth="";a.HeaderTextDiv.style.display="";a.InnerHeaderTextButton.style.fontFamily="";a.InnerHeaderTextButton.style.fontSize="";if(Utility.chrome||Utility.safari)a.InnerHeaderTextButton.style.textDecoration="";if(Utility.IsQuriksMode)a.HeaderTextButtonContentTable.className=""};a.CreateTitleDom=function(i,a){if(a.ContainerStyleDiv==null){var c=Utility.CreateInnerDiv(),e=Utility.CreateInnerDiv(),d=Utility.CreateInnerTable(),f=Utility.CreateInnerTbody(),g=Utility.CreateInnerTableRow(),b=Utility.CreateInnerTableCell(i.CellStyleName),h=Utility.CreateInnerTextNode();a.ContainerCell.appendChild(c);c.appendChild(e);e.appendChild(d);d.appendChild(f);f.appendChild(g);g.appendChild(b);b.appendChild(h);b.style.padding="0px";b.style.whiteSpace="nowrap";a.ContainerStyleDiv=c;a.ContainerDiv=e;a.ContentCell=b;a.ContentTextNode=h;a.ContentTable=d}};a.CreateDayItemDom=function(j,a){if(a.ContainerStyleDiv==null){var d=Utility.CreateInnerDiv(),c=Utility.CreateInnerDiv(),f=Utility.CreateInnerDiv(),e=Utility.CreateInnerTable(),h=Utility.CreateInnerTbody(),g=Utility.CreateInnerTableRow(),b=Utility.CreateInnerTableCell(j.CellStyleName),i=Utility.CreateInnerTextNode("");a.ContainerCell.appendChild(d);d.appendChild(c);c.appendChild(e);e.appendChild(h);h.appendChild(g);g.appendChild(b);b.appendChild(f);f.appendChild(i);b.style.padding="0px";b.style.whiteSpace="nowrap";c.style.overflow="";a.ContainerStyleDiv=d;a.ContainerCellDiv=c;a.ContentCell=b;a.ContentDiv=f;a.ContentTextNode=i;a.ContentTable=e}};a.CreateTodayCellImage=function(b){var c=b.GetTodayStyleImage(),a=Utility.CreateInnerImage(c);a.style.width="16px";a.style.height="16px";a.style.position="absolute";a.style.top="2px";a.style.left="2px";a.style.zIndex="0";return a};a.CreateNavigatorImage=function(a,d){var e=a.GetImagePath(d,true),f=a.GetImageKeyName(d,true),c=a.GetServerImagePath(f);if(c)e=c;var b=Utility.CreateInnerImage(e);b.style.verticalAlign="middle";b.style.display="";return b};a.CreateNavigatorSpanElement=function(b){var a=document.createElement("span");a.style.width="16px";a.style.height="16px";a.style.marginLeft="auto";a.style.marginRight="auto";a.className=b;return a};a.CreateMonthItemDom=function(i,a){if(a.ContainerStyleDiv==null){var c=Utility.CreateInnerDiv(),d=Utility.CreateInnerDiv(),j=Utility.CreateInnerDiv(),e=Utility.CreateInnerTable(),g=Utility.CreateInnerTbody(),f=Utility.CreateInnerTableRow(),b=Utility.CreateInnerTableCell(i.CellStyleName),h=Utility.CreateInnerTextNode("");a.ContainerCell.appendChild(c);c.appendChild(d);d.appendChild(e);e.appendChild(g);g.appendChild(f);f.appendChild(b);b.appendChild(h);b.style.padding="0px";b.style.whiteSpace="nowrap";a.ContainerStyleDiv=c;a.ContainerCellDiv=d;a.ContentCell=b;a.ContentDiv=j;a.ContentTextNode=h;a.ContentTable=e}};a.GetNextMonthDate=function(a,h){var i=a.getFullYear(),g=a.getMonth(),j=a.getDate(),c=new Date(i,g,1);c.setMonth(g+h);var b=c.getFullYear(),f=c.getMonth(),d=j,e=DateTimeInfo.DaysInMonth(b,f+1);if(d>e)d=e;return b<100?a:new Date(b,f,d)};a.GetNextYearDate=function(a,h){var g=a.getFullYear(),i=a.getMonth(),j=a.getDate(),c=new Date(g,i,1);c.setFullYear(g+h);var b=c.getFullYear(),f=c.getMonth(),d=j,e=DateTimeInfo.DaysInMonth(b,f+1);if(d>e)d=e;return b<100?a:new Date(b,f,d)};a.GetMonthDifference=function(a,b){var c=0;if(a==null&&b==null)c=0;else if(a==null)c=-(b.getFullYear()*12+b.getMonth()+1);else if(b==null)c=a.getFullYear()*12+a.getMonth()+1;else c=(a.getFullYear()-b.getFullYear())*12+(a.getMonth()-b.getMonth());return c};a.SetCellSize=function(d,c,b){if(d){c=Math.max(c,0);b=Math.max(b,0);var a=d.style;a.width=c+"px";a.maxWidth=c+"px";a.minWidth=c+"px";a.height=b+"px";a.maxHeight=b+"px";a.minHeight=b+"px"}};a.IsValidateDate=function(a,b){return DateTimeInfo.Equal(b,a.MinDate)||DateTimeInfo.Equal(b,a.MaxDate)?true:b>=a.MinDate&&b<=a.MaxDate};a.CreateInnerDiv=function(c,b){var a=Utility.CreateElement("div");if(!Utility.chrome&&!Utility.safari)a.style.overflow="hidden";if(c)a.style.width=c+"px";if(b)a.style.height=b+"px";return a};return a}();GCIMCalendar.CalendarUtility=CalendarUtility;(function(a){a[a.Data=1]="Data";a[a.Style=2]="Style";a[a.SelectionType=4]="SelectionType";a[a.All=7]="All"})(GCIMCalendar.CalendarUpdateType||(GCIMCalendar.CalendarUpdateType={}));var CalendarUpdateType=GCIMCalendar.CalendarUpdateType,HeaderFormat=function(){function a(){this._monthDayKeywords=[];this._monthDayKeywords[0]="y";this._monthDayKeywords[1]="M";this._monthDayKeywords[2]="\\";this._yearKeywords=[];this._yearKeywords[0]="y";this._yearKeywords[1]="\\";this._monthKeywords=[];this._monthKeywords[0]="M";this._monthKeywords[1]="\\"}a.prototype.ParseString=function(f,l,m){var d=[];if(f==null||f=="")return d;var j=m?this._monthKeywords:this._yearKeywords;if(l==CalendarType.MonthDay)j=this._monthDayKeywords;for(var h,a,b=0,k=false,c="",i=0;i<f.length;i++){a=f.substring(i,i+1);if(k){k=false;c+=a;continue}if(b>0&&h!=a){for(var g=this.CreateItem(h,b),e=0;e<g.length;e++)d.push(g[e]);b=0}else if(b==0&&c.length>0&&j.indexOf(a)!=-1){d.push(new HeaderItem("Literal",c));c=""}if(j.indexOf(a)==-1)c+=a;else switch(a){case"y":case"M":if(b==0)h=a;b++;break;case"\\":k=true;break;default:c+=a}}if(b>0)for(var g=this.CreateItem(h,b),e=0;e<g.length;e++)d.push(g[e]);else c.length>0&&d.push(new HeaderItem("Literal",c));return d};a.prototype.CreateItem=function(e,c){var b=[],a;switch(e){case"y":for(var d=0;d<Math.floor(c/4);d++)b.push(new HeaderItem("Year","y",4));a=c%4;a>0&&b.push(new HeaderItem("Year","y",a));break;case"M":for(var d=0;d<Math.floor(c/4);d++)b.push(new HeaderItem("Month","M",4));a=c%4;a>0&&b.push(new HeaderItem("Month","M",a))}return b};a.prototype.GetText=function(c,i,e,g){var f=this.ParseString(i,e,g),b="",l,k,j=false;if(f.length>0)for(var a,h=0;h<f.length;h++){a=f[h];switch(a.Type){case"Month":var d=c.getMonth()+1;if(a.Length<=2)b+=Utility.ToString(d,a.Length,"0");else if(a.Length==3)b+=Utility.IsJapan()?DateTimeInfo.ShortMonthNames[d-1]:DateTimeInfo.ShortMonthNamesEn[d-1];else b+=Utility.IsJapan()?DateTimeInfo.MonthNames[d-1]:DateTimeInfo.MonthNamesEn[d-1];break;case"Year":if(a.Length<=2)b+=Utility.ToString(c.getFullYear()%100,a.Length,"0");else if(a.Length==3)b+=c.getFullYear();else b+=Utility.ToString(c.getFullYear(),4,"0");break;default:b+=a.Text}}return j?e==CalendarType.YearMonth?this.GetText(c,"yyy?",e,g):this.GetText(c,"yyy? MMMM",e,g):b};return a}();GCIMCalendar.HeaderFormat=HeaderFormat;var CalendarData=function(){function a(a){this.isLongMonthPattern=null;this.Control=a;this.InitConstValue();this.InitInterface();this.InitInternal()}a.prototype.InitInterface=function(){this.MinDate=new Date(0,0,1);this.MinDate.setFullYear(0);this.MaxDate=new Date(99999,11,31,23,59,59);this.FocusDate=new Date(this.Today().valueOf());this.ForeColor="";this.BackColor="";this.HeaderBackColor="";this.HeaderForeColor="";this.Font=new Font;this.ControlEffect=ControlEffect.NotSet;this.XPTheme="";this.HeaderFormat=Utility.IsJapan()?"yyy? MMMM":"MMMM, yyyy";this.YearMonthFormat=Utility.IsJapan()?"yyy,MMMM":"yyy,MMM";this.TodayMarkColor="";this.Width=this.Height=this.DefaultControlWidth();this.ShowToday=false;this.CalendarType=CalendarType.MonthDay;this.SelectedDate=null};a.prototype.InitConstValue=function(){var a=this.Control._getId();this.CellStyleName=CalendarConstant.CONST_DEFAULT_CELL_STYLE;this.TrailingStyleName=a+"_Default_Calendar_Trailing_Style";this.SelectionStyleName=a+"_Default_Calendar_Selection_Style";this.ItemStyleName=a+"_Default_Calendar_Item_Style";this.HeaderStyleName=a+"_Default_Calendar_Header_Style";this.TodayStyleName=a+"_Default_Calendar_Today_Style";this.CalendarContainerStyleName=a+"_Calendar_Container_Style";this.DefaultTodayImagePath=Utility.BaseImageUrl+"Today"+Component._getImageExtends(".gif")};a.prototype.InitInternal=function(){this.Font.SetOwner(this);this.SelectedDate=new Date(this.Today().valueOf());this.InitStartDate()};a.prototype.SetShowToday=function(a){a=Utility.CheckBool(a);if(this.ShowToday!==a){this.ShowToday=a;this.Control.UpdateControl()}};a.prototype.SetHeaderBackColor=function(a){var a=Utility.CheckColor(a);if(this.HeaderBackColor!==a){this.HeaderBackColor=a;this.Control.UpdateControl(2)}};a.prototype.SetHeaderForeColor=function(a){var a=Utility.CheckColor(a);if(this.HeaderForeColor!==a){this.HeaderForeColor=a;this.Control.UpdateControl(2)}};a.prototype.SetBackColor=function(a){var a=Utility.CheckColor(a);if(this.BackColor!==a){this.BackColor=a;this.Control.UpdateControl(2)}};a.prototype.SetForeColor=function(a){var a=Utility.CheckColor(a);if(this.ForeColor!==a){this.ForeColor=a;this.Control.UpdateControl(2)}};a.prototype.SetControlEffect=function(a){Utility.CheckString(a);if(this.ControlEffect!==a){this.ControlEffect=a.toString().toLowerCase();this.Control.UpdateControl()}};a.prototype.GetControlEffect=function(){return this.ControlEffect};a.prototype.GetEnablejQueryTheme=function(){return this.GetControlEffect()===ControlEffect.JQueryUI};a.prototype.SetEnablejQueryTheme=function(a){if(a)this.SetControlEffect(ControlEffect.JQueryUI);else this.SetControlEffect(ControlEffect.NotSet)};a.prototype.SetCalendarType=function(a){Utility.CheckString(a);a=Utility.CheckEnum(CalendarType,a);if(this.CalendarType!==a){this.isLongMonthPattern=null;this.CalendarType=a;this.SetStartDateInternal(this.FocusDate);this.Control.UpdateControl()}};a.prototype.GetCalendarType=function(){return this.CalendarType};a.prototype.SetTodayMarkColor=function(a){Utility.CheckString(a);if(this.TodayMarkColor!==a){this.TodayMarkColor=a;this.Control.UpdateControl(2)}};a.prototype.SetHeaderFormat=function(a){Utility.CheckString(a);if(this.HeaderFormat!==a){this.HeaderFormat=a;this.Control.UpdateControl(1);this.Control.UpdateControl(2)}};a.prototype.SetYearMonthFormat=function(a){a=a==""?"yyy,MMMM":a;Utility.CheckString(a);if(this.YearMonthFormat!==a){this.YearMonthFormat=a;if(this.CalendarType===CalendarType.YearMonth){this.isLongMonthPattern=null;this.Control.UpdateControl(1);this.Control.UpdateControl(2)}}};a.prototype.SetSelectedDate=function(a){if(a!=null){Utility.CheckDate(a);if(a>this.MaxDate||a<this.MinDate)throw"The date is not in the valid range of MinDate and MaxDate.";}this.SetSelectedDateInternal(a)};a.prototype.SetSelectedDateInternal=function(a){if(a!=null){Utility.CheckDate(a);a=a<this.MinDate?this.MinDate:a;a=a>this.MaxDate?this.MaxDate:a}if(!DateTimeInfo.Equal(this.SelectedDate,a)){this.SelectedDate=a;this.Control.UpdateControl(4);this.Control.FireEvent(this.Control._specialClientEvents.SelectedDateChanged)}};a.prototype.SetFocusDate=function(a){Utility.CheckDate(a);if(a>this.MaxDate||a<this.MinDate)throw"The date is not in the valid range of MinDate and MaxDate.";this.SetFocusDateInternal(a)};a.prototype.SetFocusDateInternal=function(c){var b=this.SetFocusDateDirectInternal(c),a=this.SyncStartDateInternal();if(a){this.Control.UpdateControl(1);this.Control.UpdateControl(2)}else this.Control.UpdateControl(2);b&&this.Control.FireEvent(this.Control._specialClientEvents.FocusDateChanged);a&&this.Control.FireEvent(this.Control._specialClientEvents.Scrolled);return a};a.prototype.SetServerImagePath=function(b,a){if(typeof this.ServerImagePathList==="undefined")this.ServerImagePathList={};this.ServerImagePathList[b]=a};a.prototype.GetServerImagePath=function(a){if(typeof this.ServerImagePathList==="undefined")this.ServerImagePathList={};return this.ServerImagePathList[a]};a.prototype.DefaultStyleBorderWidth=function(){return 1};a.prototype.InnerControlEffect=function(){var a=this.ControlEffect;if(a===ControlEffect.NotSet||a===ControlEffect.JQueryUI)a=Utility.GetClientControlEffect();return a};a.prototype.ToolTipControlEffect=function(){return this.GetEnablejQueryTheme()?ControlEffect.JQueryUI:this.InnerControlEffect()};a.prototype.InnerBorderWidth=function(){return this.InnerControlEffect()===ControlEffect.Normal?"2px":"1px"};a.prototype.InnerBorderStyle=function(){return this.InnerControlEffect()==ControlEffect.Normal?"inset":"solid"};a.prototype.InnerBorderColor=function(){switch(this.InnerControlEffect()){case ControlEffect.XPTheme:return this.XPTheme===XPTheme.OliveGreen?"#a4b97f":"#7f9db9";case ControlEffect.Windows8Theme:return"#707070";case ControlEffect.Chrome:return"#A9A9A9";case ControlEffect.Ipad:return"#4C4C4C"}return"buttonface"};a.prototype.InnerWidth=function(){return this.Width==""||this.Width==0?this.DefaultControlWidth():this.Width};a.prototype.InnerHeight=function(){return this.Height==""||this.Height==0?this.DefaultControlWidth():this.Height};a.prototype.IsDefaultTodayStyle=function(){return this.IsDefaultItemStyle()&&this.TodayMarkColor===""};a.prototype.IsDefaultCalendarContainerStyle=function(){return this.BackColor===""};a.prototype.IsDefaultTrailingStyle=function(){return this.IsDefaultItemStyle()};a.prototype.IsDefaultItemStyle=function(){return this.BackColor!==""||this.ForeColor!=""?false:this.Font.IsDefaultFont()};a.prototype.IsDefaultSelectionStyle=function(){return this.IsDefaultItemStyle()};a.prototype.IsDefaultHeaderStyle=function(){return this.HeaderBackColor==""&&this.HeaderForeColor==""&&this.Font.IsDefaultFont()};a.prototype.GetTodayStyleImage=function(){var b="Today_Svg";if(GCIMCalendar.Component._getImageExtends(".gif")==".gif")b="Today_Gif";var a=this.GetServerImagePath(b);return a?a:this.DefaultTodayImagePath};a.prototype.GetCalendarContainerStyleName=function(){var a=Utility.DefaultControlStyle+" ";if(this.GetEnablejQueryTheme())a+="ui-widget-content ui-corner-all";else if(this.IsDefaultCalendarContainerStyle())switch(this.InnerControlEffect()){case ControlEffect.Windows8Theme:a+=CalendarConstant.CONST_DEFAULT_CONTAINER_STYLE_WIN8;break;case ControlEffect.Chrome:a+=CalendarConstant.CONST_DEFAULT_CONTAINER_STYLE_CHROME;break;case ControlEffect.Ipad:a+=CalendarConstant.CONST_DEFAULT_CONTAINER_STYLE_IPAD;break;default:a+=CalendarConstant.CONST_DEFAULT_CONTAINER_STYLE}else a+=this.CalendarContainerStyleName;return a};a.prototype.GetLegendStyleName=function(){var a=this.ItemStyleName;if(this.GetEnablejQueryTheme())a+=" "+this.GetLegendStyleJqueryUIName();return a};a.prototype.GetItemStyleName=function(){var a=this.ItemStyleName;if(this.IsDefaultItemStyle())a=CalendarConstant.CONST_DEFAULT_ITEM_STYLE;if(this.GetEnablejQueryTheme())a+=" "+this.GetItemStyleJqueryUIName();return a};a.prototype.GetTrailingStyleName=function(){var a=this.TrailingStyleName;if(this.IsDefaultTrailingStyle())a=CalendarConstant.CONST_DEFAULT_TRAILING_STYLE;if(this.GetEnablejQueryTheme())a+=" "+this.GetTrailingStyleJqueryUIName();return a};a.prototype.GetSelectionStyleName=function(){var a=this.SelectionStyleName;if(this.IsDefaultSelectionStyle())a=this.GetEnablejQueryTheme()?CalendarConstant.CONST_DEFAULT_JQUERY_SELECTION_STYLE:CalendarConstant.CONST_DEFAULT_SELECTION_STYLE;if(this.GetEnablejQueryTheme()){a+=" ui-widget-content ";a+=this.GetSelectionStyleJqueryUIName()}return a};a.prototype.GetTodayStyleName=function(){return this.IsDefaultTodayStyle()?CalendarConstant.CONST_DEFAULT_TODAY_STYLE:this.TodayStyleName};a.prototype.GetHeaderStyleName=function(){var a=this.HeaderStyleName;if(this.IsDefaultHeaderStyle())a=CalendarConstant.CONST_DEFAULT_HEADER_STYLE;if(this.GetEnablejQueryTheme())a+=" "+this.GetHeaderStyleJqueryUIName();return a};a.prototype.GetLeftNavigatorJqueryUIClassName=function(){return"ui-icon ui-icon-circle-triangle-w"};a.prototype.GetRightNavigatorJqueryUIClassName=function(){return"ui-icon ui-icon-circle-triangle-e"};a.prototype.GetItemStyleJqueryUIName=function(){return"ui-state-default"};a.prototype.GetTrailingStyleJqueryUIName=function(){return Utility.IsIE8OrBelow?"ui-state-hover":"ui-state-default ui-priority-secondary"};a.prototype.GetSelectionStyleJqueryUIName=function(){return"ui-state-active"};a.prototype.GetLegendStyleJqueryUIName=function(){return"ui-widget-content"};a.prototype.GetSingleCalendarStyleJqueryUIName=function(){return this.GetEnablejQueryTheme()?"ui-widget-content":""};a.prototype.GetHeaderStyleJqueryUIName=function(){return"ui-widget-header"};a.prototype.GetTodayStyleJqueryUIName=function(){return"ui-state-default ui-state-highlight"};a.prototype.GetImagePath=function(f,b,e,d,c,a){var g=typeof a==="undefined"?this.Control._typeOfImage(".gif"):a;return Utility.BaseImageUrl+this.GetImageName(f,b,e,d,c,a)+g};a.prototype.GetImageName=function(e,f,d,c,a){var b="_Normal",i,h="";if(d)b="_Pressed";else if(c)b="_Hover";var a=typeof a==="undefined"?CalendarUtility.GetThemeFolderName(this):a;return e+"_"+a+b};a.prototype.GetImageKeyName=function(h,c,g,f,d,b){var e=this.GetImageName(h,c,g,f,d,b),a=typeof b==="undefined"?this.Control._typeOfImage(".gif"):b;if(a==".gif")a="Gif";else if(a==".svg")a="Svg";return e+"_"+a};a.prototype.GetFirstMonthSelectionDate=function(a){var c=a.getFullYear(),b=a.getMonth();return new Date(c,b,1)};a.prototype.IsDateSelected=function(a){return DateTimeInfo.Equal(this.SelectedDate,a)};a.prototype.IsMonthSelected=function(a){return DateTimeInfo.YearMonthEqual(this.SelectedDate,a)};a.prototype.GetTitleForeColor=function(b){var a="";return b===0?a===""?"red":a:b===6?a===""?"blue":a:a};a.prototype.StartDate=function(){return this._startDate==null?null:new Date(this._startDate.valueOf())};a.prototype.InitStartDate=function(){this.SetStartDateInternal(this.FocusDate)};a.prototype.GetDisplayDateRange=function(){var c={},b=1,a=this.StartDate();if(this.CalendarType==CalendarType.MonthDay)var d=new Date(a.getFullYear(),a.getMonth()+b-1,DateTimeInfo.DaysInMonth(a.getFullYear(),a.getMonth()+b),23,59,59);else var d=new Date(a.getFullYear()+b-1,11,DateTimeInfo.DaysInMonth(a.getFullYear()+b-1,12),23,59,59);c.StartDate=new Date(a.valueOf());c.EndDate=new Date(d.valueOf());return c};a.prototype.SetStartDateInternal=function(b){var a=this.TrimStartDateByMaxMinRange(b);a=this.GetAdjustedStartDate(a);if(DateTimeInfo.Equal(this._startDate,a,false))return false;this._startDate=new Date(a.valueOf());return true};a.prototype.SyncFocusDateInternal=function(){var b=this.GetDisplayDateRange(),a=this.FocusDate;if(a>=b.StartDate&&a<=b.EndDate)return false;if(this.CalendarType==CalendarType.MonthDay){var c=0;if(a<b.StartDate)c=CalendarUtility.GetMonthDifference(b.StartDate,a);else if(a>b.EndDate)c=CalendarUtility.GetMonthDifference(b.EndDate,a);var f=a.getMonth()+1+c,e=DateTimeInfo.SetDate(a.getFullYear(),f,a.getDate())}else{var d=0;if(a<b.StartDate)d=b.StartDate.getFullYear()-a.getFullYear();else if(a>b.EndDate)d=b.EndDate.getFullYear()-a.getFullYear();var g=a.getFullYear()+d,e=DateTimeInfo.SetDate(g,a.getMonth()+1,a.getDate())}return this.SetFocusDateDirectInternal(e)};a.prototype.SetFocusDateDirectInternal=function(a){if(a>this.MaxDate)a=this.MaxDate;else if(a<this.MinDate)a=this.MinDate;a=new Date(a.valueOf());if(DateTimeInfo.Equal(a,this.FocusDate))return false;this.FocusDate=a;return true};a.prototype.SyncStartDateInternal=function(){var a=this.GetDisplayDateRange(),b=this.FocusDate;if(b>=a.StartDate&&b<=a.EndDate)return false;if(this.CalendarType==CalendarType.MonthDay){var c=0;if(b<a.StartDate)c=CalendarUtility.GetMonthDifference(b,a.StartDate);else if(b>a.EndDate)c=CalendarUtility.GetMonthDifference(b,a.EndDate);var f=a.StartDate.getMonth()+1+c,e=DateTimeInfo.SetDate(a.StartDate.getFullYear(),f,a.StartDate.getDate());return this.SetStartDateInternal(e)}else{var d=0;if(b<a.StartDate)d=b.getFullYear()-a.StartDate.getFullYear();else if(b>a.EndDate)d=b.getFullYear()-a.EndDate.getFullYear();var g=a.StartDate.getFullYear()+d,e=DateTimeInfo.SetDate(g,a.StartDate.getMonth()+1,a.StartDate.getDate());return this.SetStartDateInternal(e)}};a.prototype.TrimStartDateByMaxMinRange=function(a){a=new Date(a.valueOf());if(this.CalendarType==CalendarType.MonthDay){if(a<this.MinDate)a=new Date(this.MinDate.getFullYear(),this.MinDate.getMonth(),1);else if(a>this.MaxDate)a=new Date(this.MaxDate.getFullYear(),this.MaxDate.getMonth(),1);a.setDate(1)}else{if(a<this.MinDate)a=new Date(this.MinDate.getFullYear(),a.getMonth(),1);else if(a>this.MaxDate)a=new Date(this.MaxDate.getFullYear(),this.MaxDate.getMonth(),1);a.setDate(1)}return a};a.prototype.GetTodayStyleBackgroundImage=function(){return Utility.CheckCssImageUrl(this.GetTodayStyleImage())};a.prototype.GetAdjustedStartDate=function(a){var c=1,h=-1;if(this.CalendarType==CalendarType.MonthDay){var g=new Date(a.getFullYear(),a.getMonth()+c-1,DateTimeInfo.DaysInMonth(a.getFullYear(),a.getMonth()+c),23,59,59);if(g>this.MaxDate){a=new Date(this.MaxDate.getFullYear(),this.MaxDate.getMonth()-(c-1),1);if(a<this.MinDate)a=new Date(this.MinDate.getFullYear(),this.MinDate.getMonth(),1)}return a}else{var f=new Date(a.getFullYear()+c-1,a.getMonth(),DateTimeInfo.DaysInMonth(a.getFullYear()+c-1,a.getMonth()+1),23,59,59),d=0+1,e=a.getFullYear(),b=new Date(a.valueOf());if(a.getMonth()+1<d)e--;var b=new Date;b.setFullYear(e);b.setMonth(d-1);b.setDate(1);if(f.getFullYear()>this.MaxDate.getFullYear())b=new Date(this.MaxDate.getFullYear()-c+1,this.MaxDate.getMonth(),1);if(b<this.MinDate)b=new Date(this.MinDate.getFullYear(),this.MinDate.getMonth(),1);b.setHours(0);b.setMinutes(0);b.setSeconds(0);return b}return a};a.prototype.GetTitleText=function(a){return Utility.IsJapan()?DateTimeInfo.ShortWeekDays[a]:DateTimeInfo.ShortWeekDaysEn[a]};a.prototype.GetTodayText=function(){var a=this.Today(),b=a.getMonth()>=9?(a.getMonth()+1).toString():"0"+(a.getMonth()+1),c=a.getDate()>=10?a.getDate().toString():"0"+a.getDate();return Localization.GetString("ToolTip.Today")+" : "+a.getFullYear()+"/"+b+"/"+c};a.prototype.GetHeaderText=function(a){var d=new HeaderFormat,b="";if(!a)a=new Date(this.FocusDate.valueOf());if(this.CalendarType==CalendarType.MonthDay){if(DateTimeInfo.YearMonthEqual(a,DateTimeInfo.EraMin))a=new Date(DateTimeInfo.EraMin.valueOf());if(DateTimeInfo.YearMonthEqual(a,DateTimeInfo.EraMax))a=new Date(DateTimeInfo.EraMax.valueOf())}else{if(a.getFullYear()==DateTimeInfo.EraMin.getFullYear())a=new Date(DateTimeInfo.EraMin.valueOf());if(a.getFullYear()==DateTimeInfo.EraMax.getFullYear())a=new Date(DateTimeInfo.EraMax.valueOf())}if(this.CalendarType==CalendarType.MonthDay)b=d.GetText(a,this.HeaderFormat,CalendarType.MonthDay,false);else{var c=this.YearMonthFormat.split(",");if(c.length>0)b=d.GetText(a,c[0],CalendarType.YearMonth,false)}return b};a.prototype.GetMonthText=function(d){var c=new HeaderFormat,b="",a=this.YearMonthFormat.split(",");if(a.length>1)b=c.GetText(d,a[1],CalendarType.YearMonth,true);return b};a.prototype.ScrollSteps=function(a,d){if(d)if(this.CalendarType===CalendarType.MonthDay)a=a*12;else a=a*12*10;else{var b=1,c=CalendarUtility.GetMonthDifference(this.MaxDate,this.MinDate);if(b>c)b=c;if(this.CalendarType===CalendarType.MonthDay)a=a*b;else a=a*b*12}return a};a.prototype.IsLongMonthPattern=function(){if(this.CalendarType!=CalendarType.YearMonth)return false;if(this.isLongMonthPattern==null){this.isLongMonthPattern=false;for(var d=new HeaderFormat,b=d.ParseString(this.YearMonthFormat,CalendarType.YearMonth,true),a=0;a<b.length;a++){var c=b[a];if(c.Type=="Month"&&c.Length==4){this.isLongMonthPattern=true;break}}}return this.isLongMonthPattern};a.prototype.CalculateCalendarWidth=function(){if(!this.IsLongMonthPattern())return this.DefaultControlWidth();for(var a=this.DefaultControlWidth(),e=0,m=Utility.IsJapan(),o=new Date,p=new HeaderFormat,d=0,b=CalendarUtility.CreateTempDomElement(this),f=0,j=0;j<4;j++){for(var k=0,i=0;i<3;i++){var l=m?DateTimeInfo.MonthNames[d]:DateTimeInfo.MonthNamesEn[d],h=Utility.MeasureText("AAA"+l,b);k+=h.Width;f=Math.max(f,h.Height);d++}a=Math.max(a,k);e+=f}var n=a,c=this.ShowToday?this.DefaultTodayHeight():0;if(this.ShowToday){b=CalendarUtility.CreateTempDomElement(this);var g=Utility.MeasureText(this.GetTodayText(),b);if(g.Height>c)c=g.Height+4}e+=c;return Math.max(a,e)};a.prototype.GetCalendarAreaSize=function(){var c=0,d=0;if(this.IsLongMonthPattern()){var g=this.CalculateCalendarWidth();if(Math.max(this.Width,this.Height)<g)this.Width=this.Height=g}c=this.InnerWidth()==0?this.DefaultControlWidth():this.InnerWidth();d=this.InnerHeight()==0?this.DefaultControlWidth():this.InnerHeight();var a={};a.OutterSize=new Size(c,d);a.InnerSize=new Size(c,d);var h=c,b=this.ShowToday?this.DefaultTodayHeight():0;if(this.ShowToday){var i=CalendarUtility.CreateTempDomElement(this),f=Utility.MeasureText(this.GetTodayText(),i);if(f.Height>b)b=f.Height+4}d-=b;a.TodayAreaSize=new Size(h,b);var e=Utility.IsIE8?b-4:b;a.TodayMarkImageSize=new Size(e,e);a.CalendarAreaSize=new Size(c,d);a.TodayMarkSize=new Size(0,a.TodayAreaSize.Height);a.TodayTextSize=new Size(c-a.TodayMarkSize.Width,a.TodayAreaSize.Height);return a};a.prototype.GetSingleCalendarSize=function(){var a={},l=0,m=this.GetCalendarAreaSize().CalendarAreaSize,i=m.Width,h=m.Height;a.SingleCalendarContainerSize=new Size(i,h);a.SingleCalendarSize=new Size(i,h);var f=i,g=h;a.BodyContainerSize=new Size(f,g);f=f-16;var w=a.SingleCalendarSize.Width,d=0,x=CalendarUtility.CreateTempDomElement(this),t=Utility.MeasureText(this.GetHeaderText(),x);d=t.Height>this.DefaultOutlookArrowSize().Height?t.Height:this.DefaultOutlookArrowSize().Height;g-=d;a.BodyContainerSize.Height-=d;a.HeaderContainerSize=new Size(w,d);a.ArrowButtonSize=new Size(0,d);a.ArrowButtonSize.Width=this.DefaultOutlookArrowSize().Width;a.HeaderTextSize=new Size(a.HeaderContainerSize.Width-a.ArrowButtonSize.Width*2,d);if(this.CalendarType==CalendarType.MonthDay){var q=f,o=Math.floor(g/7),s=o,e=Math.floor(q/7),v=q-e*7;e=e>0?e:0;a.TitleSize=new Size(e,s);a.TitleSizeOffset=new Size(v,0);a.TitleContainerSize=new Size(e,s);var k=f,j=g-o;k-=8*l;j-=7*l;var c=Math.floor(k/7),p=k-c*7;c=c>0?c:0;var b=Math.floor(j/6),n=j-b*6;b=b>0?b:0;a.DaySize=new Size(c,b);a.DaySizeOffset=new Size(p,n);a.DayContainerSize=new Size(c,b)}else{var u=f,r=g,c=Math.floor(u/3),p=u-c*3;c=c>0?c:0;var b=Math.floor(r/4),n=r-b*4;b=b>0?b:0;a.MonthSize=new Size(c,b);a.MonthSizeOffset=new Size(p,n);a.MonthContainerSize=new Size(c,b)}return a};a.prototype.DefaultStyleBackColor=function(){return"window"};a.prototype.DefaultTrailingStyleForeColor=function(){return"#959595"};a.prototype.DefaultHeaderStyleBackColor=function(){return this.InnerControlEffect()==ControlEffect.Normal?"buttonface":"#F0F0F0"};a.prototype.DefaultSelectionStyleBackColor=function(){return Utility.HighlightColor};a.prototype.DefaultSelectionStyleForeColor=function(){return this.GetEnablejQueryTheme()?"":"highlighttext"};a.prototype.Today=function(){return Utility.GetCurrentDate()};a.prototype.DefaultTodayHeight=function(){return 20};a.prototype.DefaultOutlookArrowSize=function(){return new Size(21,21)};a.prototype.DefaultOutlookArrowImageSize=function(){return Utility.IsIE9?this.ControlEffect===ControlEffect.Normal?new Size(4,7):new Size(14,7):new Size(21,21)};a.prototype.DefaultOutlookZoomImageSize=function(){return Utility.IsIE9&&!this.GetEnablejQueryTheme()?new Size(14,9):new Size(21,21)};a.prototype.DefaultControlWidth=function(){return 186};a.prototype.FontChanged=function(){this.Control.UpdateControl()};return a}();GCIMCalendar.CalendarData=CalendarData;var CalendarRender=function(){function a(a){this._needUpdateScrollBarImage=true;this.Control=a;this.Data=a.Data}a.prototype.CreateCalendar=function(){var a=this;this.CellClickHandler=function(b){a.Control.UIProcess.onCellClickHandler(b)};this.CellMouseDownHandler=function(b){a.Control.UIProcess.onCellMouseDownHandler(b)};this.CellMouseUpHandler=function(b){a.Control.UIProcess.onCellMouseUpHandler(b)};this.CellMouseEnterHandler=function(b){a.Control.UIProcess.onCellMouseEnterHandler(b)};this.CellMouseLeaveHandler=function(b){a.Control.UIProcess.onCellMouseLeaveHandler(b)};this.MouseWheelHandler=function(b){a.Control.UIProcess.onMouseWheelHandler(b)};this.MSPointerDownHandler=function(b){a.Control.UIProcess.onMSPointerDown(b)};this.MSPointerMoveHandler=function(b){a.Control.UIProcess.onMSPointerMove(b)};this.MSPointerUpHandler=function(b){a.Control.UIProcess.onMSPointerUp(b)};this.MSGestureStartHandler=function(b){a.Control.UIProcess.onMSGestureStart(b)};this.MSGestureChangeHandler=function(b){a.Control.UIProcess.onMSGestureChange(b)};this.MSGestureEndHandler=function(b){a.Control.UIProcess.onMSGestureEnd(b)};this.MSGestureHoldHandler=function(b){a.Control.UIProcess.onMSGestureHold(b)};this.TouchStartHandler=function(b){a.Control.UIProcess.onTouchStartHandler(b)};this.TouchMoveHandler=function(b){a.Control.UIProcess.onTouchMoveHandler(b)};this.TouchEndHandler=function(b){a.Control.UIProcess.onTouchEndHandler(b)};this.DocumentTouchStartHandler=function(b){a.Control.UIProcess.onDocumentTouchStartHandler(b)};this.DocumentMouseDownHandler=function(b){a.Control.UIProcess.onDocumentMouseDownHandler(b)};this.DocumentMouseUpHandler=function(b){a.Control.UIProcess.onDocumentMouseUpHandler(b)};this.DocumentMouseMoveHandler=function(b){a.Control.UIProcess.onDocumentMouseMoveHandler(b)};this.DocumentTouchMoveHandler=function(b){a.Control.UIProcess.onDocumentTouchMoveHandler(b)};this.DocumentKeyDownHandler=function(b){var c=b.srcElement||b.target;if(a.isActive)a.Control.UIProcess.onKeyDownHandler(b)};this.KeyDownHandler=function(b){a.Control.UIProcess.onKeyDownHandler(b)};this.FocusHandler=function(){a.Control.SetFocus()};this.ContextMenuHandler=function(b){a.Control.UIProcess.onContextMenuHandler(b)};this._calendarElementEventMappingTable={mousedown:[1,this.CellMouseDownHandler],mouseup:[2,this.CellMouseUpHandler],mouseover:[4,this.CellMouseEnterHandler],mouseout:[8,this.CellMouseLeaveHandler],click:[16,this.CellClickHandler],touchstart:[32,this.TouchStartHandler],touchend:[64,this.TouchEndHandler],touchmove:[128,this.TouchMoveHandler],mousemove:[256,this.TouchMoveHandler],MSPointerDown:[512,this.MSPointerDownHandler],MSPointerMove:[1024,this.MSPointerMoveHandler],MSPointerUp:[2048,this.MSPointerUpHandler],MSGestureStart:[4096,this.MSGestureStartHandler],MSGestureChange:[8192,this.MSGestureChangeHandler],MSGestureEnd:[16384,this.MSGestureEndHandler],MSGestureHold:[32768,this.MSGestureHoldHandler]};this.CreateOutterContainer();return this.CalendarSectionDom.OutterContainerDiv};a.prototype.UpdateControl=function(){var a=this.CalendarSectionDom.OutterContainer;Utility.ClearChildren(a);this.UpdateAllStyleRule();CalendarUtility.UpdateAutoSize(this.Data);this.CreateCalendarSectionFrame();this.UpdateCalendarSectionData();this.UpdateCalendarSectionStyle();this.UpdateCalendarSectionEvent();return a};a.prototype.CreateAccessKeyEvent=function(){if(this.Control._accessKey==="")return;var a=this.CalendarSectionDom.OutterContainerDiv;a.setAttribute("accessKey",this.Control._accessKey)};a.prototype.CreateCalendarSectionFrame=function(){this.CalendarSectionDom.SingleCalendarDom=[];var e=this.CalendarSectionDom.OutterContainer,d=Utility.CreateInnerTbody(),c=Utility.CreateInnerTableRow(),b=Utility.CreateInnerTableCell(this.Data.CellStyleName),a=this.CreateCalendarAreaFrame();b.appendChild(a);c.appendChild(b);d.appendChild(c);e.appendChild(d);a.setAttribute("CellType","CalendarSectionArea");this.CalendarSectionDom.CalendarSectionCell=a};a.prototype.UpdateCalendarSectionData=function(){var a=this.Data.StartDate();if(this.CalendarSectionDom.TodayCellDom){this.CalendarSectionDom.TodayCellDom.className="";this.CalendarSectionDom.TodayCellDomContentDiv.style.marginBottom="";this.ClearTodayCellImage()}this.CalendarSectionDom.TodayCellDom=null;this.singleCalendarSizeCache=this.Data.GetSingleCalendarSize();this.UpdateSingleCalendarData(0,1,1,a);if(this.Data.CalendarType==CalendarType.MonthDay){var b=a.getMonth();a.setMonth(b+1)}else{var c=a.getFullYear();a.setFullYear(c+1)}this.Data.ShowToday&&this.UpdateTodayData();this.singleCalendarSizeCache=null};a.prototype.UpdateCalendarSectionStyle=function(){CalendarUtility.UpdateAutoSize(this.Data);this.UpdateContainerStyle();this.UpdateHeaderStyle();this.UpdateBodyStyle();this.UpdateTodayStyle();this.UpdateSelectionStyle()};a.prototype.UpdateCalendarSectionEvent=function(){this.UpdateContainerEvent();this.UpdateHeaderEvent();this.UpdateBodyEvent();this.UpdateTodayEvent()};a.prototype.CreateCalendarAreaFrame=function(){var c=this.Data.CellStyleName,b=Utility.CreateInnerTable(),d=Utility.CreateInnerTbody(),i=Utility.CreateInnerTableRow(),h=Utility.CreateInnerTableCell(c),k=Utility.CreateInnerTableRow(),j=Utility.CreateInnerTableCell(c),a=Utility.CreateInnerTable(),e=Utility.CreateInnerTbody();a.setAttribute("elementType","tableSingleCalendarArea");var n=0,g=Utility.CreateInnerTableRow(),f=Utility.CreateInnerTableCell(c),l=this.CreateSingleCalendarFrame(n);f.appendChild(l);g.appendChild(f);e.appendChild(g);a.appendChild(e);h.appendChild(a);i.appendChild(h);b.appendChild(d);d.appendChild(i);var m=this.CreateTodayFrame();j.appendChild(m);k.appendChild(j);d.appendChild(k);this.CalendarSectionDom.TableSectionAreaDom=b;return b};a.prototype.CreateSingleCalendarFrame=function(a){this.CalendarSectionDom.SingleCalendarDom[a]={};var e=CalendarUtility.CreateInnerDiv(),b=Utility.CreateInnerTable(),c=Utility.CreateInnerTbody();b.appendChild(c);c.appendChild(this.CreateHeaderFrame(a));if(this.Data.CalendarType==CalendarType.MonthDay)c.appendChild(this.CreateMonthFrame(a));else c.appendChild(this.CreateYearFrame(a));b.setAttribute("elementType","tableSingleCalendar"+a);var d=this.CalendarSectionDom.SingleCalendarDom[a];d.OutterSingleCalendarContainer=b;d.OutterSingleCalendarContainerDiv=e;return b};a.prototype.CreateMonthFrame=function(i){var l=this.Data.CellStyleName,a=this.CalendarSectionDom.SingleCalendarDom[i],k=Utility.CreateInnerTableRow(),g=Utility.CreateInnerTableCell(l),f=CalendarUtility.CreateInnerDiv();g.style.padding="0px";var b=Utility.CreateInnerTable(),n=Utility.CreateInnerTbody();b.setAttribute("elementType","tableBody"+i);b.setAttribute("id",this.Control._getId()+"_"+i+"_Body_Table");a.TitleDom=[];a.RowsDom=[];a.InnerSingleCalendarContainer=b;a.InnerSingleCalendarContainerDiv=f;for(var d=0,m=0,e=0;e<7;e++){d=0;for(var h=[],o=Utility.CreateInnerTableRow(),c=0;c<8;c++){var j=Utility.CreateInnerTableCell(l);o.appendChild(j);if(c!=0)if(e==0){a.TitleDom[c-1]={ContainerCell:j};CalendarUtility.CreateTitleDom(this.Data,a.TitleDom[c-1])}else{h[d]={ContainerCell:j};CalendarUtility.CreateDayItemDom(this.Data,h[d]);d++}}n.appendChild(o);if(e!=0){a.RowsDom[m]=h;m++}}b.appendChild(n);f.appendChild(b);g.appendChild(f);k.appendChild(g);return k};a.prototype.CreateYearFrame=function(j){var i=this.Data.CellStyleName,a=this.CalendarSectionDom.SingleCalendarDom[j],h=Utility.CreateInnerTableRow(),g=Utility.CreateInnerTableCell(i),d=Utility.CreateInnerDiv(),b=Utility.CreateInnerTable(),k=Utility.CreateInnerTbody();b.appendChild(k);b.setAttribute("id",this.Control._getId()+"_"+j+"_Body_Table");a.TitleDom=[];a.RowsDom=[];a.InnerSingleCalendarContainer=b;a.InnerSingleCalendarContainerDiv=d;for(var f=0;f<4;f++){for(var e=[],m=Utility.CreateInnerTableRow(),c=0;c<3;c++){var l=Utility.CreateInnerTableCell(i);m.appendChild(l);e[c]={ContainerCell:l};CalendarUtility.CreateMonthItemDom(this.Data,e[c])}k.appendChild(m);a.RowsDom[f]=e}d.appendChild(b);g.appendChild(d);h.appendChild(g);return h};a.prototype.UpdateSingleCalendarData=function(a,d,c,b){this.UpdateHeaderData(a,d,c,b);if(this.Data.CalendarType==CalendarType.MonthDay){this.UpdateTitleData(a);this.UpdateMonthData(a,d,c,b)}else this.UpdateYearData(a,d,c,b)};a.prototype.UpdateBodyStyle=function(){for(var a=0;a<this.CalendarSectionDom.SingleCalendarDom.length;a++)if(this.Data.CalendarType==CalendarType.MonthDay){this.UpdateTitleStyle(a);this.UpdateDaysStyle(a)}else this.UpdateYearStyle(a)};a.prototype.UpdateBodyEvent=function(){if(this.Data.CalendarType==CalendarType.MonthDay){this.UpdateMonthEvent();this.UpdateTitleEvent()}else this.UpdateYearEvent()};a.prototype.CreateOutterContainer=function(){var a=Utility.CreateInnerDiv();a.setAttribute("id",this.Control._getId()+"_Outter_Container");a.setAttribute(Utility.IMControlIDAttribute,this.Control._getId());a.setAttribute("iMControlType","Calendar");a.style.outlineStyle="none";var b=Utility.CreateInnerTable();b.setAttribute("elementType","OutterContainer");b.setAttribute("CellType","OutterContainer");b.setAttribute("id",this.Control._getId()+"_Outter_Table");a.appendChild(b);this.CalendarSectionDom=new CalendarSection;this.CalendarSectionDom.OutterContainer=b;this.CalendarSectionDom.OutterContainerDiv=a};a.prototype.UpdateContainerStyle=function(){var i=this.singleCalendarSizeCache==null?this.Data.GetSingleCalendarSize():this.singleCalendarSizeCache,g=this.CalendarSectionDom.OutterContainerDiv,l=this.CalendarSectionDom.OutterContainer,h=this.CalendarSectionDom.SingleCalendarDom;this.UpdateContainerStyleRule();g.className=this.Data.GetCalendarContainerStyleName();var b=g.style;b.width=this.Data.InnerWidth()+"px";b.height=this.Data.InnerHeight()+"px";b.cursor="default";var e=l.style;e.padding="0px";CSSHelper.SetTouchAction(e,"none");for(var d=0;d<h.length;d++){var c=h[d],m=c.InnerSingleCalendarContainer,f=m.style;f.marginLeft="8px";f.marginRight="8px";var j=c.InnerSingleCalendarContainerDiv;j.style.width=i.BodyContainerSize.Width+"px";j.style.height=i.BodyContainerSize.Height+"px";var a=c.OutterSingleCalendarContainer,k=this.Data.GetSingleCalendarStyleJqueryUIName();if(k!=""){a.className=k;a.style.borderWidth="0px"}else{a.className="";a.style.borderWidth=""}}};a.prototype.UpdateContainerEvent=function(){var b=this.CalendarSectionDom.OutterContainerDiv,a=this.CalendarSectionDom.OutterContainer,c=this.CalendarSectionDom.TableSectionAreaDom;a.oncontextmenu=function(){return false};a.onselectstart=function(){return false};Utility.AttachEvent(b,"focus",this.FocusHandler,false);Utility.AttachEvent(a,"contextmenu",this.ContextMenuHandler,false);Utility.AttachEvent(a,"mouseout",this.CellMouseLeaveHandler,false);if(Utility.firefox)Utility.AttachEvent(a,"DOMMouseScroll",this.MouseWheelHandler,false);else Utility.AttachEvent(a,"mousewheel",this.MouseWheelHandler,false);if(Utility.chrome||Utility.firefox||Utility.safari)Utility.AttachEvent(document.body,"keydown",this.DocumentKeyDownHandler);else Utility.AttachEvent(b,"keydown",this.KeyDownHandler,false);(Utility.IsPad()||Utility.chrome)&&Utility.AttachEvent(document,"touchstart",this.DocumentTouchStartHandler,false);if(Utility.IsTouch()){Utility.AttachEvent(document,"MSPointerDown",this.DocumentTouchStartHandler,false);this.AttachElementEvent(a,16384|512|32768|4096|8192)}else this.AttachElementEvent(a,32|128|64);Utility.AttachEvent(c,"mouseup",this.CellMouseUpHandler,false);Utility.AttachEvent(document,"mousedown",this.DocumentMouseDownHandler,false);Utility.AttachEvent(document,"mouseup",this.DocumentMouseUpHandler,false);Utility.AttachEvent(document,"mousemove",this.DocumentMouseMoveHandler,false);Utility.AttachEvent(document.body,"touchmove",this.DocumentTouchMoveHandler,false)};a.prototype.CreateHeaderFrame=function(j){var e=this.Data.CellStyleName,h=Utility.CreateInnerTableRow(),f=Utility.CreateInnerTableCell(e);f.style.padding="0px";var b=Utility.CreateInnerTable(),k=Utility.CreateInnerTbody(),i=Utility.CreateInnerTableRow(),d=this.CreateHeaderButton(e),c=this.CreateHeaderButton(e),a=this.CreateHeaderButton(e);b.setAttribute("elementType","tableHeader");b.setAttribute("id",this.Control._getId()+"_"+j+"_Header_Table");h.appendChild(f);f.appendChild(b);b.appendChild(k);k.appendChild(i);var g=[a.Container];g.unshift(d.Container);g.push(c.Container);this.AppendChildElements(i,g);var l=this.CalendarSectionDom.SingleCalendarDom[j];l.HeaderDom={HeaderContainer:b,LeftNavigatorButton:d.Container,LeftNavigatorButtonDiv:d.InnerDiv,InnerLeftNavigatorButton:d.InnerButton,HeaderTextButton:a.Container,HeaderTextDiv:a.InnerDiv,InnerHeaderTextButton:a.InnerButton,RightNavigatorButton:c.Container,RightNavigatorButtonDiv:c.InnerDiv,InnerRightNavigatorButton:c.InnerButton,HeaderTextButtonContentTable:a.ContentTable};return h};a.prototype.CreateHeaderButton=function(e){var c=Utility.CreateInnerTableCell(e),b=CalendarUtility.CreateInnerDiv(),a=Utility.CreateInnerTable(),d=Utility.CreateInnerTbody(),g=Utility.CreateInnerTableRow(),f=Utility.CreateInnerTableCell(e);c.appendChild(b);b.appendChild(a);a.appendChild(d);d.appendChild(g);g.appendChild(f);return{Container:c,InnerDiv:b,InnerButton:f,ContentTable:a}};a.prototype.UpdateHeaderData=function(l,p,o,b){var a=this.CalendarSectionDom.SingleCalendarDom[l].HeaderDom,c=a.InnerHeaderTextButton,g=this.Data.GetHeaderText(b);if(c.childNodes.length==0)c.appendChild(Utility.CreateInnerTextNode(g));else c.childNodes[0].nodeValue=g;var d=a.HeaderTextButton;d.setAttribute("HeaderIndex",l);d.setAttribute("CellValue",b.getFullYear()+"/"+(b.getMonth()+1)+"/"+b.getDate());d.setAttribute("CellType","HeaderText");if(p==1)if(o==1){var f=a.InnerLeftNavigatorButton,n=a.LeftNavigatorButtonImage;if(typeof n==="undefined"){var i=CalendarUtility.CreateNavigatorImage(this.Data,"Calendar_OutlookArrow_Left"),k=CalendarUtility.CreateNavigatorSpanElement(this.Data.GetLeftNavigatorJqueryUIClassName());f.appendChild(k);f.appendChild(i);a.LeftNavigatorButtonImage=i;a.LeftNavigatorButtonSpan=k;a.LeftNavigatorButton.setAttribute("CellType","OutlookLeftNavigator")}var e=a.InnerRightNavigatorButton,m=a.RightNavigatorButtonImage;if(typeof m==="undefined"){var h=CalendarUtility.CreateNavigatorImage(this.Data,"Calendar_OutlookArrow_Right"),j=CalendarUtility.CreateNavigatorSpanElement(this.Data.GetRightNavigatorJqueryUIClassName());e.appendChild(j);e.appendChild(h);a.RightNavigatorButtonImage=h;a.RightNavigatorButtonSpan=j;a.RightNavigatorButton.setAttribute("CellType","OutlookRightNavigator")}}};a.prototype.UpdateHeaderStyle=function(){for(var f=this.singleCalendarSizeCache==null?this.Data.GetSingleCalendarSize():this.singleCalendarSizeCache,h=this.CalendarSectionDom.SingleCalendarDom,k=f.HeaderTextSize,j=f.ArrowButtonSize,d=0;d<h.length;d++){var a=h[d].HeaderDom,c=a.HeaderContainer,b=a.HeaderTextButton,e=a.InnerHeaderTextButton;CalendarUtility.ResetHeaderDom(a);c.className=this.Data.GetHeaderStyleName();c.style.borderWidth="0px";if(Utility.IsQuriksMode)a.HeaderTextButtonContentTable.className=c.className+" "+this.Data.CellStyleName;if(Utility.chrome||Utility.safari)if(this.ItemStyleRule)e.style.textDecoration=this.ItemStyleRule.style.textDecoration;e.setAttribute("vAlign","middle");b.className="";b.style.padding="0px";b.style.whiteSpace="nowrap";a.InnerHeaderTextButton.className="";a.InnerHeaderTextButton.style.padding="0px";a.LeftNavigatorButton.style.fontSize="1px";a.RightNavigatorButton.style.fontSize="1px";if(Utility.IsIE8OrBelow){a.InnerLeftNavigatorButton.setAttribute("vAlign","middle");a.InnerRightNavigatorButton.setAttribute("vAlign","middle")}var g=this.Data.GetEnablejQueryTheme()?"none":"",i=this.Data.GetEnablejQueryTheme()?"":"none";this.SetElementsDisplay(a.LeftNavigatorButtonImage,g);this.SetElementsDisplay(a.RightNavigatorButtonImage,g);this.SetElementsDisplay(a.LeftNavigatorButtonSpan,i);this.SetElementsDisplay(a.RightNavigatorButtonSpan,i);this.SetElementsSize([a.HeaderTextDiv,a.HeaderTextButton,a.InnerHeaderTextButton],k);this.SetElementsSize([a.LeftNavigatorButton,a.LeftNavigatorButtonDiv,a.InnerLeftNavigatorButton],j);this.SetElementsSize([a.RightNavigatorButton,a.RightNavigatorButtonDiv,a.InnerRightNavigatorButton],j);this.Control._typeOfImage(".gif")===".svg"&&(Utility.IsIE9||Utility.IsIE10)&&this.SetElementsSize([a.LeftNavigatorButtonImage,a.RightNavigatorButtonImage],this.Data.DefaultOutlookArrowImageSize())}};a.prototype.UpdateHeaderEvent=function(){for(var c=this.CalendarSectionDom.SingleCalendarDom,b=0;b<c.length;b++){var d=c[b],a=d.HeaderDom;if(Utility.IsPad())this.AttachElementEvent(a.HeaderTextButton,32);else this.AttachElementEvent(a.HeaderTextButton,512|1|2);if(b==0){this.AttachElementEvent(a.LeftNavigatorButton,1|2|8);this.AttachElementEvent(a.RightNavigatorButton,1|2|8)}}};a.prototype.UpdateTitleData=function(d){for(var e=this.CalendarSectionDom.SingleCalendarDom[d],a=0;a<7;a++){var g=a%7,f=this.Data.GetTitleText(a),c=e.TitleDom[a],b=c.ContainerCell;c.ContentTextNode.nodeValue=f;b.setAttribute("CellType","Title");b.setAttribute("CalendarIndex",d);b.setAttribute("CellValue",a);b.setAttribute("WeekValue",g)}};a.prototype.UpdateTitleStyle=function(q){for(var e=this.singleCalendarSizeCache==null?this.Data.GetSingleCalendarSize():this.singleCalendarSizeCache,j=this.CalendarSectionDom.SingleCalendarDom[q],f=0;f<j.TitleDom.length;f++){var a=j.TitleDom[f],c=a.ContainerCell,d=c.style,b=a.ContentCell,o=a.ContentTable,s=a.ContainerStyleDiv,h=this.Data.IsDefaultItemStyle(),l=this.Data.GetItemStyleName(),i="",r=parseInt(a.ContainerCell.getAttribute("WeekValue"),10);if(h&&this.Data.GetEnablejQueryTheme())i="transparent";CalendarUtility.ResetTitleCellDom(a);c.className=l;c.style.color=this.Data.GetTitleForeColor(r);c.style.backgroundColor=i;if(Utility.IsQuriksMode)o.className=this.Data.CellStyleName+" "+l;d.padding="0px";c.style.borderWidth="0px";b.style.padding="0px";b.className="";b.style.vAlign="middle";if(Utility.chrome||Utility.safari)if(this.ItemStyleRule)b.style.textDecoration=this.ItemStyleRule.style.textDecoration;var g="1px";if(Utility.IsIE8OrBelow){d.borderBottomWidth=g;d.borderTopWidth=g;d.borderRightWidth=g}if(f==0)d.borderLeftWidth=g;if(this.Data.GetEnablejQueryTheme())if(this.ItemStyleRule){b.style.fontFamily=h?"":this.ItemStyleRule.style.fontFamily;b.style.fontSize=h?"":this.ItemStyleRule.style.fontSize}var k=e.TitleContainerSize.Width,n=e.TitleContainerSize.Height,m=e.TitleSize.Width,p=e.TitleSize.Height;if(e.TitleSizeOffset.Width>f){m+=1;k+=1}CalendarUtility.SetCellSize(c,k,n);this.SetElementsWidthHeight([a.ContainerStyleDiv,b,a.ContainerDiv],m,p)}};a.prototype.UpdateTitleEvent=function(){for(var c=this.CalendarSectionDom.SingleCalendarDom,a=0;a<c.length;a++)for(var d=c[a],b=0;b<7;b++){var e=d.TitleDom[b].ContainerCell;this.AttachElementEvent(e,16|4|8|1|2|32|128|64)}};a.prototype.UpdateMonthData=function(b,i,h,e){var k=this.CalendarSectionDom.SingleCalendarDom[b],g=new Date(e.getFullYear(),e.getMonth(),1),n=(7+g.getDay())%7,o=g.getDate(),a=new Date(g.getFullYear(),g.getMonth(),o-n),m=false,p=DateTimeInfo.DaysInMonth(e.getFullYear(),e.getMonth()+1);if(g.getDay()==0&&p===28){var o=a.getDate();a.setDate(o-7);m=true}for(var r=1,l=false,i=0;i<k.RowsDom.length;i++)for(var h=0;h<7;h++){var c=k.RowsDom[i][h],d=c.ContainerCell,j=CalendarUtility.IsValidateDate(this.Data,a);if(i==0){var f="EmptyDay";if(h<n||m)if(b==0){this.UpdateTrailingDayData(c,b,a);f=j?"TrailingDay":"DisableDay"}else this.UpdateEmptyDayData(c);else{this.UpdateCommonDayData(c,b,a);f=j?"CommonDay":"DisableDay"}d.setAttribute("CellType",f)}else{var f="EmptyDay";if(!l){var q=DateTimeInfo.DaysInMonth(e.getFullYear(),e.getMonth()+1);if(a.getDate()==q)l=true;this.UpdateCommonDayData(c,b,a);f=j?"CommonDay":"DisableDay"}else if(b==0){this.UpdateTrailingDayData(c,b,a);f=j?"TrailingDay":"DisableDay"}else this.UpdateEmptyDayData(c);d.setAttribute("CellType",f)}d.setAttribute("id",this.Control._getId()+"_"+a.getFullYear()+"_"+(a.getMonth()+1)+"_"+a.getDate());d.setAttribute("CellValue",a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate());d.setAttribute("CalendarIndex",b);d.setAttribute("TitleIndex",h);d.setAttribute("WeekNumberIndex",i);a.setDate(a.getDate()+1)}};a.prototype.UpdateCommonDayData=function(a,d,c){var b=this.CalendarSectionDom;a.ContentTextNode.nodeValue=c.getDate();if(DateTimeInfo.Equal(this.Data.Today(),c)){b.TodayCellDom=a.ContainerCellDiv;b.TodayCellDomContainer=a.ContainerCell;b.TodayCellDomContentTable=a.ContentTable;b.TodayCellDomContentDiv=a.ContentDiv}};a.prototype.UpdateTrailingDayData=function(b,c,a){b.ContentTextNode.nodeValue=a.getDate()};a.prototype.UpdateEmptyDayData=function(a){a.ContentTextNode.nodeValue=""};a.prototype.UpdateDaysStyle=function(o){for(var e=this.singleCalendarSizeCache==null?this.Data.GetSingleCalendarSize():this.singleCalendarSizeCache,k=this.CalendarSectionDom.SingleCalendarDom[o],h=this.Data.IsDefaultItemStyle(),d=0;d<6;d++)for(var c=0;c<7;c++){var b=k.RowsDom[d][c],n=b.ContainerCell.getAttribute("CellType"),a=CalendarUtility.CreateDayCellDomStyle();switch(n){case"CommonDay":this.UpdateCommonDayStyle(b,a,d,c);break;case"TrailingDay":this.UpdateTrailingDayStyle(b,a,d,c);break;case"DisableDay":this.UpdateDisableDayStyle(b,a,d,c);break;case"EmptyDay":this.UpdateEmptyDayStyle(b,a,d,c)}a.ContainerCellDiv.className="";a.ContentCell.className="";a.ContainerCell.style.padding="0px";a.ContainerCellDiv.style.marginLeft="auto";a.ContainerCellDiv.style.marginRight="auto";if(this.Data.GetEnablejQueryTheme()){a.ContentCell.style.fontFamily=h?"":this.ItemStyleRule.style.fontFamily;a.ContentCell.style.fontSize=h?"":this.ItemStyleRule.style.fontSize}var j=e.DayContainerSize.Width,i=e.DayContainerSize.Height,g=e.DaySize.Width,f=e.DaySize.Height;if(e.DaySizeOffset.Width>c){g+=1;j+=1}if(e.DaySizeOffset.Height>d){f+=1;i+=1}var m=Math.max(g-2,0),l=Math.max(f-2,0);CalendarUtility.SetCellSize(b.ContainerCell,j,i);CalendarUtility.SetCellSize(b.ContainerStyleDiv,g,f);this.SetElementsWidthHeight([b.ContainerCellDiv,b.ContentCell],m,l);CalendarUtility.SetDayCellDomStyle(b,a)}};a.prototype.UpdateCommonDayStyle=function(j,c){var f=c.ContainerCell,g=c.ContentCell,d=c.ContainerCell,k="",h="",i=DateTimeInfo.String2Date(j.ContainerCell.getAttribute("CellValue"));d.className=this.Data.GetItemStyleName();d.styleName=d.className;var a=d.style;a.padding="";if(this.Data.IsDefaultItemStyle()){a.color="";a.border="none 0px black";a.fontWeight="";a.backgroundColor="window";a.backgroundImage="";a.backgroundPosition="center center";if(Utility.chrome||Utility.safari)g.style.textDecoration=""}else{var b=this.ItemStyleRule.style;a.color=b.color;a.border=b.border;a.fontWeight=b.fontWeight;a.backgroundColor=b.backgroundColor;a.backgroundImage=b.backgroundImage;a.backgroundPosition=b.backgroundPosition;if(Utility.chrome||Utility.safari)g.style.textDecoration=b.textDecoration}var e=i.getDay();if(e===0||e===6){c.ContainerStyleDiv.style.color=this.Data.GetTitleForeColor(e);f.style.color=this.Data.GetTitleForeColor(e)}if(Utility.IsQuriksMode){c.ContentTable.className=this.Data.CellStyleName+" "+d.className;c.ContentTable.styleName=c.ContentTable.className}f.holidayName=h;f.holidayType=k;g.vAlign="middle"};a.prototype.UpdateTrailingDayStyle=function(g,c){var f=this.Data.IsDefaultTrailingStyle(),h=c.ContainerCell,e=c.ContentCell,d=c.ContainerCell,i=DateTimeInfo.String2Date(g.ContainerCell.getAttribute("CellValue"));d.className=this.Data.GetTrailingStyleName();d.styleName=d.className;var a=d.style;a.padding="";if(f){a.color="#959595";a.border="none 1px black";a.fontWeight="";a.backgroundColor="window";a.backgroundImage="";a.backgroundPosition="center center"}else{var b=this.TrailingStyleRule.style;a.color=b.color;a.border=b.border;a.fontWeight=b.fontWeight;a.backgroundColor=b.backgroundColor;a.backgroundImage=b.backgroundImage;a.backgroundPosition=b.backgroundPosition}e.vAlign="middle";if(Utility.chrome||Utility.safari)if(this.ItemStyleRule)e.style.textDecoration=this.ItemStyleRule.style.textDecoration;if(Utility.IsQuriksMode){c.ContentTable.className=this.Data.CellStyleName+" "+d.className;c.ContentTable.styleName=c.ContentTable.className}};a.prototype.UpdateEmptyDayStyle=function(e,d){var c=d.ContainerCell;c.className=this.Data.GetItemStyleName();c.styleName=c.className;var a=c.style;a.padding="";if(this.Data.IsDefaultItemStyle()){a.color="";a.border="none 1px black";a.fontWeight="";a.backgroundColor="window";a.backgroundImage="";a.backgroundPosition="center center"}else{var b=this.ItemStyleRule.style;a.color=b.color;a.border=b.border;a.fontWeight=b.fontWeight;a.backgroundColor=b.backgroundColor;a.backgroundImage=b.backgroundImage;a.backgroundPosition=b.backgroundPosition}if(Utility.IsQuriksMode)d.ContentTable.className=this.Data.CellStyleName+" "+c.className};a.prototype.UpdateDisableDayStyle=function(b,a,d,c){this.UpdateTrailingDayStyle(b,a,d,c)};a.prototype.UpdateMonthEvent=function(){for(var d=this.CalendarSectionDom.SingleCalendarDom,c=0;c<d.length;c++)for(var e=d[c],b=0;b<6;b++)for(var a=0;a<7;a++){var f=e.RowsDom[b][a].ContainerCell;this.AttachElementEvent(f,16|4|8|1|2|32|128|64)}};a.prototype.UpdateYearData=function(o,f,e,i){var l=this.CalendarSectionDom.SingleCalendarDom[o],c=Months.January,j=i.getFullYear();c--;var h=DateTimeInfo.DaysInMonth(j,c+1),d=i.getDate();if(d>h)d=h;for(var a=new Date(j,c,d),p=false,f=0;f<4;f++)for(var e=0;e<3;e++){var k=l.RowsDom[f][e],b=k.ContainerCell;this.UpdateCommonMonthData(k,a);var g=a.getFullYear()*12+a.getMonth(),n=this.Data.MinDate.getFullYear()*12+this.Data.MinDate.getMonth(),m=this.Data.MaxDate.getFullYear()*12+this.Data.MaxDate.getMonth();if(g>=n&&g<=m)b.setAttribute("CellType","CommonMonth");else b.setAttribute("CellType","DisableMonth");b.setAttribute("id",this.Control._getId()+"_"+a.getFullYear()+"/"+(a.getMonth()+1));b.setAttribute("CellValue",a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate());a=CalendarUtility.GetNextMonthDate(a,1)}};a.prototype.UpdateCommonMonthData=function(b,a){b.ContentTextNode.nodeValue=this.Data.GetMonthText(a)};a.prototype.UpdateYearStyle=function(q){for(var b=this.singleCalendarSizeCache==null?this.Data.GetSingleCalendarSize():this.singleCalendarSizeCache,m=this.CalendarSectionDom.SingleCalendarDom[q],l=this.Data.IsDefaultItemStyle(),e=0;e<4;e++)for(var d=0;d<3;d++){var a=m.RowsDom[e][d],c=a.ContentCell,f=a.ContainerCell,n=a.ContainerCellDiv;CalendarUtility.ResetMonthCellDom(a);var i=f.getAttribute("CellType");if(i=="CommonMonth")this.UpdateCommonMonthStyle(a);else i=="DisableMonth"&&this.UpdateDisableMonthStyle(a);n.className="";f.style.padding="0px";c.className="";c.style.padding="0px";if(Utility.chrome||Utility.safari)c.style.textDecoration=l?"":this.ItemStyleRule.style.textDecoration;var h=b.MonthContainerSize.Width,g=b.MonthContainerSize.Height,k=b.MonthSize.Width,j=b.MonthSize.Height;if(b.MonthSizeOffset.Width>d){k+=1;h+=1}if(b.MonthSizeOffset.Height>e){j+=1;g+=1}var p=Math.max(k-2,0),o=Math.max(j-2,0);this.SetElementsWidthHeight([c,a.ContainerStyleDiv,a.ContainerCellDiv],p,o);CalendarUtility.SetCellSize(f,h,g)}};a.prototype.UpdateCommonMonthStyle=function(b){var c=DateTimeInfo.String2Date(b.ContainerCell.getAttribute("CellValue")),a=b.ContainerCell;a.style.padding="";a.style.borderWidth="";a.className=this.Data.GetItemStyleName();a.setAttribute("styleName",this.Data.GetItemStyleName());if(this.Data.IsDefaultItemStyle())CalendarUtility.SetDefalutItemInlineStyle(a);else CalendarUtility.SetItemInlineStyle(a,this.ItemStyleRule);b.ContentCell.setAttribute("vAlign","middle");if(Utility.IsQuriksMode){b.ContentTable.className=this.Data.CellStyleName+" "+a.className;b.ContentTable.setAttribute("styleName",b.ContentTable.className)}};a.prototype.UpdateDisableMonthStyle=function(a){a.ContainerStyleDiv.className=this.Data.TrailingStyleName;a.ContainerStyleDiv.setAttribute("styleName",this.Data.TrailingStyleName);if(Utility.IsQuriksMode)a.ContentTable.className=this.Data.CellStyleName+" "+a.ContainerStyleDiv.className};a.prototype.UpdateYearEvent=function(){for(var d=this.CalendarSectionDom.SingleCalendarDom,c=0;c<d.length;c++)for(var e=d[c],b=0;b<4;b++)for(var a=0;a<3;a++){var f=e.RowsDom[b][a].ContainerCell;this.AttachElementEvent(f,16|4|8|1|2|32|128|64)}};a.prototype.CreateTodayFrame=function(){var f=this.Data.CellStyleName,b=Utility.CreateInnerTable(),k=Utility.CreateInnerTbody(),m=Utility.CreateInnerTableRow(),c=Utility.CreateInnerTableCell(f),d=Utility.CreateInnerDiv(),h=Utility.CreateInnerTable(),i=Utility.CreateInnerTbody(),j=Utility.CreateInnerTableRow(),a=Utility.CreateInnerTableCell(f),e=Utility.CreateInnerTable(),l=Utility.CreateInnerTbody(),n=Utility.CreateInnerTableRow(),g=Utility.CreateInnerTableCell(f);g.className="";a.className="";c.className="";b.appendChild(k);k.appendChild(m);m.appendChild(c);c.appendChild(d);d.appendChild(h);h.appendChild(i);i.appendChild(j);j.appendChild(a);a.appendChild(e);e.appendChild(l);l.appendChild(n);n.appendChild(g);c.style.padding="0px";a.style.padding="0px";this.CalendarSectionDom.TodayDom={TodayContainer:b,TodayContainerDiv:d,TodayInnerCell:a,TodayContentTable:e,TodayText:g};b.setAttribute("id",this.Control._getId()+"_Today_Table");return b};a.prototype.UpdateTodayData=function(){var c=this.Data.GetCalendarAreaSize(),a=this.CalendarSectionDom.TodayDom,b=this.Data.GetTodayText();if(a.TodayText.childNodes.length==0)a.TodayText.appendChild(Utility.CreateInnerTextNode(b));else a.TodayText.nodeValue=b;a.TodayText.setAttribute("CellType","TodayText");a.TodayInnerCell.setAttribute("CellType","TodayContentTable")};a.prototype.UpdateTodayStyle=function(){var a=this.CalendarSectionDom.TodayDom,d=this.CalendarSectionDom.TodayCellDom,h=this.CalendarSectionDom.TodayCellDomContainer,b=this.CalendarSectionDom.TodayCellDomContentTable,e=this.CalendarSectionDom.TodayCellDomContentDiv,f=a.TodayContentTable,c=a.TodayText.style;CalendarUtility.ResetTodayDom(a);a.TodayContainer.className=this.Data.GetLegendStyleName();a.TodayContainer.style.border="0px";c.whiteSpace="nowrap";c.padding="1px";a.TodayInnerCell.vAlign="middle";if(Utility.chrome||Utility.safari)if(this.ItemStyleRule)c.textDecoration=this.ItemStyleRule.style.textDecoration;if(!this.Data.ShowToday)a.TodayContainer.style.display="none";var g=this.Data.GetCalendarAreaSize();this.SetElementsSize([a.TodayContainerDiv,a.TodayInnerCell],g.TodayAreaSize);if(Utility.IsQuriksMode)f.className=this.Data.CellStyleName+" "+a.TodayContainer.className;if(d&&this.Data.CalendarType==CalendarType.MonthDay){d.className=this.Data.GetTodayStyleName();e.style.marginBottom="2px";this.SetTodayCellImage();if(Utility.IsQuriksMode){b.className=this.Data.ItemStyleName+" "+d.className;b.setAttribute("styleName",this.Data.ItemStyleName+" "+this.Data.GetTodayStyleName());b.style.backgroundimage="none";b.style.border="0px"}}};a.prototype.UpdateTodayEvent=function(){if(this.Data.ShowToday){var a=this.CalendarSectionDom.TodayDom;this.AttachElementEvent(a.TodayInnerCell,16)}};a.prototype.UpdateSelectionStyle=function(){for(var a=0;a<this.CalendarSectionDom.SingleCalendarDom.length;a++)if(this.Data.CalendarType==CalendarType.MonthDay)this.UpdateMonthSelectionStyle(a);else this.UpdateYearSelectionStyle(a);if(Utility.IsIE11)try{var b=this.CalendarSectionDom.SingleCalendarDom[0].RowsDom[0][0];b.ContentTextNode.nodeValue=b.ContentTextNode.nodeValue}catch(c){}};a.prototype.UpdateMonthSelectionStyle=function(k){for(var n=this.CalendarSectionDom.SingleCalendarDom[k],m=this.Data.IsDefaultItemStyle(),l=this.Data.IsDefaultTrailingStyle(),f=0;f<6;f++)for(var e=0;e<7;e++){var a=n.RowsDom[f][e],d=a.ContainerCell,i=a.ContentCell,j=DateTimeInfo.String2Date(d.getAttribute("CellValue")),h=d.getAttribute("CellType");if(h=="CommonDay"||h=="TrailingDay"||h=="DisableDay"){if(this.Data.IsDateSelected(j)){this.SetSelectionStyleName(a);d.style.padding="0px";if(!this.Data.GetEnablejQueryTheme())i.style.color="white"}else{var b=a.ContainerCell;b.className=b.getAttribute("styleName");var c=CalendarUtility.GetCellStyleRule(this.Data,this,k,f,e);i.style.color="";switch(c.RuleType){case"ItemStyleRule":if(m)CalendarUtility.SetDefalutItemInlineStyle(b);else CalendarUtility.SetItemInlineStyle(b,c.StyleRule);break;case"TrailingStyleRule":if(l)CalendarUtility.SetDefalutItemInlineStyle(b);else CalendarUtility.SetItemInlineStyle(b,c.StyleRule);break;default:c.StyleRule&&CalendarUtility.SetItemInlineStyle(b,c.StyleRule)}if(Utility.IsQuriksMode)a.ContentTable.className=a.ContentTable.getAttribute("styleName");if(Utility.chrome||Utility.safari)a.ContentCell.style.textDecoration="";d.style.padding="0px"}var g=j.getDay();if(g===0||g===6)d.style.color=this.Data.GetTitleForeColor(g)}}};a.prototype.UpdateYearSelectionStyle=function(i){for(var g=this.CalendarSectionDom.SingleCalendarDom[i],f=this.Data.IsDefaultItemStyle(),d=0;d<4;d++)for(var c=0;c<3;c++){var a=g.RowsDom[d][c],b=a.ContainerCell,e=a.ContainerCell.getAttribute("CellType");if(e=="CommonMonth"||e=="DisableMonth"){var h=DateTimeInfo.String2Date(a.ContainerCell.getAttribute("CellValue"));if(this.Data.IsMonthSelected(h))this.SetSelectionStyleName(a);else{b.className=b.getAttribute("styleName");if(f)CalendarUtility.SetDefalutItemInlineStyle(b);else CalendarUtility.SetItemInlineStyle(b,this.ItemStyleRule)}}}};a.prototype.UpdateTouchZoomEvent=function(){var a=this.CalendarSectionDom.OutterContainer;if(Utility.IsTouch())this.AttachElementEvent(a,16384|512|32768|4096|8192);else this.AttachElementEvent(a,32|128|64)};a.prototype.CreateTodayStyleRule=function(){if(this.TodayStyleRule)return;var b=Utility.CreateClassStyle(this.Data.TodayStyleName),a=b.style;a.backgroundRepeat="no-repeat";a.borderStyle="solid";a.borderWidth="1px";a.borderCollapse="collapse";a.overflow="hidden";if(!Utility.IsIE8OrBelow)a.textAlign="middle";a.padding="0";a.backgroundPosition="center center";a.backgroundSize="16px,16px";this.TodayStyleRule=b};a.prototype.UpdateAllStyleRule=function(){this.UpdateTodayStyleRule();this.UpdateHeaderStyleRule();this.UpdateItemStyleRule();this.UpdateTrailingStyleRule();this.UpdateSelectionStyleRule()};a.prototype.UpdateContainerStyleRule=function(){if(this.Data.IsDefaultCalendarContainerStyle())return;if(!this.CalendarContainerStyleRule)this.CalendarContainerStyleRule=Utility.CreateClassStyle(this.Data.CalendarContainerStyleName);var a=this.CalendarContainerStyleRule.style;a.borderStyle=this.Data.InnerBorderStyle();a.borderColor=this.Data.InnerBorderColor();a.borderWidth=this.Data.InnerBorderWidth();a.backgroundColor=this.Data.BackColor;var b=this.Control.GetRealControlEffect();if(b===ControlEffect.Chrome){a.outline="";a.borderRadius=""}else if(b===ControlEffect.Ipad)a.borderRadius="5px";if(a.backgroundColor==="")a.backgroundColor="white";if(a.color==="")a.color="windowtext";if(a.fontStyle==="")a.fontStyle="normal";if(a.fontVariant==="")a.fontVariant="normal";if(a.fontWeight==="")a.fontWeight="normal";if(a.textDecoration==="")a.textDecoration="none"};a.prototype.UpdateItemStyleRule=function(){if(this.Data.IsDefaultItemStyle())return;if(!this.ItemStyleRule)this.ItemStyleRule=Utility.CreateClassStyle(this.Data.ItemStyleName);var a=this.ItemStyleRule;CalendarUtility.UpdateStyleRule(this.Data,a);if(this.Data.BackColor==="")a.style.backgroundColor=this.Data.DefaultStyleBackColor()};a.prototype.UpdateHeaderStyleRule=function(){if(this.Data.IsDefaultHeaderStyle())return;if(!this.HeaderStyleRule)this.HeaderStyleRule=Utility.CreateClassStyle(this.Data.HeaderStyleName);var a=this.HeaderStyleRule;CalendarUtility.UpdateHeaderStyleRule(this.Data,a);if(this.Data.HeaderBackColor===""&&!this.Data.GetEnablejQueryTheme())a.style.backgroundColor=this.Data.DefaultHeaderStyleBackColor()};a.prototype.UpdateTodayStyleRule=function(){if(this.Data.IsDefaultTodayStyle())return;this.CreateTodayStyleRule();this.TodayStyleRule.style.borderColor=this.Data.TodayMarkColor==""?"brown":this.Data.TodayMarkColor};a.prototype.UpdateTrailingStyleRule=function(){if(this.Data.IsDefaultTrailingStyle())return;if(!this.TrailingStyleRule)this.TrailingStyleRule=Utility.CreateClassStyle(this.Data.TrailingStyleName);var a=this.TrailingStyleRule;CalendarUtility.UpdateStyleRule(this.Data,a);a.style.color=this.Data.DefaultTrailingStyleForeColor()};a.prototype.UpdateSelectionStyleRule=function(){if(this.Data.IsDefaultSelectionStyle())return;if(!this.SelectionStyleRule)this.SelectionStyleRule=Utility.CreateClassStyle(this.Data.SelectionStyleName);var b=this.SelectionStyleRule,a=b.style;CalendarUtility.UpdateStyleRule(this.Data,b);a.backgroundColor=this.Data.DefaultSelectionStyleBackColor();a.color=this.Data.DefaultSelectionStyleForeColor()};a.prototype.SetTodayCellImage=function(){var b=this.CalendarSectionDom.TodayCellDom;if(!b)return;if(!Utility.IsIE9OrLater){b.style.backgroundImage=this.Data.IsDefaultTodayStyle()?this.Data.GetTodayStyleBackgroundImage():"";return}var a=b.parentElement;if(a){this.CalendarSectionDom.TodayCellDomImage&&a.removeChild(this.CalendarSectionDom.TodayCellDomImage);a.style.position="relative";b.style.position="relative";b.style.zIndex="1";var c=this.CalendarSectionDom.TodayCellDomImage;if(c==null){c=CalendarUtility.CreateTodayCellImage(this.Data);this.CalendarSectionDom.TodayCellDomImage=c}try{var e=parseInt(a.style.width),d=parseInt(a.style.height);c.style.left=Math.max(1,Math.floor((e-16)/2))+"px";c.style.top=Math.max(1,Math.floor((d-16)/2))+"px"}catch(f){}a.appendChild(this.CalendarSectionDom.TodayCellDomImage)}};a.prototype.ClearTodayCellImage=function(){var a=this.CalendarSectionDom.TodayCellDom;if(!a)return;if(!Utility.IsIE9OrLater){a.style.backgroundImage="";return}if(a){var b=a.parentElement;if(b){b.style.position="";a.style.position="";a.style.zIndex="";if(this.CalendarSectionDom.TodayCellDomImage){b.removeChild(this.CalendarSectionDom.TodayCellDomImage);this.CalendarSectionDom.TodayCellDomImage=null}}}};a.prototype.SetCellDomFocusColor=function(b,a){b.ContainerCell.style.color=a;if(Utility.IsQuriksMode)b.ContentTable.style.color=a};a.prototype.SetSelectionStyleName=function(b){var a=b.ContainerCell,c=this.Data.IsDefaultItemStyle();a.className=this.Data.GetSelectionStyleName();if(c)CalendarUtility.SetDefaultSelectionInlineStyle(a,this.Data.GetEnablejQueryTheme());else CalendarUtility.SetSelectionInlineStyle(a,this.SelectionStyleRule);a.style.padding="";if(Utility.chrome||Utility.safari)b.ContentCell.style.textDecoration=c?"":this.ItemStyleRule.style.textDecoration;if(Utility.IsQuriksMode)b.ContentTable.className=b.ContentTable.getAttribute("styleName")+" "+a.className};a.prototype.AttachElementEvent=function(d,c){for(var b in this._calendarElementEventMappingTable){var a=this._calendarElementEventMappingTable[b];if(a instanceof Array)Utility.IsEnumFlagSet(c,a[0])&&Utility.AttachEvent(d,b,a[1],false)}};a.prototype.SetElementsDisplay=function(a,b){if(a)a.style.display=b};a.prototype.SetElementsSize=function(b,c){for(var a=0;a<b.length;a++)CalendarUtility.SetCellSize(b[a],c.Width,c.Height)};a.prototype.SetElementsWidthHeight=function(b,d,c){for(var a=0;a<b.length;a++)CalendarUtility.SetCellSize(b[a],d,c)};a.prototype.AppendChildElements=function(c,b){for(var a=0;a<b.length;a++)c.appendChild(b[a])};a.prototype.DetachDocumentEvent=function(){(Utility.chrome||Utility.firefox||Utility.safari)&&Utility.DetachEvent(document.body,"keydown",this.DocumentKeyDownHandler);(Utility.IsPad()||Utility.chrome)&&Utility.DetachEvent(document,"touchstart",this.DocumentTouchStartHandler);Utility.IsTouch()&&Utility.DetachEvent(document,"MSPointerDown",this.DocumentTouchStartHandler);Utility.DetachEvent(document,"mousemove",this.DocumentMouseMoveHandler);Utility.DetachEvent(document,"mouseup",this.DocumentMouseUpHandler);Utility.DetachEvent(document,"mousedown",this.DocumentMouseDownHandler);Utility.DetachEvent(document.body,"touchmove",this.DocumentTouchMoveHandler)};return a}();GCIMCalendar.CalendarRender=CalendarRender;var CalendarSection=function(){function a(){}return a}();GCIMCalendar.CalendarSection=CalendarSection;var CalendarElementEventType;(function(a){a[a.MouseDown=1]="MouseDown";a[a.MouseUp=2]="MouseUp";a[a.MouseOver=4]="MouseOver";a[a.MouseOut=8]="MouseOut";a[a.Click=16]="Click";a[a.TouchStart=32]="TouchStart";a[a.TouchEnd=64]="TouchEnd";a[a.TouchMove=128]="TouchMove";a[a.MouseMove=256]="MouseMove";a[a.MSPointerDown=512]="MSPointerDown";a[a.MSPointerMove=1024]="MSPointerMove";a[a.MSPointerUp=2048]="MSPointerUp";a[a.MSGestureStart=4096]="MSGestureStart";a[a.MSGestureChange=8192]="MSGestureChange";a[a.MSGestureEnd=16384]="MSGestureEnd";a[a.MSGestureHold=32768]="MSGestureHold"})(CalendarElementEventType||(CalendarElementEventType={}));var CalendarUIProcess=function(){function a(a){var b=this;this.Control=a;this.Data=a.Data;this.Render=a.Render;this._touchStartX=[];this._touchStartY=[];this._touchEndX=[];this._touchEndY=[];this._evt={};this._ignoreAnimation=false;this._ignoreAnimationTimer=-1;this._animation=new Animation;this._animation.onAnimationComplete=function(){setTimeout(function(){b.Control._realSetFocus(true)},0)};this.AnimationMouseWheelHandler=function(a){Utility.PreventDefault(a)}}a.prototype.onCellClickHandler=function(a){var b=CalendarUtility.GetEventCurrentTarget(a),c=b.getAttribute("CellType");switch(c){case"CommonMonth":this.onClickCommonMonth(a);break;case"TrailingDay":if(!Utility.IsPad())this.onClickTrailingDay(a);break;case"CommonDay":if(!Utility.IsPad())this.onClickCommonDay(a);break;case"ZoomIn":this.onClickLeftZoom();break;case"ZoomOut":this.onClickRightZoom();break;case"TodayMark":case"TodayText":case"TodayButton":case"TodayContentTable":this.onClickToday()}};a.prototype.onCellMouseDownHandler=function(a){if(Utility.GetMouseButton(a)!==0)return;var b=CalendarUtility.GetEventCurrentTarget(a),c=b.getAttribute("CellType");switch(c){case"OutlookLeftNavigator":this.onMouseDownOutlookLeftNavigator(a);break;case"OutlookRightNavigator":this.onMouseDownOutlookRightNavigator(a);break;case"HeaderText":this.Control.FireEvent(this.Control._specialClientEvents.Scrolled)}};a.prototype.onCellMouseUpHandler=function(a){var c=CalendarUtility.GetEventCurrentTarget(a),b=c.getAttribute("CellType");if(Utility.GetMouseButton(a)!==0&&b!="CalendarSectionArea")return;switch(b){case"OutlookLeftNavigator":this.onMouseUpOutlookLeftNavigator(a);break;case"OutlookRightNavigator":this.onMouseUpOutlookRightNavigator(a)}};a.prototype.onCellMouseEnterHandler=function(){};a.prototype.onCellMouseLeaveHandler=function(b){var a=CalendarUtility.GetEventCurrentTarget(b);if(a===null)return;var c=a.getAttribute("CellType");switch(c){case"OutlookLeftNavigator":case"OutlookRightNavigator":this.onMouseLeaveOutlookCell(b)}};a.prototype.onMouseWheelHandler=function(a){Utility.CancelBubble(a);Utility.PreventDefault(a);if(this.IsAnimationBusy())return;var c=a.wheelDelta>=0?this.Data.ScrollSteps(-1,a.ctrlKey):this.Data.ScrollSteps(1,a.ctrlKey),b=a.wheelDelta>=0?AnimationType.ScrollToBottom:AnimationType.ScrollToTop;this.InitScrollAnimation(b);var d=this.ScrollMonth(c);d&&this.ShowAnimationInternal(b,this.domElement,this.domElementOld)};a.prototype.onDocumentTouchMoveHandler=function(){};a.prototype.onDocumentMouseMoveHandler=function(){};a.prototype.onDocumentTouchStartHandler=function(a){if(Utility.IsPad())this.onDocumentMouseDownHandler(a)};a.prototype.onDocumentMouseDownHandler=function(c){var a=c.srcElement||c.target;if(!a)return;var d=this.Control.Render.isActive,b=this.Control.Render.CalendarSectionDom.OutterContainer;if(Control.GetEnableChromeThemeOutline())if(this.Control.GetRealControlEffect()===ControlEffect.Chrome&&(this.Control.Render.isActive===undefined||this.Control.Render.isActive!==b.contains(a)))if(b.contains(a)===true)this.setFocusBorder();else this.restoreFocusBorder();this.Control.Render.isActive=b.contains(a);d!=this.Control.Render.isActive&&this.Control.Render.UpdateSelectionStyle()};a.prototype.onDocumentMouseUpHandler=function(){};a.prototype.onContextMenuHandler=function(){};a.prototype.onKeyDownHandler=function(a){var b=this;if(Utility.IsIE8OrBelow)if(this._keyDownSuspend){Utility.PreventDefault(a);Utility.CancelBubble(a);return}else{this._keyDownSuspend=true;setTimeout(function(){b._keyDownSuspend=false},200)}switch(a.keyCode){case Key.Down:this.onPressDown(a);break;case Key.Up:this.onPressUp(a);break;case Key.Left:this.onPressLeft(a);break;case Key.Right:this.onPressRight(a);break;case Key.Home:this.onPressHome(a);break;case Key.End:this.onPressEnd(a);break;case Key.PageDown:this.onPressPageDown(a);break;case Key.PageUp:this.onPressPageUp(a);break;case Key.Space:this.onPressSpace(a);break;case Key.Return:this.onPressEnter(a);break;default:return false}Utility.PreventDefault(a);Utility.CancelBubble(a);return true};a.prototype.onTouchStartHandler=function(a){var b=CalendarUtility.GetEventCurrentTarget(a),c=b.getAttribute("CellType");if(Utility.chrome)this._chromeTouchStartTime=new Date;switch(c){case"OutterContainer":this._touchType="";if(a.touches.length==1){this._touchStartTime=new Date;this._touchType="Animation";this._touchStartX[0]=a.touches[0].pageX;this._touchStartY[0]=a.touches[0].pageY;this._touchEndX[0]=a.touches[0].pageX;this._touchEndY[0]=a.touches[0].pageY}}};a.prototype.onTouchMoveHandler=function(a){var b=CalendarUtility.GetEventCurrentTarget(a),c=b.getAttribute("CellType");switch(c){case"OutterContainer":if(a.touches.length==1){this._touchEndX[0]=a.touches[0].pageX;this._touchEndY[0]=a.touches[0].pageY;Utility.PreventDefault(a)}}};a.prototype.onTouchEndHandler=function(b){var e=CalendarUtility.GetEventCurrentTarget(b),d=e.getAttribute("CellType");switch(d){case"OutterContainer":if(this._touchType==="Animation"){var a=null;if(this._touchStartTime!==undefined){this._touchEndTime=new Date;a=this._touchEndTime-this._touchStartTime;this._touchStartTime=undefined;this._touchEndTime=undefined}if(a!==null&&a<1e3){var c=Utility.GetAnimationTypeByTouch(this._touchStartX[0],this._touchEndX[0],this._touchStartY[0],this._touchEndY[0]);this.processTouchAnimation(c);this._touchStartX[0]=-1;this._touchStartY[0]=-1;this._touchEndX[0]=-1;this._touchEndY[0]=-1}}break;case"TrailingDay":case"CommonDay":var c=Utility.GetAnimationTypeByTouch(this._touchStartX[0],this._touchEndX[0],this._touchStartY[0],this._touchEndY[0]);if(Utility.IsPad()&&c===null){if(d==="CommonDay")this.onClickCommonDay(b);else this.onClickTrailingDay(b);this.Control.SetFocus()}}};a.prototype.onMSPointerDown=function(a){var b=CalendarUtility.GetEventCurrentTarget(a),c=b.getAttribute("CellType");switch(c){case"HeaderText":(a.pointerType===a.MSPOINTER_TYPE_MOUSE||a.pointerType==="mouse")&&this.Control.FireEvent(this.Control._specialClientEvents.Scrolled);break;case"OutterContainer":if(a.pointerType===a.MSPOINTER_TYPE_TOUCH||a.pointerType==="touch"){if(this._gestureEvent==null)if(window.MSGesture)this._gestureEvent=new MSGesture;if(this._gestureEvent){this._gestureEvent.target=this.Control.Render.CalendarSectionDom.OutterContainer;this._gestureEvent.addPointer(a.pointerId)}}}a.stopPropagation()};a.prototype.onMSPointerMove=function(){};a.prototype.onMSPointerUp=function(){};a.prototype.onMSGestureHold=function(){};a.prototype.onMSGestureStart=function(a){this._maxVelocityX=0;this._maxVelocityY=0;a.stopPropagation()};a.prototype.onMSGestureChange=function(a){if(a.velocityX>0)this._maxVelocityX=Math.max(a.velocityX,this._maxVelocityX);else this._maxVelocityX=Math.min(a.velocityX,this._maxVelocityX);if(a.velocityY>0)this._maxVelocityY=Math.max(a.velocityY,this._maxVelocityY);else this._maxVelocityY=Math.min(a.velocityY,this._maxVelocityY);a.stopPropagation()};a.prototype.onMSGestureEnd=function(b){var a=null;if(Math.abs(this._maxVelocityX)>Math.abs(this._maxVelocityY)){if(this._maxVelocityX>.5)a=AnimationType.ScrollToLeft;else if(this._maxVelocityX<-.5)a=AnimationType.ScrollToRight}else if(this._maxVelocityY>.5)a=AnimationType.ScrollToTop;else if(this._maxVelocityY<-.5)a=AnimationType.ScrollToBottom;this.processTouchAnimation(a);this._gestureEvent=null;this._scaleFactor=1;this._maxVelocityX=0;b.stopPropagation()};a.prototype.processTouchAnimation=function(b){if(b!==null){var a=0,c=this.Data.CalendarType===CalendarType.YearMonth;switch(b){case AnimationType.ScrollToLeft:a=-1;break;case AnimationType.ScrollToTop:a=this.Data.CalendarType===CalendarType.YearMonth?-10:-1;c=true;break;case AnimationType.ScrollToRight:a=1;break;case AnimationType.ScrollToBottom:a=this.Data.CalendarType===CalendarType.YearMonth?10:1;c=true}var d=false;this.InitScrollAnimation(b);if(c)d=this.ScrollYear(a);else d=this.ScrollMonth(a);d&&this.ShowAnimationInternal(b,this.domElement,this.domElementOld)}};a.prototype.onPressLeft=function(){var a=new Date(this.Data.FocusDate.valueOf());if(this.Data.CalendarType==CalendarType.MonthDay)a.setDate(a.getDate()-1);else a=CalendarUtility.GetNextMonthDate(a,-1);this.keyBoardMoveTo(a)};a.prototype.onPressUp=function(){var a=new Date(this.Data.FocusDate.valueOf());if(this.Data.CalendarType==CalendarType.MonthDay)a.setDate(a.getDate()-7);else a=CalendarUtility.GetNextMonthDate(a,-3);this.keyBoardMoveTo(a)};a.prototype.onPressPageUp=function(b){var a=new Date(this.Data.FocusDate.valueOf());if(this.Data.CalendarType==CalendarType.MonthDay)if(b!==undefined&&b!==null&&b.ctrlKey)a=CalendarUtility.GetNextYearDate(a,-1);else a=CalendarUtility.GetNextMonthDate(a,-1);else a=CalendarUtility.GetNextYearDate(a,-1);this.keyBoardMoveTo(a)};a.prototype.onPressRight=function(){var a=new Date(this.Data.FocusDate.valueOf());if(this.Data.CalendarType==CalendarType.MonthDay)a.setDate(a.getDate()+1);else a=CalendarUtility.GetNextMonthDate(a,1);this.keyBoardMoveTo(a)};a.prototype.onPressDown=function(){var a=new Date(this.Data.FocusDate.valueOf());if(this.Data.CalendarType==CalendarType.MonthDay)a.setDate(a.getDate()+7);else a=CalendarUtility.GetNextMonthDate(a,3);this.keyBoardMoveTo(a)};a.prototype.onPressPageDown=function(b){var a=new Date(this.Data.FocusDate.valueOf());if(this.Data.CalendarType==CalendarType.MonthDay)if(b!==undefined&&b!==null&&b.ctrlKey)a=CalendarUtility.GetNextYearDate(a,1);else a=CalendarUtility.GetNextMonthDate(a,1);else a=CalendarUtility.GetNextYearDate(a,1);this.keyBoardMoveTo(a)};a.prototype.onPressHome=function(c){var b=new Date(this.Data.FocusDate.valueOf()),a=null;if(this.Data.CalendarType==CalendarType.MonthDay)if(c.ctrlKey)a=new Date(b.getFullYear(),b.getMonth(),1);else a=CalendarUtility.GetDayLineBeginDate(this.Render,b,"CommonDay");else if(this.Data.CalendarType==CalendarType.YearMonth)if(c.ctrlKey)a=CalendarUtility.GetMonthBeginDate(this.Render,b,"CommonMonth");else a=CalendarUtility.GetMonthLineBeginDate(this.Render,b,"CommonMonth");if(a<this.Data.MinDate)a=new Date(this.Data.MinDate.valueOf());this.keyBoardMoveTo(a)};a.prototype.onPressEnd=function(c){var a=new Date(this.Data.FocusDate.valueOf()),b=null;if(this.Data.CalendarType==CalendarType.MonthDay)if(c.ctrlKey){var d=DateTimeInfo.DaysInMonth(a.getFullYear(),a.getMonth()+1);b=new Date(a.getFullYear(),a.getMonth(),d)}else b=CalendarUtility.GetDayLineEndDate(this.Render,a,"CommonDay");else if(this.Data.CalendarType==CalendarType.YearMonth)if(c.ctrlKey){var d=DateTimeInfo.DaysInMonth(a.getFullYear(),a.getMonth()+1);b=CalendarUtility.GetMonthEndDate(this.Render,a,"CommonMonth")}else b=CalendarUtility.GetMonthLineEndDate(this.Render,a,"CommonMonth");if(b>this.Data.MaxDate)b=new Date(this.Data.MaxDate.valueOf());this.keyBoardMoveTo(b)};a.prototype.onPressSpace=function(){var a=new Date(this.Data.FocusDate.valueOf()),b=this.Control._getId()+"_"+a.getFullYear()+"/"+(a.getMonth()+1);if(this.Data.CalendarType==CalendarType.MonthDay)b=this.Control._getId()+"_"+a.getFullYear()+"_"+(a.getMonth()+1)+"_"+a.getDate();var c=document.getElementById(b),d=DateTimeInfo.String2Date(c.getAttribute("CellValue"));this.Data.SetSelectedDateInternal(d);this.onFireClickDateEvent()};a.prototype.onPressEnter=function(a){this.onPressSpace(a)};a.prototype.keyBoardMoveTo=function(a){var b=this;this.InitScrollAnimation(AnimationType.Fade);if(this.Data.SetFocusDateInternal(a)){if(this.IsAnimationBusy())this._ignoreAnimation=true;if(this._ignoreAnimation){clearTimeout(this._ignoreAnimationTimer);this._ignoreAnimationTimer=setTimeout(function(){b._ignoreAnimation=false},500);return}this._animation.Setting.FadeType=FadeType.FadeInOut;this.ShowAnimationInternal(AnimationType.Fade,this.domElement,this.domElementOld)}this.Data.SetSelectedDateInternal(a)};a.prototype.onFireClickDateEvent=function(){this.Control.FireEvent(this.Control._specialClientEvents.ClickDate)};a.prototype.onClickCommonMonth=function(d){var b=CalendarUtility.GetEventCurrentTarget(d),a=DateTimeInfo.String2Date(b.getAttribute("CellValue"));this.Data.SetFocusDateInternal(new Date(a.valueOf()));var c=this.Data.GetFirstMonthSelectionDate(a);this.Data.SetSelectedDateInternal(c);this.Control.UpdateControl(2);this.onFireClickDateEvent()};a.prototype.onClickTrailingDay=function(c){var a=CalendarUtility.GetEventCurrentTarget(c),b=DateTimeInfo.String2Date(a.getAttribute("CellValue")),d=a.getAttribute("holidayType");this.InitScrollAnimation(AnimationType.Fade);if(this.Data.SetFocusDateInternal(b)){this._animation.Setting.FadeType=FadeType.FadeInOut;this.ShowAnimationInternal(AnimationType.Fade,this.domElement,this.domElementOld)}this.Data.SetSelectedDateInternal(b);this.onFireClickDateEvent()};a.prototype.onClickCommonDay=function(b){var c=CalendarUtility.GetEventCurrentTarget(b),a=DateTimeInfo.String2Date(c.getAttribute("CellValue"));this.Data.SetFocusDateInternal(a);this.Data.SetSelectedDateInternal(a);this.onFireClickDateEvent();Utility.PreventDefault(b)};a.prototype.onClickToday=function(){var a=this.Data.Today();if(a>=this.Data.MinDate&&a<=this.Data.MaxDate){this.InitScrollAnimation(AnimationType.Fade);if(this.Data.SetFocusDateInternal(a)){this._animation.Setting.FadeType=FadeType.FadeInOut;this.ShowAnimationInternal(AnimationType.Fade,this.domElement,this.domElementOld)}this.Data.SetSelectedDateInternal(a)}this.onFireClickDateEvent()};a.prototype.onClickOutlookLeftNavigator=function(b){var a=this;if(!this.IsAnimationBusy()){var c=this.Data.ScrollSteps(-1,b.ctrlKey);this.InitScrollAnimation(AnimationType.ScrollToLeft);var d=this.ScrollMonth(c);d&&this.ShowAnimationInternal(AnimationType.ScrollToLeft,this.domElement,this.domElementOld)}if(Utility.IsPad())return;this._evt.ctrlKey=b.ctrlKey;clearTimeout(this._outlookLeftNavigatorTimer);this._outlookLeftNavigatorTimer=setTimeout(function(){a.onClickOutlookLeftNavigator(a._evt)},0)};a.prototype.onMouseDownOutlookLeftNavigator=function(a){this._outlookLeftNavigatorMouseDown=true;this.onClickOutlookLeftNavigator(a)};a.prototype.onMouseUpOutlookLeftNavigator=function(){this._outlookLeftNavigatorMouseDown=false;clearTimeout(this._outlookLeftNavigatorTimer)};a.prototype.onClickOutlookRightNavigator=function(b){var a=this;if(!this.IsAnimationBusy()){var c=this.Data.ScrollSteps(1,b.ctrlKey);this.InitScrollAnimation(AnimationType.ScrollToRight);var d=this.ScrollMonth(c);d&&this.ShowAnimationInternal(AnimationType.ScrollToRight,this.domElement,this.domElementOld)}if(Utility.IsPad())return;this._evt.ctrlKey=b.ctrlKey;clearTimeout(this._outlookRightNavigatorTimer);this._outlookRightNavigatorTimer=setTimeout(function(){a.onClickOutlookRightNavigator(a._evt)},0)};a.prototype.onMouseDownOutlookRightNavigator=function(a){this._outlookRightNavigatorMouseDown=true;this.onClickOutlookRightNavigator(a)};a.prototype.onMouseUpOutlookRightNavigator=function(){this._outlookRightNavigatorMouseDown=false;clearTimeout(this._outlookRightNavigatorTimer)};a.prototype.onClickLeftZoom=function(){if(this.Data.CalendarType==CalendarType.YearMonth){this.Data.SetCalendarType("MonthDay");this.Control.FireEvent(this.Control._specialClientEvents.Scrolled)}};a.prototype.onClickRightZoom=function(){if(this.Data.CalendarType==CalendarType.MonthDay){this.Data.SetCalendarType("YearMonth");this.Control.FireEvent(this.Control._specialClientEvents.Scrolled)}};a.prototype.onMouseLeaveOutlookCell=function(a){if(this._outlookLeftNavigatorMouseDown==true)this.onMouseUpOutlookLeftNavigator(a);if(this._outlookRightNavigatorMouseDown==true)this.onMouseUpOutlookRightNavigator(a)};a.prototype.ScrollYear=function(e){var d=this.Data.StartDate(),a=CalendarUtility.GetNextYearDate(d,e),c=this.Data.SetStartDateInternal(a),b=this.Data.SyncFocusDateInternal();if(a<this.Data.MinDate)this.Data.FocusDate=this.Data.MinDate;else if(a>this.Data.MaxDate)this.Data.FocusDate=this.Data.MaxDate;if(c){this.Control.UpdateControl(1);this.Control.UpdateControl(2);this.Control.FireEvent(this.Control._specialClientEvents.Scrolled)}else b&&this.Control.UpdateControl(2);b&&this.Control.FireEvent(this.Control._specialClientEvents.FocusDateChanged);return c};a.prototype.ScrollMonth=function(d){if(this.Data.CalendarType===CalendarType.YearMonth){var e=this.Data.FocusDate,g=CalendarUtility.GetNextMonthDate(e,d),a=this.Data.SetFocusDateInternal(g);return a}var f=this.Data.StartDate(),b=CalendarUtility.GetNextMonthDate(f,d),a=this.Data.SetStartDateInternal(b),c=this.Data.SyncFocusDateInternal();if(b<this.Data.MinDate)this.Data.FocusDate=this.Data.MinDate;else if(b>this.Data.MaxDate)this.Data.FocusDate=this.Data.MaxDate;if(a){this.Control.UpdateControl(1);this.Control.UpdateControl(2)}else c&&this.Control.UpdateControl(2);a&&this.Control.FireEvent(this.Control._specialClientEvents.Scrolled);c&&this.Control.FireEvent(this.Control._specialClientEvents.FocusDateChanged);return a};a.prototype.setFocusBorder=function(){var a=this.Render.CalendarSectionDom.OutterContainerDiv;a.style.outline="-webkit-focus-ring-color auto 5px"};a.prototype.restoreFocusBorder=function(){var a=this.Control.Render.CalendarSectionDom.OutterContainerDiv;a.style.outline="none";a.parentElement.style.outline="none"};a.prototype.IsAnimationBusy=function(){return this._animation===null?false:this._animation.IsBusy};a.prototype.GetAnimationDomElement=function(b){var a=this.Render.CalendarSectionDom;return b===AnimationType.Fade?a.OutterContainer:a.SingleCalendarDom[0].InnerSingleCalendarContainerDiv};a.prototype.InitScrollAnimation=function(b){var c=this;this.domElement=this.GetAnimationDomElement(b);this.domElementOld=this.domElement.cloneNode(true);var a=this.domElementOld;Utility.AttachEvent(a,"mousewheel",this.AnimationMouseWheelHandler,false);setTimeout(function(){try{Utility.DetachEvent(a,"mousewheel",c.AnimationMouseWheelHandler,false)}catch(b){}},500)};a.prototype.ShowAnimationInternal=function(a,c,b){if(a===AnimationType.Fade&&Utility.IsIE8OrBelow)return;this._animation.Show(a,c,b)};return a}();GCIMCalendar.CalendarUIProcess=CalendarUIProcess;var GcCalendar=function(b){__extends(a,b);function a(a,c,d){this.imageList=c;b.call(this,a,d,true)}a.prototype._beginInit=function(){b.prototype._beginInit.call(this);this._suspendLayout=false;this.Data=this._createCalendarData();if(this.imageList)for(var a=0;a<this.imageList.length;a++){var c=this._getContainer().getAttribute(this.imageList[a]);this.SetServerImagePath(this.imageList[a],c)}};a.prototype._createUIRender=function(){this.Render=this._createCalendarRender()};a.prototype._createUIProcess=function(){this.UIProcess=this._createCalendarUIProcess()};a.prototype._renderHtmlElement=function(){var a=this.Render.CreateCalendar();this._getContainer().appendChild(a);if(this.GetRealControlEffect()===ControlEffect.Ipad)this._getContainer().style.borderRadius="5px"};a.prototype._endInit=function(){this.SuspendLayout();b.prototype._endInit.call(this);this.ResumeLayout()};a.prototype._getDefaultSize=function(){return{Width:this.Data.DefaultControlWidth(),Height:this.Data.DefaultControlWidth()}};a.prototype._createCalendarData=function(){return new CalendarData(this)};a.prototype._createCalendarRender=function(){return new CalendarRender(this)};a.prototype._createCalendarUIProcess=function(){return new CalendarUIProcess(this)};a.prototype._dispose=function(){b.prototype._dispose.call(this);this.Render.DetachDocumentEvent()};a.prototype.SetServerImagePath=function(b,a){this.Data.SetServerImagePath(b,a)};a.prototype.SetSelectedDate=function(a){this.Data.SetSelectedDate(a);return this};a.prototype.GetSelectedDate=function(){return this.Data.SelectedDate};a.prototype.SetFocusDate=function(a){this.Data.SetFocusDate(a);return this};a.prototype.SetYearMonthFormat=function(a){this.Data.SetYearMonthFormat(a)};a.prototype.GetYearMonthFormat=function(){return this.Data.YearMonthFormat};a.prototype.SetTodayMarkColor=function(a){this.Data.SetTodayMarkColor(a)};a.prototype.GetTodayMarkColor=function(){return this.Data.TodayMarkColor};a.prototype.SetHeaderFormat=function(a){this.Data.SetHeaderFormat(a)};a.prototype.GetHeaderFormat=function(){return this.Data.HeaderFormat};a.prototype.SetShowToday=function(a){this.Data.SetShowToday(a)};a.prototype.GetShowToday=function(){return this.Data.ShowToday};a.prototype.SetCalendarType=function(a){this.Data.SetCalendarType(a);return this};a.prototype.GetCalendarType=function(){return this.Data.GetCalendarType()};a.prototype.SetHeaderBackColor=function(a){this.Data.SetHeaderBackColor(a);return this};a.prototype.SetHeaderForeColor=function(a){this.Data.SetHeaderForeColor(a);return this};a.prototype.SetForeColor=function(a){this.Data.SetForeColor(a);return this};a.prototype.GetForeColor=function(){return this.Data.ForeColor};a.prototype.SetBackColor=function(a){this.Data.SetBackColor(a);return this};a.prototype.GetBackColor=function(){return this.Data.BackColor};a.prototype.GetFontFamily=function(){return this.Data.Font.GetFontFamily()};a.prototype.SetFontFamily=function(a){this.Data.Font.SetFontFamily(a)};a.prototype.GetFontSize=function(){return this.Data.Font.GetFontSize()};a.prototype.SetFontSize=function(a){this.Data.Font.SetFontSize(a)};a.prototype.GetFontWeight=function(){return this.Data.Font.GetFontWeight()};a.prototype.SetFontWeight=function(a){this.Data.Font.SetFontWeight(a)};a.prototype.GetFontStyle=function(){return this.Data.Font.GetFontStyle()};a.prototype.SetFontStyle=function(a){this.Data.Font.SetFontStyle(a)};a.prototype.GetTextDecoration=function(){return this.Data.Font.GetTextDecoration()};a.prototype.SetTextDecoration=function(a){this.Data.Font.SetTextDecoration(a)};a.prototype.SetSpreadCulture=function(a){Utility.SpreadCulture=a;this.UpdateControl()};a.prototype._onControlEffectChanged=function(b,a){if(a===ControlEffect.JQueryUI)this._setControlEffect(ControlEffect.JQueryUI);else this._setControlEffect(ControlEffect.NotSet)};a.prototype._setControlEffect=function(a){this.Data.SetControlEffect(a)};a.prototype.ScrollMonth=function(a){if(typeof a==="undefined"||isNaN(a))return;this.UIProcess.ScrollMonth(a);return this};a.prototype.ScrollYear=function(a){if(typeof a==="undefined"||isNaN(a))return;this.UIProcess.ScrollYear(a);return this};a.prototype.SuspendLayout=function(){this._suspendLayout=true};a.prototype.ResumeLayout=function(){this._suspendLayout=false;this.UpdateControl()};a.prototype._realSetFocus=function(a){this.Render.isActive=true;this.Render.CalendarSectionDom.OutterContainerDiv.focus();a!==true&&this.UpdateControl(2);if(this.GetRealControlEffect()===ControlEffect.Chrome&&Control.GetEnableChromeThemeOutline()){var b=this.Render.CalendarSectionDom.OutterContainerDiv;b.style.outline="-webkit-focus-ring-color auto 5px"}return this};a.prototype._realLoseFocus=function(){this.Render.isActive=false;if(this.GetRealControlEffect()===ControlEffect.Chrome){var a=this.Render.CalendarSectionDom.OutterContainerDiv;a.style.outline="none";a.parentElement.style.outline="none"}};a.prototype.UpdateControl=function(a){if(this._suspendLayout)return;a=a||7;if((a&7)==7)this.Render.UpdateControl();else{(a&1)==1&&this.Render.UpdateCalendarSectionData();if((a&2)==2){this.Render.UpdateAllStyleRule();this.Render.UpdateCalendarSectionStyle()}(a&4)==4&&this.Render.UpdateSelectionStyle()}};a.prototype.FireEvent=function(a){Utility.FireEvent(this,a,null)};a.prototype.OnClickDate=function(a){a=Utility.CheckFunction(a);this._specialClientEvents.ClickDate=a};a.prototype.OnScrolled=function(a){a=Utility.CheckFunction(a);this._specialClientEvents.Scrolled=a};a.prototype.OnFocusDateChanged=function(a){a=Utility.CheckFunction(a);this._specialClientEvents.FocusDateChanged=a};a.prototype.OnSelectedDateChanged=function(a){a=Utility.CheckFunction(a);this._specialClientEvents.SelectedDateChanged=a};return a}(Control);GCIMCalendar.GcCalendar=GcCalendar;window.Font=UserFont})(GCIMCalendar||(GCIMCalendar={}))